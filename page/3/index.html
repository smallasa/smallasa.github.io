<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/3/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-Atlassian-jira-update" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-jira-update/" class="article-date">
  <time datetime="2017-10-10T09:13:59.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-jira-update/">Atlassian jira update</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="jira-升级版本"><a href="#jira-升级版本" class="headerlink" title="jira 升级版本"></a>jira 升级版本</h3><ol>
<li><p>备份jira安装目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># tar czf jira.bin.tar.gz /mnt/app/jira</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>备份jira.home目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># tar czf jira.home.tar.gz /mnt/data/jira.home</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>备份jira数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># mysqldump -u&#123;username&#125; -p&#123;password&#125; -h&#123;ipaddress&#125; jira &gt; jira.sql</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>升级jira</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># ./atlassian-jira-software-7.5.0-x64.bin</span></span><br><span class="line">Unpacking JRE ...</span><br><span class="line">Starting Installer ...</span><br><span class="line">Oct 10, 2017 2:04:49 PM java.util.prefs.FileSystemPreferences<span class="variable">$2</span> run</span><br><span class="line">INFO: Created system preferences directory <span class="keyword">in</span> java.home.</span><br><span class="line"></span><br><span class="line">This will install JIRA Software 7.5.0 on your computer.</span><br><span class="line">OK [o, Enter], Cancel [c]</span><br><span class="line">o</span><br><span class="line">Choose the appropriate installation or upgrade option.</span><br><span class="line">Please choose one of the following:</span><br><span class="line">Express Install (use default settings) [1], Custom Install (recommended <span class="keyword">for</span> advanced users) [2], Upgrade an existing JIRA installation [3, Enter]</span><br><span class="line">3</span><br><span class="line">Existing installation directory:</span><br><span class="line">[/mnt/app/jira]</span><br><span class="line">/mnt/app/jira</span><br><span class="line">Back up JIRA home directory</span><br><span class="line">The upgrade process will automatically back up your JIRA installation</span><br><span class="line">directory. You can also choose to back up your existing JIRA home directory.</span><br><span class="line">Both directories are backed up as zip archive files <span class="keyword">in</span> their respective</span><br><span class="line">parent directory locations.</span><br><span class="line"></span><br><span class="line">We strongly recommend choosing this option <span class="keyword">in</span> the unlikely event that you</span><br><span class="line">experience problems with the upgrade and may require these backups to</span><br><span class="line">restore your existing JIRA installation.</span><br><span class="line"></span><br><span class="line">If you have many attachments <span class="keyword">in</span> your JIRA home directory, the zip archive of</span><br><span class="line">this directory may consume a significant amount of disk space.</span><br><span class="line">Back up JIRA home directory?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Checking <span class="keyword">for</span> <span class="built_in">local</span> modifications.</span><br><span class="line"></span><br><span class="line">List of modifications made within JIRA directories.</span><br><span class="line"></span><br><span class="line">The following provides a list of file modifications within the</span><br><span class="line">atlassian-jira directory.</span><br><span class="line"></span><br><span class="line">Modified files:</span><br><span class="line">        bin/setenv.sh</span><br><span class="line">        conf/server.xml</span><br><span class="line">        bin/check-java.sh</span><br><span class="line">Removed files:</span><br><span class="line">        (none)</span><br><span class="line">Added files:</span><br><span class="line">        atlassian-jira/WEB-INF/lib/mysql-connector-java-5.1.38-bin.jar</span><br><span class="line">        bin/atlassian-jira-security.log</span><br><span class="line">        bin/atlassian-jira.log</span><br><span class="line"></span><br><span class="line">[Enter]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Checking <span class="keyword">if</span> your instance of JIRA Software is running</span><br><span class="line">Upgrade check list</span><br><span class="line">Back up your external database</span><br><span class="line">We strongly recommend you back up your JIRA Software database <span class="keyword">if</span> you have</span><br><span class="line">not already <span class="keyword">done</span> so.</span><br><span class="line"></span><br><span class="line">Please refer to the following URL <span class="keyword">for</span> back up guidelines:</span><br><span class="line">http://docs.atlassian.com/jira/jadm-docs-075/Backing+up+data</span><br><span class="line"></span><br><span class="line">Check plugin compatibility</span><br><span class="line">Check that your non-bundled plugins are compatible with JIRA Software 7.5.0.</span><br><span class="line"></span><br><span class="line">Access the plugin manager through the following URL:</span><br><span class="line">http://localhost:8080/plugins/servlet/upm<span class="comment">#compatibility</span></span><br><span class="line"></span><br><span class="line">For more information see our documentation at the following URL:</span><br><span class="line">http://docs.atlassian.com/jira/jadm-docs-075/Upgrading+JIRA+applications</span><br><span class="line"></span><br><span class="line">Please ensure you have <span class="built_in">read</span> the above checklist before upgrading.</span><br><span class="line">Your existing JIRA installation is about to be upgraded!</span><br><span class="line"></span><br><span class="line">The upgrade process will shut down your existing JIRA installation to complete the upgrade.</span><br><span class="line"></span><br><span class="line">Do you want to proceed?</span><br><span class="line">Upgrade [u, Enter], Exit [e]</span><br><span class="line">u</span><br><span class="line"></span><br><span class="line">Your instance of JIRA is currently being upgraded.</span><br><span class="line">Shutting down JIRA...</span><br><span class="line">Checking <span class="keyword">if</span> JIRA has been shutdown...</span><br><span class="line">Backing up the JIRA installation directory</span><br><span class="line"></span><br><span class="line">Backing up the JIRA home directory</span><br><span class="line"></span><br><span class="line">Deleting the previous JIRA installation directory...</span><br><span class="line"></span><br><span class="line">Extracting files ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Please <span class="built_in">wait</span> a few moments <span class="keyword">while</span> JIRA Software is configured.</span><br><span class="line">Installation of JIRA Software 7.5.0 is complete</span><br><span class="line">Start JIRA Software 7.5.0 now?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Please <span class="built_in">wait</span> a few moments <span class="keyword">while</span> JIRA Software starts up.</span><br><span class="line">Launching JIRA Software ...</span><br><span class="line">Installation of JIRA Software 7.5.0 is complete</span><br><span class="line">Your installation of JIRA Software 7.5.0 is now ready and can be accessed</span><br><span class="line">via your browser.</span><br><span class="line">Custom modifications</span><br><span class="line">Your previous JIRA installation contains customisations (eg server.xml) that</span><br><span class="line">must be manually transferred. Refer to our documentation more information:</span><br><span class="line">http://docs.atlassian.com/jira/jadm-docs-075/Upgrading+JIRA+applications+manually<span class="comment">#UpgradingJIRAapplicationsmanually-configuringnewjiraasold3.4MigrateyourexistingJIRAconfigurationsovertoyournewJIRAinstallation</span></span><br><span class="line">JIRA Software 7.5.0 can be accessed at http://localhost:8080</span><br><span class="line"></span><br><span class="line">JIRA Software may take several minutes to load on first start up.</span><br><span class="line">Finishing installation ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># systemctl stop jira</span></span><br><span class="line">或者</span><br><span class="line">[root@jira app]<span class="comment"># /etc/init.d/jira stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将JDBC的客户端拷贝到jira安装目录lib下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># cp mysql-connector-java-5.1.44-bin.jar /mnt/app/jira/lib/</span></span><br><span class="line">[root@jira app]<span class="comment"># ls -1 /mnt/app/jira/lib/mysql-connector-java-5.1.44-bin.jar  </span></span><br><span class="line">/mnt/app/jira/lib/mysql-connector-java-5.1.44-bin.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># systemctl start jira</span></span><br><span class="line">或者</span><br><span class="line">[root@jira app]<span class="comment"># /etc/init.d/jira start</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过URL访问,进行验证</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-jira-update/" data-id="cjavy9jt300080coqm3ctvtru" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-mariadb-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-mariadb-install/" class="article-date">
  <time datetime="2017-10-10T09:13:26.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-mariadb-install/">Atlassian mariadb install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="系统初始化"><a href="#系统初始化" class="headerlink" title="系统初始化"></a>系统初始化</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">本次使用mariadb作为MySQL数据库软件安装使用:</span><br><span class="line">首先简绍一下mairadb优点,当然这些MySQL也在开发出来</span><br><span class="line">1.并行复制,在从库中距日志回放,可以配置多个sql线程并行执行</span><br><span class="line">2.多源复制,可以将多个mysql实例中中数据汇集到一个实例中,报表库非常实用</span><br><span class="line">3.连接线程池,高并发下使用线程池维护连接线程能很好的降低资源负载</span><br><span class="line">4.使用GTID,故障恢复更加快捷</span><br><span class="line">5.MySQL是只适应哈希索引.Mariadb支持更好的hash join</span><br><span class="line"></span><br><span class="line">上面好多特征MySQL5.6,MySQL5.7,MySQL7.0等也在逐渐提供,且有一些也在开源社区可以下载插件.但是就目前来说mariadb是一个不错的选择.</span><br><span class="line">版本 mariadb-10.0.14不是最新版本,是一个很稳定且上述特征都已经提供</span><br></pre></td></tr></table></figure>
<ol>
<li><p>服务器信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.13 mariadb.master</span><br><span class="line">10.10.10.14 mariadb.slave</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//mariadb13</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname mariadb13 &amp;&amp; echo mariadb13 | tee /etc/hostname              </span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '10.10.10.13 mariadb13' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line"></span><br><span class="line">//mariadb14</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname mariadb14 &amp;&amp; echo mariadb14 | tee /etc/hostname  </span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '10.10.10.14 mariadb14' |tee -a /etc/hosts  </span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>硬盘格式化挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.ops.cn/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.ops.cn/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv local 2.7.13</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署mariadb</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb[X] ~]<span class="comment"># yum -y install wget make cmake gcc gcc-c++ autoconf automake zlib* libxml2* ncurses-devel libmcrypt* libtool-ltdl-devel*</span></span><br><span class="line">[root@mariadb[X] ~]<span class="comment"># yum -y install keepalived</span></span><br><span class="line"></span><br><span class="line">[root@mariadb[X] ~]<span class="comment"># useradd -s /sbin/nologin mysql</span></span><br><span class="line"></span><br><span class="line">[root@mariadb[X] ~]<span class="comment"># cd /mnt/ops/app</span></span><br><span class="line">[root@mariadb[X] app]<span class="comment"># tar xzf mariadb-10.0.14.tar.gz</span></span><br><span class="line">[root@mariadb[X] app]<span class="comment"># cd mariadb-10.0.14</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># cmake -DCMAKE_INSTALL_PREFIX=/mnt/app/mariadb \</span></span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_ARCHIVE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_FEDERATED_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_PARTITION_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_READLINE=1 \</span><br><span class="line">-DENABLED_LOCAL_INFILE=1 \</span><br><span class="line">-DEXTRA_CHARSETS=all \</span><br><span class="line">-DDEFAULT_CHARSET=utf8 \</span><br><span class="line">-DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">-DMYSQL_USER=mysql</span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># make -j 8</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># make -j 8 install</span></span><br><span class="line"></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># echo 'export MYSQL_BASE=/mnt/app/mariadb' |tee /etc/profile.d/mysql.sh</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># echo 'export MYSQL_BIN=$MYSQL_BASE/bin' |tee -a /etc/profile.d/mysql.sh</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># echo 'export PATH=$MYSQL_BIN:$PATH'     |tee -a /etc/profile.d/mysql.sh</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/mysql/3306</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># chown -R mysql.mysql /mnt/&#123;data,log&#125;/mysql/3306</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># mkdir -p /mnt/app/mariadb/conf</span></span><br><span class="line"></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># chmod +x scripts/*</span></span><br><span class="line">[root@mariadb[X] mariadb-10.0.14]<span class="comment"># ./scripts/mysql_install_db --basedir=/mnt/app/mysql/ --datadir=/mnt/data/mysql/3306/ --user=mysql</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mariadb master</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb13 mariadb-10.0.14]<span class="comment"># cat &gt; /mnt/app/mariadb/conf/3306.cnf &lt;&lt;EOF</span></span><br><span class="line">[client]</span><br><span class="line">port            = 3306</span><br><span class="line">socket          = /mnt/data/mysql/3306/mysqld.sock</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port            = 3306</span><br><span class="line">socket          = /mnt/data/mysql/3306/mysqld.sock</span><br><span class="line"></span><br><span class="line">datadir         = /mnt/data/mysql/3306/</span><br><span class="line">basedir         = /mnt/app/mariadb</span><br><span class="line"></span><br><span class="line">default-storage-engine=InnoDB</span><br><span class="line">expire-logs-days  = 7</span><br><span class="line"></span><br><span class="line">skip-name-resolve</span><br><span class="line">skip-external-locking</span><br><span class="line">key_buffer_size         = 128M</span><br><span class="line">max_allowed_packet      = 64M</span><br><span class="line">table_open_cache        = 512</span><br><span class="line">sort_buffer_size        = 2M</span><br><span class="line">read_buffer_size        = 2M</span><br><span class="line">read_rnd_buffer_size    = 8M</span><br><span class="line">myisam_sort_buffer_size = 64M</span><br><span class="line">thread_concurrency      = 8</span><br><span class="line">query_cache_type        = 0</span><br><span class="line">thread_cache_size       = 128</span><br><span class="line"></span><br><span class="line">max_binlog_size         = 512M</span><br><span class="line">max_connections         = 2000</span><br><span class="line">max_user_connections    = 1600</span><br><span class="line">max_connect_errors      = 99999999</span><br><span class="line">connect_timeout         = 30</span><br><span class="line">tmp_table_size          = 128M</span><br><span class="line">max_heap_table_size     = 128M</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>-bin                 = 3306-bin</span><br><span class="line">binlog_cache_size       = 4M</span><br><span class="line">slow_query_log          = 1</span><br><span class="line">slow-query-log-file     = /mnt/<span class="built_in">log</span>/mysql/3306/ms.slow</span><br><span class="line">pid_file                = /mnt/data/mysql/3306/mysqld.pid</span><br><span class="line">log_error               = /mnt/<span class="built_in">log</span>/mysql/3306/err.log</span><br><span class="line">general_log_file        = /mnt/<span class="built_in">log</span>/mysql/3306/gene.log</span><br><span class="line">long_query_time         = 1</span><br><span class="line"><span class="built_in">log</span>-slave-updates</span><br><span class="line"><span class="comment">#binlog_format          = MIXED</span></span><br><span class="line">binlog_format           = ROW</span><br><span class="line"></span><br><span class="line">sync-master-info=1</span><br><span class="line">slave-parallel-threads=20</span><br><span class="line">binlog-checksum=CRC32</span><br><span class="line">master-verify-checksum=1</span><br><span class="line">slave-sql-verify-checksum=1</span><br><span class="line"><span class="comment">#report-host=IP</span></span><br><span class="line"><span class="comment">#report-port=3306</span></span><br><span class="line"></span><br><span class="line">server-id               = 1313</span><br><span class="line"><span class="comment">#read_only              = 1</span></span><br><span class="line"><span class="comment">#auto_increment_increment=2</span></span><br><span class="line"><span class="comment">#auto_increment_offset=1</span></span><br><span class="line"></span><br><span class="line">innodb_file_per_table     = 1</span><br><span class="line">innodb_data_home_dir      = /mnt/data/mysql/3306</span><br><span class="line">innodb_log_group_home_dir = /mnt/data/mysql/3306</span><br><span class="line">innodb_buffer_pool_size   = 6G</span><br><span class="line">innodb_additional_mem_pool_size = 20M</span><br><span class="line">innodb_log_file_size      = 512M</span><br><span class="line">innodb_log_buffer_size    = 32M</span><br><span class="line">innodb_flush_log_at_trx_commit = 2</span><br><span class="line"><span class="comment">#innodb_io_capacity = 500</span></span><br><span class="line"><span class="comment">#innodb_support_xa = false</span></span><br><span class="line">innodb_lock_wait_timeout  = 30</span><br><span class="line"><span class="comment">#transaction-isolation = READ-COMMITTED</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#thread pool</span></span><br><span class="line">thread_handling=pool-of-threads</span><br><span class="line"></span><br><span class="line">init-connect = <span class="string">'set names utf8'</span></span><br><span class="line">character_set_server = utf8</span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet = 64M</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">no-auto-rehash</span><br><span class="line"></span><br><span class="line">[myisamchk]</span><br><span class="line">key_buffer_size = 256M</span><br><span class="line">sort_buffer_size = 256M</span><br><span class="line">read_buffer = 2M</span><br><span class="line">write_buffer = 2M</span><br><span class="line"></span><br><span class="line">[mysqlhotcopy]</span><br><span class="line">interactive-timeout</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>mariadb slave</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb14 ~]<span class="comment"># cat &gt; /mnt/app/mariadb/conf/3306.cnf &lt;&lt;EOF</span></span><br><span class="line">[client]</span><br><span class="line">port            = 3306</span><br><span class="line">socket          = /mnt/data/mysql/3306/mysqld.sock</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">port            = 3306</span><br><span class="line">socket          = /mnt/data/mysql/3306/mysqld.sock</span><br><span class="line"></span><br><span class="line">datadir         = /mnt/data/mysql/3306/</span><br><span class="line">basedir         = /mnt/app/mariadb</span><br><span class="line"></span><br><span class="line">default-storage-engine=InnoDB</span><br><span class="line">expire-logs-days  = 7</span><br><span class="line"></span><br><span class="line">skip-name-resolve</span><br><span class="line">skip-external-locking</span><br><span class="line">key_buffer_size         = 128M</span><br><span class="line">max_allowed_packet      = 64M</span><br><span class="line">table_open_cache        = 512</span><br><span class="line">sort_buffer_size        = 2M</span><br><span class="line">read_buffer_size        = 2M</span><br><span class="line">read_rnd_buffer_size    = 8M</span><br><span class="line">myisam_sort_buffer_size = 64M</span><br><span class="line">thread_concurrency      = 8</span><br><span class="line">query_cache_type        = 0</span><br><span class="line">thread_cache_size       = 128</span><br><span class="line"></span><br><span class="line">max_binlog_size         = 512M</span><br><span class="line">max_connections         = 2000</span><br><span class="line">max_user_connections    = 1600</span><br><span class="line">max_connect_errors      = 99999999</span><br><span class="line">connect_timeout         = 30</span><br><span class="line">tmp_table_size          = 128M</span><br><span class="line">max_heap_table_size     = 128M</span><br><span class="line"></span><br><span class="line"><span class="built_in">log</span>-bin                 = 3306-bin</span><br><span class="line">binlog_cache_size       = 4M</span><br><span class="line">slow_query_log          = 1</span><br><span class="line">slow-query-log-file     = /mnt/<span class="built_in">log</span>/mysql/3306/ms.slow</span><br><span class="line">pid_file                = /mnt/data/mysql/3306/mysqld.pid</span><br><span class="line">log_error               = /mnt/<span class="built_in">log</span>/mysql/3306/err.log</span><br><span class="line">general_log_file        = /mnt/<span class="built_in">log</span>/mysql/3306/gene.log</span><br><span class="line">long_query_time         = 1</span><br><span class="line"><span class="built_in">log</span>-slave-updates</span><br><span class="line"><span class="comment">#binlog_format          = MIXED</span></span><br><span class="line">binlog_format           = ROW</span><br><span class="line"></span><br><span class="line">sync-master-info=1</span><br><span class="line">slave-parallel-threads=20</span><br><span class="line">binlog-checksum=CRC32</span><br><span class="line">master-verify-checksum=1</span><br><span class="line">slave-sql-verify-checksum=1</span><br><span class="line"><span class="comment">#report-host=IP</span></span><br><span class="line"><span class="comment">#report-port=3306</span></span><br><span class="line"></span><br><span class="line">server-id               = 1314</span><br><span class="line">read_only               = 1</span><br><span class="line"><span class="comment">#auto_increment_increment=2</span></span><br><span class="line"><span class="comment">#auto_increment_offset=1</span></span><br><span class="line"></span><br><span class="line">innodb_file_per_table     = 1</span><br><span class="line">innodb_data_home_dir      = /mnt/data/mysql/3306</span><br><span class="line">innodb_log_group_home_dir = /mnt/data/mysql/3306</span><br><span class="line">innodb_buffer_pool_size   = 6G</span><br><span class="line">innodb_additional_mem_pool_size = 20M</span><br><span class="line">innodb_log_file_size      = 512M</span><br><span class="line">innodb_log_buffer_size    = 32M</span><br><span class="line">innodb_flush_log_at_trx_commit = 2</span><br><span class="line"><span class="comment">#innodb_io_capacity = 500</span></span><br><span class="line"><span class="comment">#innodb_support_xa = false</span></span><br><span class="line">innodb_lock_wait_timeout  = 30</span><br><span class="line"><span class="comment">#transaction-isolation = READ-COMMITTED</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#thread pool</span></span><br><span class="line">thread_handling=pool-of-threads</span><br><span class="line"></span><br><span class="line">init-connect = <span class="string">'set names utf8'</span></span><br><span class="line">character_set_server = utf8</span><br><span class="line"></span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet = 64M</span><br><span class="line"></span><br><span class="line">[mysql]</span><br><span class="line">no-auto-rehash</span><br><span class="line"></span><br><span class="line">[myisamchk]</span><br><span class="line">key_buffer_size = 256M</span><br><span class="line">sort_buffer_size = 256M</span><br><span class="line">read_buffer = 2M</span><br><span class="line">write_buffer = 2M</span><br><span class="line"></span><br><span class="line">[mysqlhotcopy]</span><br><span class="line">interactive-timeout</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>mariadb 启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb[X] ~]<span class="comment"># /mnt/app/mariadb/bin/mysqld_safe --defaults-file=/mnt/app/mariadb/conf/$&#123;port&#125;.cnf &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mariadb 连接脚本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb[X] ~]<span class="comment"># cat &gt; /mnt/app/mariadb/bin/mylin &lt;&lt;EOF</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">p=\<span class="variable">$1</span></span><br><span class="line"><span class="built_in">shift</span></span><br><span class="line">mysql -h<span class="string">"127.0.0.1"</span> -P<span class="string">"\$p"</span> --default-character-set=utf8 --show-warnings -uroot -p<span class="string">'&#123;password&#125;'</span> -A --prompt=<span class="string">"(\u@\p)[\d]&gt; "</span> <span class="string">"\$@"</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>keepalived设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">[root@mariadb13 ~]<span class="comment"># cat /etc/keepalived/keepalived.conf</span></span><br><span class="line"> Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id HA_10.10.10.13</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_10.10.10.13 &#123;</span><br><span class="line">        state BACKUP</span><br><span class="line">        smtp_alter</span><br><span class="line">        dont_track_primary</span><br><span class="line">        interface eth0</span><br><span class="line">        virtual_router_id 92</span><br><span class="line">        priority 101</span><br><span class="line">        nopreempt</span><br><span class="line">        advert_int 1</span><br><span class="line">        authentication &#123;</span><br><span class="line">           auth_type PASS</span><br><span class="line">           auth_pass 92</span><br><span class="line">        &#125;</span><br><span class="line">        virtual_ipaddress &#123;</span><br><span class="line">            10.10.10.92</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@mariadb13 ~]<span class="comment"># systemctl start keepalived</span></span><br><span class="line">[root@mariadb13 ~]<span class="comment"># systemctl enable keepalived</span></span><br><span class="line"></span><br><span class="line">[root@mariadb14 ~]<span class="comment"># cat /etc/keepalived/keepalived.conf</span></span><br><span class="line">Configuration File <span class="keyword">for</span> keepalived</span><br><span class="line"></span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id HA_10.10.10.14</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_10.10.10.14 &#123;</span><br><span class="line">        state BACKUP</span><br><span class="line">        smtp_alter</span><br><span class="line">        dont_track_primary</span><br><span class="line">        interface eth0</span><br><span class="line">        virtual_router_id 92</span><br><span class="line">        priority 100</span><br><span class="line">        advert_int 1</span><br><span class="line">        authentication &#123;</span><br><span class="line">           auth_type PASS</span><br><span class="line">           auth_pass 92</span><br><span class="line">        &#125;</span><br><span class="line">        virtual_ipaddress &#123;</span><br><span class="line">            10.10.10.92</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">[root@mariadb14 ~]<span class="comment"># systemctl start keepalived</span></span><br><span class="line">[root@mariadb14 ~]<span class="comment"># systemctl enable keepalived</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-mariadb-install/" data-id="cjavy9jt6000a0coqphy0hweh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-confluence-https" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-confluence-https/" class="article-date">
  <time datetime="2017-10-10T09:00:48.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-confluence-https/">Atlassian jira confluence https</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="confluence-SSL设置"><a href="#confluence-SSL设置" class="headerlink" title="confluence SSL设置"></a>confluence SSL设置</h3><ol>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># systemctl stop confluence</span></span><br><span class="line">或者</span><br><span class="line">[root@confluence app]<span class="comment"># /etc/init.d/confluence stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改tomcat server.conf配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># vim /mnt/app/confluence/conf/server.xml</span></span><br><span class="line">&lt;Connector port=<span class="string">"8090"</span> connectionTimeout=<span class="string">"20000"</span> redirectPort=<span class="string">"8443"</span></span><br><span class="line">        maxThreads=<span class="string">"48"</span> minSpareThreads=<span class="string">"10"</span></span><br><span class="line">        enableLookups=<span class="string">"false"</span> acceptCount=<span class="string">"10"</span> debug=<span class="string">"0"</span> URIEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">        protocol=<span class="string">"org.apache.coyote.http11.Http11NioProtocol"</span></span><br><span class="line">        proxyName=<span class="string">"wiki.ops.com"</span> proxyPort=<span class="string">"443"</span> scheme=<span class="string">"https"</span> secure=<span class="string">"true"</span>/&gt;</span><br><span class="line">和</span><br><span class="line">&lt;Context path=<span class="string">"/confluence"</span> docBase=<span class="string">"../confluence"</span> debug=<span class="string">"0"</span> reloadable=<span class="string">"false"</span> useHttpOnly=<span class="string">"true"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># systemctl start confluence</span></span><br><span class="line">或者</span><br><span class="line">[root@confluence app]<span class="comment"># /etc/init.d/confluence start</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx ssl key存放位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># ls -1 /mnt/app/nginx/conf/ssl/*</span></span><br><span class="line">/mnt/app/nginx/conf/ssl/confluence.crt</span><br><span class="line">/mnt/app/nginx/conf/ssl/confluence.key</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx 主配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># cat /mnt/app/nginx/conf/nginx.conf</span></span><br><span class="line">user nginx nginx;</span><br><span class="line">worker_processes  8;</span><br><span class="line">worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;</span><br><span class="line">worker_rlimit_nofile 102400;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">  use epoll;</span><br><span class="line">  worker_connections  102400;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">  include              mime.types;</span><br><span class="line">  default_type         application/octet-stream;</span><br><span class="line">  sendfile             on;</span><br><span class="line">  keepalive_timeout    65;</span><br><span class="line">  server_tokens        off;</span><br><span class="line">  client_max_body_size 30m;</span><br><span class="line">  client_header_buffer_size 16k;</span><br><span class="line">  large_client_header_buffers 4 32k;</span><br><span class="line"></span><br><span class="line">  gzip                 on;</span><br><span class="line">  gzip_vary            on;</span><br><span class="line">  gzip_min_length      1k;</span><br><span class="line">  gzip_buffers         4  16k;</span><br><span class="line">  gzip_http_version    1.0;</span><br><span class="line">  gzip_comp_level      5;</span><br><span class="line">  gzip_types text/plain application/x-javascript text/css application/xml  image/jpeg image/png image/gif;</span><br><span class="line"></span><br><span class="line">  log_format  main  <span class="string">'$remote_addr $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" $http_x_forwarded_for $request_time $upstream_response_time'</span>;</span><br><span class="line">  error_log /mnt/<span class="built_in">log</span>/nginx/nginx_error.log ;</span><br><span class="line"></span><br><span class="line">  include /mnt/app/nginx/conf/vhost/*.conf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stream &#123;</span><br><span class="line">  include /mnt/app/nginx/conf/stream/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx confluence 虚拟主机配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># cat /mnt/app/nginx/conf/vhost/wiki.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen       80;</span><br><span class="line">  server_name  wiki.ops.com;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">return</span> 301 https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen 443 ssl;</span><br><span class="line">  server_name  wiki.ops.com;</span><br><span class="line">  access_log   /mnt/<span class="built_in">log</span>/nginx/wiki.ops.com.access.log  main;</span><br><span class="line">  error_log    /mnt/<span class="built_in">log</span>/nginx/wiki.ops.com.error.log;</span><br><span class="line"></span><br><span class="line">  ssl on;</span><br><span class="line">  ssl_certificate /mnt/app/nginx/conf/ssl/confluence.crt;</span><br><span class="line">  ssl_certificate_key /mnt/app/nginx/conf/ssl/confluence.key;</span><br><span class="line">  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">  ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;</span><br><span class="line">  ssl_prefer_server_ciphers on;</span><br><span class="line">  ssl_session_cache shared:SSL:10m;</span><br><span class="line">  ssl_session_timeout  10m;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    rewrite ^/ https://wiki.ops.com/confluence/;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  location /confluence &#123;</span><br><span class="line">    proxy_set_header        Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;</span><br><span class="line">    proxy_set_header        X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    proxy_redirect          http:// https://;</span><br><span class="line">    proxy_pass              http://10.10.10.12:8090/confluence;</span><br><span class="line">    client_max_body_size    10M;</span><br><span class="line">    proxy_set_header        X-Forwarded-Host <span class="variable">$host</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-Server <span class="variable">$host</span>;</span><br><span class="line">    <span class="comment"># Required for new HTTP-based CLI</span></span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_request_buffering off;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx reload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># /mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf -t</span></span><br><span class="line">[root@nginx ~]<span class="comment"># /mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf -s reload</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证: 输入域名”wiki.ops.com”查看是否自动跳转为https</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-confluence-https/" data-id="cjavy9jsg00000coqk03lzdsy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-jira-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-jira-install/" class="article-date">
  <time datetime="2017-10-10T08:47:00.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-jira-install/">Atlassian jira install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="系统初始化"><a href="#系统初始化" class="headerlink" title="系统初始化"></a>系统初始化</h3><ol>
<li><p>服务器信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.11 jira</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//jira</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname jira &amp;&amp; echo jira | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '10.10.10.11 jira' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>硬盘格式化挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.ops.cn/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.ops.cn/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv local 2.7.13</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署mysql<br><a href="">jira mysql install</a></p>
</li>
<li><p>部署java</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//jira/confluence:</span><br><span class="line">[root@[x] ~]<span class="comment"># tar xzf jdk-8u131-linux-x64.tar.gz</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mv jdk1.8.0_131 /mnt/app/java</span></span><br><span class="line">[root@[x] ~]<span class="comment"># chown -R root.root /mnt/app/java</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source  /etc/profile</span></span><br><span class="line">[root@[x] ~]<span class="comment"># java -version</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署jira</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]# chmod +x atlassian-jira-software-7.5.0-x64.bin</span><br><span class="line">[root@jira app]# ./atlassian-jira-software-7.5.0-x64.bin</span><br><span class="line">Unpacking JRE ...</span><br><span class="line">Starting Installer ...</span><br><span class="line">Oct 10, 2017 10:15:40 AM java.util.prefs.FileSystemPreferences$2 run</span><br><span class="line">INFO: Created system preferences directory in java.home.</span><br><span class="line"></span><br><span class="line">This will install JIRA Software 7.5.0 on your computer.</span><br><span class="line">OK [o, Enter], Cancel [c]</span><br><span class="line">o</span><br><span class="line">Choose the appropriate installation or upgrade option.</span><br><span class="line">Please choose one of the following:</span><br><span class="line">Express Install (use default settings) [1], Custom Install (recommended for advanced users) [2, Enter], Upgrade an existing JIRA installation [3]</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">Where should JIRA Software be installed?</span><br><span class="line">[/opt/atlassian/jira]</span><br><span class="line">/mnt/app/jira</span><br><span class="line">Default location for JIRA Software data</span><br><span class="line">[/var/atlassian/application-data/jira]</span><br><span class="line">/mnt/data/jira.home</span><br><span class="line">Configure which ports JIRA Software will use.</span><br><span class="line">JIRA requires two TCP ports that are not being used by any other</span><br><span class="line">applications on this machine. The HTTP port is where you will access JIRA</span><br><span class="line">through your browser. The Control port is used to startup and shutdown JIRA.</span><br><span class="line">Use default ports (HTTP: 8080, Control: 8005) - Recommended [1, Enter], Set custom value for HTTP and Control ports [2]</span><br><span class="line">1</span><br><span class="line">JIRA can be run in the background.</span><br><span class="line">You may choose to run JIRA as a service, which means it will start</span><br><span class="line">automatically whenever the computer restarts.</span><br><span class="line">Install JIRA as Service?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line">Details on where JIRA Software will be installed and the settings that will be used.</span><br><span class="line">Installation Directory: /mnt/app/jira</span><br><span class="line">Home Directory: /mnt/data/jira.home</span><br><span class="line">HTTP Port: 8080</span><br><span class="line">RMI Port: 8005</span><br><span class="line">Install as service: Yes</span><br><span class="line">Install [i, Enter], Exit [e]</span><br><span class="line">i</span><br><span class="line"></span><br><span class="line">Extracting files ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Please wait a few moments while JIRA Software is configured.</span><br><span class="line">Installation of JIRA Software 7.5.0 is complete</span><br><span class="line">Start JIRA Software 7.5.0 now?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Please wait a few moments while JIRA Software starts up.</span><br><span class="line">Launching JIRA Software ...</span><br><span class="line">Installation of JIRA Software 7.5.0 is complete</span><br><span class="line">Your installation of JIRA Software 7.5.0 is now ready and can be accessed</span><br><span class="line">via your browser.</span><br><span class="line">JIRA Software 7.5.0 can be accessed at http://localhost:8080</span><br><span class="line">Finishing installation ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># /etc/init.d/jira stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将JDBC的客户端拷贝到jira安装目录lib下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># cp mysql-connector-java-5.1.44-bin.jar /mnt/app/jira/lib/</span></span><br><span class="line">[root@jira app]<span class="comment"># ls -1 /mnt/app/jira/lib/mysql-connector-java-5.1.44-bin.jar  </span></span><br><span class="line">/mnt/app/jira/lib/mysql-connector-java-5.1.44-bin.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># mysql -u&#123;username&#125; -p&#123;password&#125; -h&#123;ipaddress&#125;</span></span><br><span class="line">MariaDB [(none)]&gt; CREATE DATABASE jira CHARACTER SET utf8 COLLATE utf8_bin;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看设置jira.home配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># cat /mnt/app/jira/atlassian-jira/WEB-INF/classes/jira-application.properties</span></span><br><span class="line">jira.home = /mnt/data/jira.home</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看启动jira时java版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># vim /mnt/app/jira/bin/check-java.sh</span></span><br><span class="line">_EXPECTED_JAVA_VERSION=<span class="string">"8"</span></span><br><span class="line"><span class="comment">#_RUNJAVA=/mnt/app/java/bin/java  注意: 如果使用tar包解压,这里最好加上_RUNJAVA变量</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看jira启动端口号</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># vim /mnt/app/jira/conf/server.xml</span></span><br><span class="line">&lt;Connector port=<span class="string">"8080"</span></span><br><span class="line">           maxThreads=<span class="string">"150"</span></span><br><span class="line">           minSpareThreads=<span class="string">"25"</span></span><br><span class="line">           connectionTimeout=<span class="string">"20000"</span></span><br><span class="line">           enableLookups=<span class="string">"false"</span></span><br><span class="line">           maxHttpHeaderSize=<span class="string">"8192"</span></span><br><span class="line">           protocol=<span class="string">"HTTP/1.1"</span></span><br><span class="line">           useBodyEncodingForURI=<span class="string">"true"</span></span><br><span class="line">           redirectPort=<span class="string">"8443"</span></span><br><span class="line">           acceptCount=<span class="string">"100"</span></span><br><span class="line">           disableUploadTimeout=<span class="string">"true"</span></span><br><span class="line">           bindOnInit=<span class="string">"false"</span>/&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置jira systemd</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># cat /etc/init.d/jira</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># JIRA Linux service controller script</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"/mnt/app/jira/bin"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">    start)</span><br><span class="line">        ./start-jira.sh</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        ./stop-jira.sh</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$0</span> &#123;start|stop&#125;"</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">[root@jira app]<span class="comment"># cat &gt; /usr/lib/systemd/system/jira.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=jira - atlassian-jira</span><br><span class="line">Documentation=https://confluence.atlassian.com/alldoc/atlassian-documentation-32243719.html</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/jira/bin/start-jira.sh</span><br><span class="line">ExecStop=/mnt/app/jira/bin/stop-jira.sh</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动jira</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@jira app]<span class="comment"># systemctl start jira</span></span><br><span class="line">[root@jira app]<span class="comment"># systemctl enable jira</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>访问jira</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 浏览器中输入: http://&#123;IP&#125;:8080</span><br><span class="line">* 选择&quot;中文&quot;,自定义设置</span><br><span class="line">* 选择&quot;Mysql&quot;,根据提示输入 数据库地址,用户名,密码</span><br><span class="line">* 输入&quot;Listen key&quot;</span><br><span class="line">* 根据提示操作,结束</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-jira-install/" data-id="cjavy9jsx00050coq6t9sow5z" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-confluence-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-confluence-install/" class="article-date">
  <time datetime="2017-10-10T08:47:00.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-confluence-install/">Atlassian confluence install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="系统初始化"><a href="#系统初始化" class="headerlink" title="系统初始化"></a>系统初始化</h3><ol>
<li><p>服务器信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.12 confluence</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//confluence</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname confluence &amp;&amp; echo confluence | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '10.10.10.12 confluence' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>硬盘格式化挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.ops.cn/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.cn/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.ops.cn/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv local 2.7.13</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署mysql<br><a href="">confluence mysql install</a></p>
</li>
<li><p>部署java</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">//jira/confluence:</span><br><span class="line">[root@[x] ~]<span class="comment"># tar xzf jdk-8u131-linux-x64.tar.gz</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mv jdk1.8.0_131 /mnt/app/java</span></span><br><span class="line">[root@[x] ~]<span class="comment"># chown -R root.root /mnt/app/java</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source  /etc/profile</span></span><br><span class="line">[root@[x] ~]<span class="comment"># java -version</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>部署confluence</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]# chmod +x atlassian-confluence-6.4.1-x64.bin</span><br><span class="line">[root@confluence app]# ./atlassian-confluence-6.4.1-x64.bin</span><br><span class="line">Unpacking JRE ...</span><br><span class="line">Starting Installer ...</span><br><span class="line">Oct 10, 2017 11:38:32 AM java.util.prefs.FileSystemPreferences$1 run</span><br><span class="line">INFO: Created user preferences directory.</span><br><span class="line">Oct 10, 2017 11:38:32 AM java.util.prefs.FileSystemPreferences$2 run</span><br><span class="line">INFO: Created system preferences directory in java.home.</span><br><span class="line"></span><br><span class="line">This will install Confluence 6.4.1 on your computer.</span><br><span class="line">OK [o, Enter], Cancel [c]</span><br><span class="line">o</span><br><span class="line">Choose the appropriate installation or upgrade option.</span><br><span class="line">Please choose one of the following:</span><br><span class="line">Express Install (uses default settings) [1],</span><br><span class="line">Custom Install (recommended for advanced users) [2, Enter],</span><br><span class="line">Upgrade an existing Confluence installation [3]</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">Where should Confluence 6.4.1 be installed?</span><br><span class="line">[/opt/atlassian/confluence]</span><br><span class="line">/mnt/app/confluence</span><br><span class="line">Default location for Confluence data</span><br><span class="line">[/var/atlassian/application-data/confluence]</span><br><span class="line">/mnt/data/confluence.home</span><br><span class="line">Configure which ports Confluence will use.</span><br><span class="line">Confluence requires two TCP ports that are not being used by any other</span><br><span class="line">applications on this machine. The HTTP port is where you will access</span><br><span class="line">Confluence through your browser. The Control port is used to Startup and</span><br><span class="line">Shutdown Confluence.</span><br><span class="line">Use default ports (HTTP: 8090, Control: 8000) - Recommended [1, Enter], Set custom value for HTTP and Control ports [2]</span><br><span class="line">1</span><br><span class="line">Confluence can be run in the background.</span><br><span class="line">You may choose to run Confluence as a service, which means it will start</span><br><span class="line">automatically whenever the computer restarts.</span><br><span class="line">Install Confluence as Service?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Extracting files ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Please wait a few moments while we configure Confluence.</span><br><span class="line">Installation of Confluence 6.4.1 is complete</span><br><span class="line">Start Confluence now?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Please wait a few moments while Confluence starts up.</span><br><span class="line">Launching Confluence ...</span><br><span class="line">Installation of Confluence 6.4.1 is complete</span><br><span class="line">Your installation of Confluence 6.4.1 is now ready and can be accessed via</span><br><span class="line">your browser.</span><br><span class="line">Confluence 6.4.1 can be accessed at http://localhost:8090</span><br><span class="line">Finishing installation ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># /etc/init.d/confluence stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将JDBC的客户端拷贝到confluence安装目录lib下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># cp mysql-connector-java-5.1.44-bin.jar /mnt/app/confluence/lib/</span></span><br><span class="line">[root@confluence app]<span class="comment"># ls -1 /mnt/app/confluence/lib/mysql-connector-java-5.1.44-bin.jar  </span></span><br><span class="line">/mnt/app/confluence/lib/mysql-connector-java-5.1.44-bin.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># mysql -u&#123;username&#125; -p&#123;password&#125; -h&#123;ipaddress&#125;</span></span><br><span class="line">MariaDB [(none)]&gt; CREATE DATABASE confluence CHARACTER SET utf8 COLLATE utf8_bin;</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看confluence.home</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># cat /mnt/app/confluence/confluence/WEB-INF/classes/confluence-init.properties</span></span><br><span class="line">confluence.home=/mnt/data/confluence.home</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看confluence.port</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># cat /mnt/app/confluence/conf/server.xml</span></span><br><span class="line">&lt;Connector port=<span class="string">"8090"</span> connectionTimeout=<span class="string">"20000"</span> redirectPort=<span class="string">"8443"</span></span><br><span class="line">        maxThreads=<span class="string">"48"</span> minSpareThreads=<span class="string">"10"</span></span><br><span class="line">        enableLookups=<span class="string">"false"</span> acceptCount=<span class="string">"10"</span> debug=<span class="string">"0"</span> URIEncoding=<span class="string">"UTF-8"</span></span><br><span class="line">        protocol=<span class="string">"org.apache.coyote.http11.Http11NioProtocol"</span> /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置confluence systemd</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># cat /etc/init.d/confluence</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Confluence Linux service controller script</span></span><br><span class="line"><span class="built_in">cd</span> <span class="string">"/mnt/app/confluence/bin"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">    start)</span><br><span class="line">        ./start-confluence.sh</span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        ./stop-confluence.sh</span><br><span class="line">        ;;</span><br><span class="line">    restart)</span><br><span class="line">        ./stop-confluence.sh</span><br><span class="line">        ./start-confluence.sh</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$0</span> &#123;start|stop|restart&#125;"</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">        ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"></span><br><span class="line">[root@confluence app]<span class="comment"># cat &gt; /usr/lib/systemd/system/confluence.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=confluence - atlassian-confluence</span><br><span class="line">Documentation=https://confluence.atlassian.com/alldoc/atlassian-documentation-32243719.html</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/confluence/bin/start-confluence.sh</span><br><span class="line">ExecStop=/mnt/app/confluence/bin/stop-confluence.sh</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动confluence</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@confluence app]<span class="comment"># systemctl start confluence</span></span><br><span class="line">[root@confluence app]<span class="comment"># systemctl enable confluence</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>访问confluence</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* 浏览器中输入: http://&#123;IP&#125;:8090</span><br><span class="line">* 选择&quot;中文&quot;,自定义设置</span><br><span class="line">* 选择&quot;Mysql&quot;,根据提示输入 数据库地址,用户名,密码</span><br><span class="line">* 输入&quot;Listen key&quot;</span><br><span class="line">* 根据提示操作,结束</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-confluence-install/" data-id="cjavy9jst00030coqgs1nmy1k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-salt-master-syndic-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/26/salt-master-syndic-install/" class="article-date">
  <time datetime="2017-09-26T09:14:35.000Z" itemprop="datePublished">2017-09-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/automation/">automation</a>►<a class="article-category-link" href="/categories/automation/salt/">salt</a>►<a class="article-category-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/26/salt-master-syndic-install/">salt master syndic install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="salt-master-syndic-install"><a href="#salt-master-syndic-install" class="headerlink" title="salt master syndic install"></a>salt master syndic install</h3><ol>
<li><p>服务器信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">192.168.13.217  CentOS 7.3.1611 master</span><br><span class="line">192.168.13.218  CentOS 7.3.1611 master+syndic</span><br><span class="line">192.168.13.187  CentOS 6.5      minion</span><br><span class="line">192.168.13.188  CentOS 7.0.1406 minion</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">//salt-master</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname salt-master &amp;&amp; echo salt-master | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.13.217 salt-master' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line"></span><br><span class="line">//salt-syndic</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname salt-syndic &amp;&amp; echo salt-syndic | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.13.218 salt-syndic' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line"></span><br><span class="line">/salt-minion</span><br><span class="line">CentOS-6:</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname salt-minion-187 &amp;&amp; echo salt-minion-187 | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.13.187 salt-minion-187' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># sed -i /'HOSTNAME'/d /etc/sysconfig/network</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'HOSTNAME=salt-minion-187'|tee -a /etc/sysconfig/network</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line">CentOS-7:</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname salt-minion-188 &amp;&amp; echo salt-minion-188 | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.13.188 salt-minion-188' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>硬盘格式化挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.jwops.cn/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.jwops.cn/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.jwops.cn/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.jwops.cn/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv local 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv rehash</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<ol>
<li><p>salt安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># pip install salt</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>salt-master配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">[root@salt-master ~]<span class="comment"># mkdir -p /etc/salt</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># mkdir -p /mnt/data/salt/base/&#123;dev,prod&#125;</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># mkdir -p /mnt/data/salt/pillar/&#123;dev,prod&#125;</span></span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># cat &gt; /etc/salt/master &lt;&lt;EOF</span></span><br><span class="line">interface: 0.0.0.0</span><br><span class="line">ipv6: False</span><br><span class="line">publish_port: 4505</span><br><span class="line">ret_port: 4506</span><br><span class="line">user: root</span><br><span class="line">order_masters: True</span><br><span class="line">file_roots:</span><br><span class="line">  base:</span><br><span class="line">    - /mnt/data/salt/base</span><br><span class="line">  dev:</span><br><span class="line">    - /mnt/data/salt/base/dev</span><br><span class="line">  prod:</span><br><span class="line">    - /mnt/data/salt/base/prod</span><br><span class="line">pillar_roots:</span><br><span class="line">  base:</span><br><span class="line">    - /mnt/data/salt/pillar</span><br><span class="line">  dev:</span><br><span class="line">    - /mnt/data/salt/pillar/dev</span><br><span class="line">  prod:</span><br><span class="line">    - /mnt/data/salt/pillar/prod</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># salt-master -c /etc/salt -d</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># pkill salt-master</span></span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># cat &gt; /usr/lib/systemd/system/salt-master.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=salt-master</span><br><span class="line">Documentation=https://docs.saltstack.com/en/latest/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">Type=simple</span><br><span class="line">NotifyAccess=all</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-master</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># systemctl start salt-master</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># systemctl enable salt-master</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># cp -f /etc/&#123;rsyncd.conf,rsyncd.conf.bak&#125;</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># cat &gt; /etc/rsyncd.conf &lt;&lt;EOF</span></span><br><span class="line">uid = root</span><br><span class="line">gid = root</span><br><span class="line">port = 873</span><br><span class="line">use chroot = yes</span><br><span class="line"><span class="built_in">read</span> only = no</span><br><span class="line">write only = no</span><br><span class="line">hosts allow = 192.168.13.218</span><br><span class="line">hosts deny = *</span><br><span class="line">max connections = 5</span><br><span class="line">exclude = lost+found/</span><br><span class="line">transfer logging = yes</span><br><span class="line">timeout = 900</span><br><span class="line">ignore nonreadable = yes</span><br><span class="line">dont compress   = *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2</span><br><span class="line"></span><br><span class="line">[salt]</span><br><span class="line">path = /mnt/data/salt</span><br><span class="line">list = yes</span><br><span class="line">auth users = saltsync</span><br><span class="line">secrets file = /etc/rsyncd.secrets</span><br><span class="line"><span class="built_in">read</span> only = yes</span><br><span class="line">exclude = test1/ test2/</span><br><span class="line">comment = salt file_roots and pillor_roots</span><br><span class="line">EOF</span><br><span class="line">[root@salt-master ~]<span class="comment"># echo 'saltsync:EcZufi9eoIdUR6X' |tee /etc/rsyncd.secrets</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># chmod 600 /etc/rsyncd.secrets</span></span><br><span class="line"></span><br><span class="line">[root@salt-master ~]<span class="comment"># systemctl start rsyncd</span></span><br><span class="line">[root@salt-master ~]<span class="comment"># systemctl enable rsyncd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>salt-syndic配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">[root@salt-syndic ~]<span class="comment"># echo 'EcZufi9eoIdUR6X' |tee /etc/rsyncd.passwd</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># chmod 600 /etc/rsyncd.passwd</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># echo '*/1 * * * *  rsync -avzP --delete --password-file=/etc/rsyncd.passwd  saltsync@192.168.13.217::salt /mnt/data/salt' |tee /var/spool/cron/root</span></span><br><span class="line"></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># mkdir -p /etc/salt</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># cat &gt; /etc/salt/master &lt;&lt;EOF</span></span><br><span class="line">interface: 0.0.0.0</span><br><span class="line">ipv6: False</span><br><span class="line">publish_port: 4505</span><br><span class="line">ret_port: 4506</span><br><span class="line">user: root</span><br><span class="line">syndic_master:</span><br><span class="line">  - 192.168.13.217</span><br><span class="line">syndic_master_port: 4506</span><br><span class="line">syndic_failover: random</span><br><span class="line">syndic_wait: 20</span><br><span class="line">auto_accept: True</span><br><span class="line">file_roots:</span><br><span class="line">  base:</span><br><span class="line">    - /mnt/data/salt/base</span><br><span class="line">  dev:</span><br><span class="line">    - /mnt/data/salt/base/dev</span><br><span class="line">  prod:</span><br><span class="line">    - /mnt/data/salt/base/prod</span><br><span class="line">pillar_roots:</span><br><span class="line">  base:</span><br><span class="line">    - /mnt/data/salt/pillar</span><br><span class="line">  dev:</span><br><span class="line">    - /mnt/data/salt/pillar/dev</span><br><span class="line">  prod:</span><br><span class="line">    - /mnt/data/salt/pillar/prod</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># salt-master -c /etc/salt -d</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># salt-syndic -c /etc/salt -d</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># pkill salt-master</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># pkill salt-syndic</span></span><br><span class="line"></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># cat &gt; /usr/lib/systemd/system/salt-master.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=salt-master</span><br><span class="line">Documentation=https://docs.saltstack.com/en/latest/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">Type=simple</span><br><span class="line">NotifyAccess=all</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-master</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># cat &gt; /usr/lib/systemd/system/salt-syndic.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=salt-syndic</span><br><span class="line">Documentation=https://docs.saltstack.com/en/latest/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">Type=simple</span><br><span class="line">NotifyAccess=all</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-syndic</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># systemctl start salt-master</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># systemctl start salt-syndic</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># systemctl enable salt-master</span></span><br><span class="line">[root@salt-syndic ~]<span class="comment"># systemctl enable salt-syndic</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>salt-minion配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">CentOS-6:</span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># mkdir -p /etc/salt/</span></span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># cat &gt; /etc/salt/minion &lt;&lt;EOF</span></span><br><span class="line">master: 192.168.13.218</span><br><span class="line">ipv6: False</span><br><span class="line">master_port: 4506</span><br><span class="line">user: root</span><br><span class="line">id: salt-minion-187</span><br><span class="line">EOF</span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># salt-minion -c /etc/salt -d</span></span><br><span class="line"></span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># cat &gt; /etc/init.d/salt-minion &lt;&lt;EOF</span></span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># chkconfig: 2345 15 20</span></span><br><span class="line"><span class="comment"># description: salt-minion</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">"\$1"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Starting salt-minion..."</span></span><br><span class="line">  /usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-minion -d</span><br><span class="line">  ;;</span><br><span class="line">stop)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Stop salt-minion..."</span></span><br><span class="line">  <span class="built_in">kill</span> -HUP $(cat /var/run/salt-minion.pid)</span><br><span class="line">  ;;</span><br><span class="line">restart)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Stop salt-minion..."</span></span><br><span class="line">  <span class="built_in">kill</span> -HUP $(cat /var/run/salt-minion.pid)</span><br><span class="line">  sleep 1</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"Starting salt-minion..."</span></span><br><span class="line">  /usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-minion -d</span><br><span class="line">  ;;</span><br><span class="line">status)</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"salt-minion status:"</span></span><br><span class="line">  ps -ef|grep salt-minion|grep -v grep|grep -v status</span><br><span class="line">  ;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line">EOF</span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># chmod +x /etc/init.d/salt-minion</span></span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># chkconfig --add salt-minion</span></span><br><span class="line">[root@salt-minion-187 ~]<span class="comment"># chkconfig salt-minion on</span></span><br><span class="line"></span><br><span class="line">CentOS-7:</span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># mkdir -p /etc/salt/</span></span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># cat &gt; /etc/salt/minion &lt;&lt;EOF</span></span><br><span class="line">master: 192.168.13.218</span><br><span class="line">ipv6: False</span><br><span class="line">master_port: 4506</span><br><span class="line">user: root</span><br><span class="line">id: salt-minion-188</span><br><span class="line">EOF</span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># salt-minion -c /etc/salt -d</span></span><br><span class="line"></span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># cat &gt; /usr/lib/systemd/system/salt-minion.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=salt-minion</span><br><span class="line">Documentation=https://docs.saltstack.com/en/latest/</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">LimitNOFILE=65535</span><br><span class="line">Type=simple</span><br><span class="line">NotifyAccess=all</span><br><span class="line">ExecStart=/usr/<span class="built_in">local</span>/pyenv/versions/2.7.13/bin/salt-minion</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># systemctl start salt-minion</span></span><br><span class="line">[root@salt-minion-188 ~]<span class="comment"># systemctl enable salt-minion</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/09/26/salt-master-syndic-install/" data-id="cjavy9k6u00ag0coqdmne4x2j" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-linux-nginx-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/26/linux-nginx-install/" class="article-date">
  <time datetime="2017-09-26T06:08:22.000Z" itemprop="datePublished">2017-09-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/CentOS/">CentOS</a>►<a class="article-category-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/26/linux-nginx-install/">linux nginx install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p>服务器信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">192.168.15.21 nginx21</span><br><span class="line">192.168.15.22 nginx22</span><br><span class="line">192.168.15.183 vip</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//nginx21</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname nginx21 &amp;&amp; echo nginx21 | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.15.21 nginx21' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line"></span><br><span class="line">//nginx22</span><br><span class="line">[root@localhost ~]<span class="comment"># hostname nginx22 &amp;&amp; echo nginx22 | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '192.168.15.22 nginx22' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.jwops.cn/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.jwops.cn/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.jwops.cn/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.jwops.cn/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv local 2.7.13</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<ol>
<li><p>nginx安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] app]<span class="comment"># useradd -s /sbin/nologin nginx</span></span><br><span class="line"></span><br><span class="line">[root@[x] app]<span class="comment"># tar xzf nginx-1.12.1.tar.gz</span></span><br><span class="line">[root@[x] app]<span class="comment"># cd nginx-1.12.1/</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># ./configure \</span></span><br><span class="line">--prefix=/mnt/app/nginx \</span><br><span class="line">--user=nginx \</span><br><span class="line">--group=nginx \</span><br><span class="line">--with-select_module \</span><br><span class="line">--with-poll_module \</span><br><span class="line">--with-threads \</span><br><span class="line">--with-file-aio \</span><br><span class="line">--with-http_ssl_module \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-http_v2_module \</span><br><span class="line">--with-http_realip_module \</span><br><span class="line">--with-http_addition_module \</span><br><span class="line">--with-http_geoip_module \</span><br><span class="line">--with-http_gunzip_module \</span><br><span class="line">--with-http_gzip_static_module \</span><br><span class="line">--with-http_auth_request_module \</span><br><span class="line">--with-http_random_index_module \</span><br><span class="line">--with-http_secure_link_module \</span><br><span class="line">--with-http_degradation_module \</span><br><span class="line">--with-http_slice_module  \</span><br><span class="line">--with-http_stub_status_module \</span><br><span class="line">--with-stream \</span><br><span class="line">--with-stream_ssl_module \</span><br><span class="line">--with-stream_realip_module \</span><br><span class="line">--with-stream_geoip_module  \</span><br><span class="line">--with-stream_ssl_preread_module \</span><br><span class="line">--with-google_perftools_module \</span><br><span class="line">--with-compat \</span><br><span class="line">--with-pcre \</span><br><span class="line">--with-libatomic</span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># make -j 32</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># make -j 32 install</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># mkdir -p /mnt/log/nginx</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># chown -R nginx.nginx /mnt/log/nginx</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># cat &gt; /usr/lib/systemd/system/nginx.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=The NGINX HTTP and reverse proxy server</span><br><span class="line">Documentation=http://nginx.org/en/docs/</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStartPre=/mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf -t</span><br><span class="line">ExecStart=/mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP <span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/bin/<span class="built_in">kill</span> -s QUIT <span class="variable">$MAINPID</span></span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">Restart=always</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># systemctl start nginx</span></span><br><span class="line">[root@[x] nginx-1.12.1]<span class="comment"># systemctl enable nginx</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>keepalived安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y install keepalived ipvsadm</span></span><br><span class="line"></span><br><span class="line">[root@nginx21 ~]<span class="comment"># cat &gt; /etc/keepalived/keepalived.conf &lt;&lt;EOF</span></span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id HA_192.168.15.21</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_192.168.15.21 &#123;</span><br><span class="line">    state MASTER</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 21</span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 183</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.15.183</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@nginx22 ~]<span class="comment"># cat &gt; /etc/keepalived/keepalived.conf &lt;&lt;EOF</span></span><br><span class="line">global_defs &#123;</span><br><span class="line">   router_id HA_192.168.15.22</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_192.168.15.22 &#123;</span><br><span class="line">    state BACKUP</span><br><span class="line">    interface eth0</span><br><span class="line">    virtual_router_id 22</span><br><span class="line">    priority 90</span><br><span class="line">    advert_int 1</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass 183</span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.15.183</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/09/26/linux-nginx-install/" data-id="cjavy9jz8005e0coqfbnn2kfs" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-linux-system-init" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/22/linux-system-init/" class="article-date">
  <time datetime="2017-09-22T00:45:56.000Z" itemprop="datePublished">2017-09-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/CentOS/">CentOS</a>►<a class="article-category-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/22/linux-system-init/">linux system init</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="系统初始化"><a href="#系统初始化" class="headerlink" title="系统初始化"></a>系统初始化</h3><ol>
<li><p>查看系统版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.3.1611 (Core)</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># hostname &#123;hostname&#125; &amp;&amp; echo &#123;hostname&#125; | tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo '&#123;IP&#125; &#123;hostname&#125;' |tee -a /etc/hosts</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>硬盘格式化挂载</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@[x] ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置打开最大文件数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.com/epel/RPM-GPG-KEY-EPEL-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/epel.repo http://yum.ops.com/epel-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># rpm --import http://yum.ops.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@[x] ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://yum.ops.com/centos-7.repo</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum clean all &amp;&amp; yum makecache</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装基础依赖库和常用工具包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">mariadb mariadb-devel\</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel \</span><br><span class="line">libxml2* \</span><br><span class="line">libmcrypt* \</span><br><span class="line">libtool-ltdl-devel*</span><br><span class="line">[root@[x] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc bind-utils</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭selinux</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@[x] ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭防火墙</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置系统时区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[x] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># iptables -I INPUT -p udp --dport 123 -j ACCEPT</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>安装python,并设置python源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /usr/local/pyenv</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PYENV_ROOT="/usr/local/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@[x] ~]<span class="comment"># source /etc/profile</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@[x] ~]<span class="comment"># ls $&#123;PYENV_ROOT&#125;/cache/Python-2.7.13.tar.xz  将源码包放到这里</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@[x] ~]<span class="comment"># pyenv global 2.7.13</span></span><br><span class="line"></span><br><span class="line">[root@[x] ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@[x] ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常见目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@[x] ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/09/22/linux-system-init/" data-id="cjavy9jzc005h0coqg7zouevc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-HTTP-严格传输安全HSTS" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/18/HTTP-严格传输安全HSTS/" class="article-date">
  <time datetime="2017-09-18T02:51:48.000Z" itemprop="datePublished">2017-09-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Development/">Development</a>►<a class="article-category-link" href="/categories/Development/Doc/">Doc</a>►<a class="article-category-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/18/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="HTTP-严格传输安全HSTS"><a href="#HTTP-严格传输安全HSTS" class="headerlink" title="HTTP 严格传输安全HSTS"></a>HTTP 严格传输安全HSTS</h3><ol>
<li><p>简介</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HTTP严格传输安全(HSTS)是一种安全功能,WEB服务器通过它来告诉浏览器仅用HTTPS来与之通讯,而不是使用HTTP.</span><br></pre></td></tr></table></figure>
</li>
<li><p>HSTS是什么?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">如果一个WEB服务器支持HTTP访问,并将其重定向到HTTPS访问的话,那么访问者在重定向前的初始会话是非加密的.这就给了中间人攻击的一个机会,重定向可能会被破坏,从而定向到一个恶意站点而不是应该访问的加密页面</span><br><span class="line"></span><br><span class="line">HTTP严格传输安全(HSTS)功能使WEB服务器告知浏览器绝不使用HTTP访问,在浏览器端自动将所有到该站点的HTTP访问替换为HTTPS访问</span><br><span class="line"></span><br><span class="line">HSTS可以用来抵御SSL剥离攻击: SSL剥离攻击是中间人攻击的一种,由Moxie Marlinspike于2009年发明.他在当年的黑帽大会上发表的题为&quot;New Tricks For Defeating SSL In Practice&quot;的演讲中将这种攻击方式公开.SSL剥离的实施方法是阻止浏览器与服务器创建HTTPS连接.它的前提是用户很少直接在地址栏输入&quot;https://&quot;,用户总是通过点击链接或3xx重定向,从HTTP页面进入HTTPS页面.所以攻击者可以在用户访问HTTP页面时替换所有&quot;https://&quot;开头的链接为&quot;http://&quot;,达到阻止HTTPS的目的</span><br><span class="line"></span><br><span class="line">HSTS可以很大程度上解决SSL剥离攻击,因为只要浏览器曾经与服务器创建过一次安全连接,之后浏览器会强制使用HTTPS,即使链接被换成了HTTP.另外,如果中间人使用自己的自签名证书来进行攻击,浏览器会给出警告,但是许多用户会忽略警告.HSTS解决了这一问题,一旦服务器发送了HSTS字段,用户将不再允许忽略警告</span><br><span class="line"></span><br><span class="line">注意: 如果你之前没有使用HTTPS访问过该站点,那么HSTS是不奏效的.网站需要通过HTTPS协议告诉你的浏览器它支持HSTS</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务端开启HSTS</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">服务器开启HSTS的方法是,当客户端通过HTTPS发出请求时,在服务器返回的HTTP响应头中包含&quot;Strict-Transport-Security&quot;字段.非加密传输时设置的HSTS字段无效.</span><br><span class="line"></span><br><span class="line">nginx:</span><br><span class="line">在https的server中设置:</span><br><span class="line">add_header Strict-Transport-Security &quot;max-age:63072000;includeSubdomains;preload&quot;;</span><br><span class="line"></span><br><span class="line">apache:</span><br><span class="line">在virtualhost中添加:</span><br><span class="line">&lt;VirtualHost 1.1.1.1:443&gt;</span><br><span class="line">    Header always set Strict-Transport-Security &quot;max-age:63072000;includeSubdomains;preload&quot;</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">//HTTP重定向HTTPS</span><br><span class="line">&lt;VirtualHost *:80&gt;</span><br><span class="line">    ServerName test.com</span><br><span class="line">    Redirect permanent / https://test.com/</span><br><span class="line">&lt;/VirtualHost&gt;</span><br><span class="line"></span><br><span class="line">综上,</span><br><span class="line">在你的WEB站点在每次访问时都会发送该请求头,失效时间是两年(秒数).这个失效时间每次都会设置为两年后,所以,明天你访问时,它会设置为明天的两年后</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/09/18/HTTP-严格传输安全HSTS/" data-id="cjavy9jt9000b0coq01aeuofg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-一次完整的HTTP请求" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/15/一次完整的HTTP请求/" class="article-date">
  <time datetime="2017-09-15T03:23:33.000Z" itemprop="datePublished">2017-09-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Development/">Development</a>►<a class="article-category-link" href="/categories/Development/Doc/">Doc</a>►<a class="article-category-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/15/一次完整的HTTP请求/">一次完整的HTTP请求</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一次完整的HTTP请求"><a href="#一次完整的HTTP请求" class="headerlink" title="一次完整的HTTP请求"></a>一次完整的HTTP请求</h3><ol>
<li>一次性完整的HTTP请求过程<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1.域名解析 =&gt;</span><br><span class="line">2.发起TCP的3次握手 =&gt;</span><br><span class="line">3.发起HTTP请求 =&gt;</span><br><span class="line">4.服务器响应HTTP请求,浏览器得到HTML代码 =&gt;</span><br><span class="line">5.浏览器解析HTML代码,并请求HTML代码中的资源(如js,css,图片等)</span><br><span class="line">6.浏览器对页面进行渲染呈现给用户</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="详解请求过程"><a href="#详解请求过程" class="headerlink" title="详解请求过程"></a>详解请求过程</h3><ol>
<li><p>域名解析</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">在浏览器(Chrome)中输入域名&quot;www.smallasa.com&quot;,敲回车键,进行域名解析为IP地址:</span><br><span class="line">1.浏览器(Chrome)会首先搜索浏览器自身的DNS缓存</span><br><span class="line">  查看自身缓存中是否有&quot;www.smallasa.com&quot;对应的条目,而且没有过期.</span><br><span class="line">  如果有对应条目且没有过期,则解析到此结束</span><br><span class="line"></span><br><span class="line">  注意:浏览器缓存时间比较短,大概只有1分钟,且只能容纳1000条缓存</span><br><span class="line">  注意:浏览器(Chrome)自身缓存查看: chrome://net-internals/#dns</span><br><span class="line"></span><br><span class="line">2.如果浏览器自身的缓存里面没有找到对应的条目</span><br><span class="line">  那么浏览器会搜索操作系统自身的DNS缓存</span><br><span class="line">  如果找到且没有过期,则停止搜索解析并到此结束.</span><br><span class="line"></span><br><span class="line">  注意:</span><br><span class="line">  ipconfig/displaydns  windows查看dns缓存</span><br><span class="line">  nscg -d              linux查看dns缓存(linux系统一般默认关闭,yum -y install nscg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3.如果在系统自身的DNS缓存中也没有找到</span><br><span class="line">  那么尝试读取系统hosts文件,查找该域名对应的条目,如果有则解析成功</span><br><span class="line"></span><br><span class="line">  注意:</span><br><span class="line">  C:\Windows\System32\drivers\etc\hosts  windows hosts文件位置</span><br><span class="line">  /etc/hosts                             linux hosts文件位置</span><br><span class="line"></span><br><span class="line">4.如果在hosts文件中也没有找到对应的条目</span><br><span class="line">  浏览器就会发起一个DNS的系统调用,</span><br><span class="line">  该调用会向本地配置的首选DNS服务器发起域名解析请求(通过UDP协议向DNS的53端口发起请求,这个请求是递归的请求)</span><br><span class="line">  运营商的DNS服务器首先查找自身的缓存,找到对应的条目,且没有过期,则解析成功.</span><br><span class="line">  如果没有找到对应的条目,则由运营商的DNS代表我们的浏览器发起迭代DNS解析请求,它首先是会找根域的DNS的IP地址(这个DNS服务器都内置13台根域的DNS的IP地址),找到根域的DNS地址,就会向其发起请求(请问www.smallasa.com这个域名的IP地址是多少?),根域发现这是一个顶级域com域的一个域名,于是就告诉运营商的DNS我不知道这个域名的IP地址,但是我知道com域的IP地址,你去找它,于是运营商的DNS就得到了com域的IP地址,又向com域的IP地址发起了请求(请问www.smallasa.com这个域名的IP地址是多少?),com域这台服务器告诉运营商的DNS我不知道www.smallasa.com这个域名的IP地址,但是我知道smallasa.com这个域的DNS地址,你去找它,于是运营商的DNS又向smallasa.com这个域名的DNS地址发起请求(请问www.smallasa.com这个域名的IP地址是多少?),这个时候smallasa.com域的DNS服务器一查,果真在我这里,于是就把找到的结果发送给运营商的DNS服务器,这个时候运营商的DNS服务器就拿到了www.smallasa.com这个域名对应的IP地址,并返回给系统内核,内核又把结果返回给浏览器,终于浏览器拿到了www.smallasa.com对应的IP地址,该进行下一步TCP三次握手动作了</span><br><span class="line"></span><br><span class="line">如果经过以上的4个步骤,还没有解析成功,那么会进行如下步骤:</span><br><span class="line">(主要针对windows服务器)</span><br><span class="line">5.操作系统就会查找NetBIOS name Cache(NetBIOS名称缓存,就存在客户端电脑中的).凡是最近一段时间内和我成功通讯的计算机的计算机名和Ip地址,都会存在这个缓存里面.什么情况下该步能解析成功呢?就是该名称正好是几分钟前和我成功通信过,那么这一步就可以成功解析.</span><br><span class="line"></span><br><span class="line">6.如果NetBIOS name Cache解析不成功,那会查询WINS服务器(是NETBIOS名称和IP地址对应的服务器)</span><br><span class="line"></span><br><span class="line">7.如果查询WINS服务器也没有查询成功,那么客户端就要进行广播查找</span><br><span class="line"></span><br><span class="line">8.如果进行广播查找也没有成功,那么客户端就读取LMHOSTS文件(和HOSTS文件同一个目录下,写法也一样)</span><br><span class="line"></span><br><span class="line">9.如果读取LMHOSTS文件还没有解析成功,那么就宣告这次解析失败,那就无法跟目标计算机进行通信.</span><br><span class="line"></span><br><span class="line">只要这八步中有一步可以解析成功,那就可以成功和目标计算机进行通信</span><br></pre></td></tr></table></figure>
</li>
<li><p>发起TCP的三次握手</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">浏览器拿到域名对应的IP地址之后,浏览器User-Agent会以一个随机端口(1024&lt; 端口 &lt;65535)向服务器的WEB程序(httpd,nginx,IIS)80端口发起TCP的连接请求.这个连接请求(原始的http请求经过TCP/IP4层模型的层层封包)到达服务器端后(这中间通过各种路由设备,局域网内除外),进入到网卡,然后是进入到内核的TCP/IP协议栈(用于识别该连接请求,解封包,一层一层的剥开),还有可能要经过Netfilter防火墙(属于内核的模块)的过滤,最终到达WEB程序(本文就以Nginx为例),最终建立了TCP/IP的连接</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="一次完整的HTTP请求/TCP三次握手.jpg" alt="TCP三次握手"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.客户端首先发送一个连接试探,ACK=0表示确认号无效,SYN=1表示这是一个连接请求或连接接受报文,同时表示这个数据报不能携带数据,seq=J表示客户端自己的初始序号(seq=0代表这是第0号包),这时候客户端进入SYN_SENT状态,表示客户端等待服务器的回复</span><br><span class="line"></span><br><span class="line">2.服务端监听到连接请求报文后,如同意建立连接,则向Client发送确认.TCP报文首部中的SYN和ACK都置1,ack=J+1表示期望收到对方下一个报文段的第一个数据字节序号是J+1,同时表明J为止的所有数据都已正确收到(ack=1其实是ack=0+1,也就是期望客户端的第1个包),seq=K表示服务端自己的初始序号(seq=0代表这是服务器这边发出的第0号包).这时服务器进入SYN_REVD,表示服务器已经收到客户端的连接请求,等待客户端的确认</span><br><span class="line"></span><br><span class="line">3.客户端收到确认后还需再次发送确认,同时携带要发送给服务端的数据.ACK=1表示确认号,ack=K+1代表期望收到服务器的第1个包,客户端自己的序号seq=J+1表示这就是我的第1个包,相对于第0个包来说的,一旦收到Client的确认之后,这个TCP连接就进入Established状态,就可以发起http请求了</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>建立TCP连接后发起HTTP请求</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">进过TCP3次握手之后,浏览器发起了http的请求,使用的http的方法GET方法,请求的URL是/,协议是HTTP/1.0</span><br></pre></td></tr></table></figure>
</li>
<li><p>服务器端响应HTTP请求,浏览器得到HTML代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">服务器端WEB程序接收到HTTP请求以后,就开始处理该请求,处理之后就返回给浏览器html文件</span><br><span class="line"></span><br><span class="line">假设服务器端使用nginx+PHP(fastcgi)架构提供服务:</span><br><span class="line">1.nginx读取配置文件</span><br><span class="line">  我们在浏览器的地址栏里面输入的是&quot;www.smallasa.com&quot;,其实完整的应该是&quot;http://www.smallasa.com./&quot;,后面还有个点(这个点代表就是根域,一般情况下我们不用输入,也不显示),后面的&quot;/&quot;也是不用添加,浏览器会自动帮我们添加.那么实际请求的URL是&quot;http://www.smallasa.com/&quot;,Nginx在收到浏览器&quot;GET /&quot;请求时,会读取http请求里面的头部信息,根据Host来匹配 自己的所有的虚拟主机的配置文件的server_name,看看有没有匹配的,有匹配那么就读取该虚拟主机的配置,发现如下配置:</span><br><span class="line">  root /web/echo</span><br><span class="line">  通过这个配置就知道所有网页文件的就在这个目录下,这个目录就是&quot;/&quot;.当我们访问&quot;http://www.smallasa.com/&quot;时就是访问这个目录下面的文件.例如,&quot;http://www.smallasa.com/index.html&quot;,那么代表&quot;/web/echo&quot;下面有个文件叫&quot;index.html&quot;</span><br><span class="line"></span><br><span class="line">  index index.html index.htm index.php</span><br><span class="line">  通过这个就能得知网站的首页文件是那个文件,也就是我们在输入&quot;http://www.smallasa.com/&quot;,nginx就会自动帮我们把index.html加到后面,那么添加之后的URL是&quot;/index.html&quot;,然后根据后面的配置进行处理.</span><br><span class="line">  注意:假设首页是index.php,当然是会尝试的去找到该文件,如果没有找到该文件就依次往下找,如果这3个文件都没有找到,那么就抛出一个404错误</span><br><span class="line"></span><br><span class="line">  location ~ .*\.php(\/.*)*$ &#123;</span><br><span class="line">     root /web/echo;</span><br><span class="line">     fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">     fastcgi_index  index.php;</span><br><span class="line">     astcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;</span><br><span class="line">     include        fastcgi_params;</span><br><span class="line">  &#125;</span><br><span class="line">  这一段配置指明凡是请求的URL中匹配(这里是启用了正则表达式进行匹配)&quot;*.php&quot;后缀的,后面跟的参数的,都交给后端的fastcgi进程进行处理</span><br><span class="line"></span><br><span class="line">  把php文件交给fastcgi进程去处理:</span><br><span class="line">  于是nginx把&quot;/index.php&quot;这个URL交给了后端的fastcgi进程处理,等待fastcgi处理完成后(结合数据库查询出数据,填充模板生成html文件)返回给nginx一个index.html文档,Nginx再把这个index.html返回给浏览器,于是乎浏览器就拿到了首页的html代码,同时nginx写一条访问日志到日志文件中去</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  注1:nginx是怎么找index.php文件的？</span><br><span class="line">      当nginx发现需要&quot;/web/echo/index.php&quot;文件时,就会向内核发起IO系统调用(因为要跟硬件打交道,这里的硬件是指硬盘,通常需要靠内核来操作,而内核提供的这些功能是通过系统调用来实现的),告诉内核,我需要这个文件,内核从&quot;/&quot;开始找到web目录,再在web目录下找到echo目录,最后在echo目录下找到index.php文件,于是把这个index.php从硬盘上读取到内核自身的内存空间,然后再把这个文件复制到nginx进程所在的内存空间,于是乎nginx就得到了自己想要的文件了</span><br><span class="line"></span><br><span class="line">  注2:寻找文件在文件系统层面是怎么操作的?</span><br><span class="line">      每个分区(像ext3 ext3等文件系统,block块是文件存储的最小单元 默认是4096字节)都是包含元数据区和数据区,每一个文件在元数据区都有元数据条目(一般是128字节大小),每一个条目都有一个编号,我们称之为inode(index node 索引节点),这个inode里面包含:文件类型、权限、连接次数、属主和数组的ID、时间戳、这个文件占据了那些磁盘块也就是块的编号（block，每个文件可以占用多个block,并且block不一定是连续的，每个block是有编号的）还有一个要点：目录其实也普通是文件,也需要占用磁盘块,目录不是一个容器.你看默认创建的目录就是4096字节,也就说只需要占用一个磁盘块,但这是不确定的.所以要找到目录也是需要到元数据区里面找到对应的条目,只有找到对应的inode就可找到目录所占用的磁盘块</span><br><span class="line"></span><br><span class="line">      那么内核究竟是怎么找到index.php这个文件的呢？</span><br><span class="line">      内核拿到nginx的IO系统调用要获取/web/echo/index.php这个文件请求之后</span><br><span class="line">① 内核读取元数据区 / 的inode，从inode里面读取/所对应的数据块的编号，然后在数据区找到其对应的块（1 2号块），读取1号块上的映射表找到web这个名称在元数据区对应的inode号</span><br><span class="line">② 内核读取web对应的inode（3号），从中得知web在数据区对应的块是5号块，于是到数据区找到5号块，从中读取映射表，知道echo对应的inode是5号，于是到元数据区找到5号inode</span><br><span class="line">③ 内核读取5号inode，得到echo在数据区对应的是11号块，于是到数据区读取11号块得到映射表，得到index.php对应的inode是9号</span><br><span class="line">④ 内核到元数据区读取9号inode，得到index.php对应的是15和16号数据块，于是就到数据区域找到15 16号块，读取其中的内容，得到index.php的完整内容</span><br></pre></td></tr></table></figure>
</li>
<li><p>浏览器解析html代码,并请求html代码中的资源</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">浏览器拿到index.html文件后,就开始解析其中的html代码,遇到js/css/image等静态资源时,就向服务器端去请求下载(会使用多线程下载,每个浏览器的线程数不一样),这个时候就用上keep-alive特性了,建立一次HTTP连接,可以请求多个资源,下载资源的顺序就是按照代码里的顺序,但是由于每个资源大小不一样,而浏览器又多线程请求请求资源,所以从下图看出,这里显示的顺序并不一定是代码里面的顺序</span><br><span class="line"></span><br><span class="line">浏览器在请求静态资源时(在未过期的情况下),向服务器端发起一个http请求(询问自从上一次修改时间到现在有没有对资源进行修改),如果服务器端返回304状态码(告诉浏览器服务器端没有修改),那么浏览器会直接读取本地的该资源的缓存文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>浏览器对页面进行渲染呈现给用户</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">最后,浏览器利用自己内部的工作机制,把请求到的静态资源和HTML代码进行渲染,渲染之后呈现给用户</span><br><span class="line">自此一次完整的HTTP事务宣告完成</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/09/15/一次完整的HTTP请求/" data-id="cjavy9k8x00cb0coq415o4aeq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; 上一页</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/4/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
          <li>
            <a href="/2017/11/27/svn-auto-update/">svn auto update</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-event-reactor/">salt manage event reactor</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-job/">salt manage job</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>