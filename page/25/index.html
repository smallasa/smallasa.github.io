<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/25/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-redis-use" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-use/" class="article-date">
  <time datetime="2017-03-05T17:26:14.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-use/">redis use</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-use/">redis use</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. redis 批量删除key</span><br><span class="line">redis-cli keys R33111:* | xargs redis-cli del</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-use/" data-id="cjazexzl3009iqcoqjpoyyp23" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-postgresql-master-slave-info" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/postgresql-master-slave-info/" class="article-date">
  <time datetime="2017-03-05T17:24:20.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/postgresql-master-slave-info/">postgresql master slave info</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">postgres在9.0之后引入了主从的流复制机制,所谓流复制,就是从库通过tcp流从主库中同步相应的数据</span><br><span class="line">postgres的主从主称之为primary,从称为stand_by.</span><br><span class="line">主从配置需要注意的一个是主从的postgres的版本,环境,等最好都需要一致,否则可能产生奇奇怪怪的问题</span><br><span class="line"></span><br><span class="line">PG 主从同步有两种方式:</span><br><span class="line">1.hot standby的方式是备库只读的方式</span><br><span class="line">2.warm standby的方式是备库不能提供只读服务</span><br><span class="line"></span><br><span class="line">PG 主从同步有两种方法:</span><br><span class="line">1.使用归档文件,需要归档出wal文件,拷贝到从库上应用</span><br><span class="line">2.使用streaming方式,产生日志,马上应用到从库上,streaming两种方式:同步和异步</span><br><span class="line"></span><br><span class="line">PostgreSQL在数据目录下的pg_xlog子目录中维护了一个WAL日志文件,该文件用于记录数据库文件的每次改变,这种日志文件机制提供了一种数据库热备份的方案,即:</span><br><span class="line">在把数据库使用文件系统的方式备份出来的同时也把相应的WAL日志进行备份,即使备份出来的数据块不一致,也可以重放WAL日志把备份的内容推到一致状态.</span><br><span class="line">这也就是基于时间点的备份（Point-in-Time Recovery）,简称PITR.而把WAL日志传送到另一台服务器有两种方式,分别是：</span><br><span class="line">1.WAL日志归档（base-file）</span><br><span class="line">2.流复制（streaming replication）</span><br><span class="line">第一种是写完一个WAL日志后,才把WAL日志文件拷贝到standby数据库中,简言之就是通过cp命令实现远程备份,这样通常备库会落后主库一个WAL日志文件</span><br><span class="line">第二种流复制是postgresql9.x之后才提供的新的传递WAL日志的方法,它的好处是只要master库一产生日志,就会马上传递到standby库,同第一种相比有更低的同步延迟,所以我们肯定也会选择流复制的方式</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/postgresql-master-slave-info/" data-id="cjazexzix007nqcoq63s3b6pq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis-error" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-error/" class="article-date">
  <time datetime="2017-03-05T17:20:30.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-error/">redis error</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-error/">redis error</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1.install error</span><br><span class="line">zmalloc.h:50:31: error: jemalloc/jemalloc.h: No such file or directory</span><br><span class="line">zmalloc.h:55:2: error: #error &quot;Newer version of jemalloc required&quot;</span><br><span class="line">make[1]: *** [adlist.o] Error 1</span><br><span class="line">make[1]: Leaving directory `/data0/src/redis-2.6.2/src&apos;</span><br><span class="line">make: *** [all] Error 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resove:</span><br><span class="line">make MALLOC=libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cause:</span><br><span class="line">Allocator</span><br><span class="line">---------</span><br><span class="line">Selecting a non-default memory allocator when building Redis is done by setting</span><br><span class="line">the `MALLOC` environment variable. Redis is compiled and linked against libc</span><br><span class="line">malloc by default, with the exception of jemalloc being the default on Linux</span><br><span class="line">systems. This default was picked because jemalloc has proven to have fewer</span><br><span class="line">fragmentation problems than libc malloc.</span><br><span class="line">To force compiling against libc malloc, use:</span><br><span class="line">    % make MALLOC=libc</span><br><span class="line">To compile against jemalloc on Mac OS X systems, use:</span><br><span class="line">    % make MALLOC=jemalloc</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-error/" data-id="cjazexzko009dqcoqyac6uxv7" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-install/" class="article-date">
  <time datetime="2017-03-05T17:19:18.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-install/">redis install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-install/">redis install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="redis-standard-install"><a href="#redis-standard-install" class="headerlink" title="redis standard install"></a>redis standard install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># echo "net.core.somaxconn = 65535" | tee -a /etc/sysctl.conf</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo "vm.overcommit_memory = 1" | tee -a /etc/sysctl.conf</span></span><br><span class="line">[root@localhost app]<span class="comment"># sysctl -p</span></span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt;&gt; /etc/rc.local &lt;&lt;EOF</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/enabled;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never &gt; /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">EOF</span><br><span class="line">[root@localhost app]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf redis-3.2.6.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd redis-3.2.6/</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># make MALLOC=libc PREFIX=/mnt/app/redis install</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export REDIS_HOME=/mnt/app/redis'|tee /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export REDIS_BIN=$REDIS_HOME/bin'|tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export PATH=$REDIS_BIN:$PATH'|tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/app/redis/conf</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/data/redis</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/log/redis</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># cp redis.conf /mnt/app/redis/conf/redis.conf</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># chown -R wisdom.wisdom /mnt/app/redis</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># chown -R wisdom.wisdom /mnt/data/redis</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ vim /mnt/app/redis/conf/redis.conf</span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/redis/bin/redis-server /mnt/app/redis/conf/redis.conf</span><br></pre></td></tr></table></figure>
<h3 id="redis-master-slave-install"><a href="#redis-master-slave-install" class="headerlink" title="redis master slave install"></a>redis master slave install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf redis-3.2.8.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd redis-3.2.8</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># make MALLOC=libc PREFIX=/mnt/app/redis install</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.8]<span class="comment"># echo 'export REDIS_HOME=/mnt/app/redis' | tee /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># echo 'export REDIS_BIN=$REDIS_HOME/bin' | tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># echo 'export PATH=$REDIS_BIN:$PATH' | tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.8]<span class="comment"># mkdir -p /mnt/app/redis/conf/6379</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># cp redis.conf /mnt/app/redis/conf/6379/</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">redis-master:</span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/redis/6379</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># chown -R wisdom.wisdom /mnt/&#123;data,log&#125;/redis/6379</span></span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># vim /mnt/app/redis/conf/6379/redis.conf</span></span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">protected-mode yes</span><br><span class="line">port 6379</span><br><span class="line">tcp-backlog 2048</span><br><span class="line">unixsocket /mnt/data/redis/6379/redis.sock</span><br><span class="line">unixsocketperm 700</span><br><span class="line">timeout 120</span><br><span class="line">tcp-keepalive 60</span><br><span class="line">daemonize yes</span><br><span class="line">supervised no</span><br><span class="line">pidfile /mnt/data/redis/6379/redis.pid</span><br><span class="line">loglevel notice</span><br><span class="line">logfile <span class="string">"/mnt/log/redis/6379/redis.log"</span></span><br><span class="line">databases 16</span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line">rdbcompression yes</span><br><span class="line">rdbchecksum yes</span><br><span class="line">dbfilename 6379.rdb</span><br><span class="line">dir /mnt/data/redis/6379</span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line">slave-read-only yes</span><br><span class="line">repl-diskless-sync no</span><br><span class="line">repl-diskless-sync-delay 5</span><br><span class="line">repl-ping-slave-period 10</span><br><span class="line">repl-timeout 60</span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line">repl-backlog-size 200mb</span><br><span class="line">repl-backlog-ttl 3600</span><br><span class="line">slave-priority 100</span><br><span class="line">maxclients 10000</span><br><span class="line">appendonly yes</span><br><span class="line">appendfilename <span class="string">"6379.aof"</span></span><br><span class="line">appendfsync everysec</span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 4096mb</span><br><span class="line">aof-load-truncated yes</span><br><span class="line">lua-time-limit 5000</span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line">slowlog-max-len 1024</span><br><span class="line">latency-monitor-threshold 0</span><br><span class="line">notify-keyspace-events <span class="string">""</span></span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-entries 512</span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-value 64</span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line"><span class="built_in">set</span>-max-intset-entries 512</span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line">activerehashing yes</span><br><span class="line">client-output-buffer-limit normal 0 0 0</span><br><span class="line">client-output-buffer-limit slave 256mb 64mb 60</span><br><span class="line">client-output-buffer-limit pubsub 32mb 8mb 60</span><br><span class="line">hz 10</span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># chown -R wisdom.wisdom /mnt/app/redis/conf</span></span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/redis/bin/redis-server /mnt/app/redis/conf/6379/redis.conf</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">redis-slave:</span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/redis/6379</span></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># chown -R wisdom.wisdom /mnt/&#123;data,log&#125;/redis/6379</span></span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># vim /mnt/app/redis/conf/6379/redis.conf</span></span><br><span class="line"><span class="built_in">bind</span> 0.0.0.0</span><br><span class="line">protected-mode yes</span><br><span class="line">port 6379</span><br><span class="line">tcp-backlog 2048</span><br><span class="line">unixsocket /mnt/data/redis/6379/redis.sock</span><br><span class="line">unixsocketperm 700</span><br><span class="line">timeout 120</span><br><span class="line">tcp-keepalive 60</span><br><span class="line">daemonize yes</span><br><span class="line">supervised no</span><br><span class="line">pidfile /mnt/data/redis/6379/redis.pid</span><br><span class="line">loglevel notice</span><br><span class="line">logfile <span class="string">"/mnt/log/redis/6379/redis.log"</span></span><br><span class="line">databases 16</span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line">rdbcompression yes</span><br><span class="line">rdbchecksum yes</span><br><span class="line">dbfilename 6379.rdb</span><br><span class="line">dir /mnt/data/redis/6379</span><br><span class="line">slaveof 192.168.18.226 6379</span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line">slave-read-only yes</span><br><span class="line">repl-diskless-sync no</span><br><span class="line">repl-diskless-sync-delay 5</span><br><span class="line">repl-ping-slave-period 10</span><br><span class="line">repl-timeout 60</span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line">repl-backlog-size 200mb</span><br><span class="line">repl-backlog-ttl 3600</span><br><span class="line">slave-priority 100</span><br><span class="line">maxclients 10000</span><br><span class="line">appendonly yes</span><br><span class="line">appendfilename <span class="string">"6379.aof"</span></span><br><span class="line">appendfsync everysec</span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 4096mb</span><br><span class="line">aof-load-truncated yes</span><br><span class="line">lua-time-limit 5000</span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line">slowlog-max-len 1024</span><br><span class="line">latency-monitor-threshold 0</span><br><span class="line">notify-keyspace-events <span class="string">""</span></span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-entries 512</span><br><span class="line"><span class="built_in">hash</span>-max-ziplist-value 64</span><br><span class="line">list-max-ziplist-size -2</span><br><span class="line"><span class="built_in">set</span>-max-intset-entries 512</span><br><span class="line">zset-max-ziplist-entries 128</span><br><span class="line">zset-max-ziplist-value 64</span><br><span class="line">hll-sparse-max-bytes 3000</span><br><span class="line">activerehashing yes</span><br><span class="line">client-output-buffer-limit normal 0 0 0</span><br><span class="line">client-output-buffer-limit slave 256mb 64mb 60</span><br><span class="line">client-output-buffer-limit pubsub 32mb 8mb 60</span><br><span class="line">hz 10</span><br><span class="line">aof-rewrite-incremental-fsync yes</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># chown -R wisdom.wisdom /mnt/app/redis/conf</span></span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.8]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/redis/bin/redis-server /mnt/app/redis/conf/6379/redis.conf</span><br></pre></td></tr></table></figure>
<h3 id="redis-cluster-install"><a href="#redis-cluster-install" class="headerlink" title="redis cluster install"></a>redis cluster install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf redis-3.2.6.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd redis-3.2.6/</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># make MALLOC=libc PREFIX=/mnt/app/redis install</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export REDIS_HOME=/mnt/app/redis'|tee /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export REDIS_BIN=$REDIS_HOME/bin'|tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># echo 'export PATH=$REDIS_BIN:$PATH'|tee -a /etc/profile.d/redis.sh</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/app/redis/conf/&#123;7001,7002,7003,7004,7005,7006&#125;</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/data/redis/&#123;7001,7002,7003,7004,7005,7006&#125;</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># mkdir -p /mnt/log/redis/&#123;7001,7002,7003,7004,7005,7006&#125;</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># cp redis.conf /mnt/app/redis/conf/&#123;7001,7002,7003,7004,7005,7006&#125;/redis.conf</span></span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># chown -R wisdom.wisdom /mnt/app/redis/conf</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># chown -R wisdom.wisdom /mnt/data/redis</span></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># chown -R wisdom.wisdom /mnt/log/redis</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7001/redis.conf</span></span><br><span class="line">port 7001</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7001/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7001</span><br><span class="line">unixsocket /mnt/data/redis/7001/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7001/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7001/redis.log</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7002/redis.conf</span></span><br><span class="line">port 7002</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7002/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7002</span><br><span class="line">unixsocket /mnt/data/redis/7002/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7002/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7002/redis.log</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7003/redis.conf</span></span><br><span class="line">port 7003</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7003/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7003</span><br><span class="line">unixsocket /mnt/data/redis/7003/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7003/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7003/redis.log</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7004/redis.conf</span></span><br><span class="line">port 7004</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7004/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7004</span><br><span class="line">unixsocket /mnt/data/redis/7004/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7004/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7004/redis.log</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7005/redis.conf</span></span><br><span class="line">port 7005</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7005/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7005</span><br><span class="line">unixsocket /mnt/data/redis/7005/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7005/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7005/redis.log</span><br><span class="line"></span><br><span class="line">[root@localhost redis-3.2.6]<span class="comment"># vim /mnt/app/redis/conf/7006/redis.conf</span></span><br><span class="line">port 7006</span><br><span class="line">cluster-enabled yes</span><br><span class="line">cluster-config-file /mnt/data/redis/7006/nodes.conf</span><br><span class="line">cluster-node-timeout 5000</span><br><span class="line">appendonly yes</span><br><span class="line">dir /mnt/data/redis/7006</span><br><span class="line">unixsocket /mnt/data/redis/7006/redis.sock</span><br><span class="line">pidfile /mnt/data/redis/7006/redis.pid</span><br><span class="line">logfile /mnt/<span class="built_in">log</span>/redis/7006/redis.log</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost redis-3.2.6]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/redis/bin/redis-server /mnt/app/redis/conf/&#123;7001,7002,7003,7004,7005,7006&#125;/redis.conf &amp;</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># yum -y install ruby rubygem-redis</span></span><br><span class="line">[root@localhost app]<span class="comment"># tar xzf redis-3.2.6.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd redis-3.2.6/src</span></span><br><span class="line">[root@localhost src]<span class="comment"># ./redis-trib.rb create --replicas 1  127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006</span></span><br><span class="line"></span><br><span class="line">[root@localhost src]<span class="comment"># ./redis-trib.rb check 127.0.0.1:7001</span></span><br><span class="line">[root@localhost src]<span class="comment"># ./redis-trib.rb info 127.0.0.1:7001</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-install/" data-id="cjazexzko009fqcoqfjtgv2t1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-zookeeper-use" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/zookeeper-use/" class="article-date">
  <time datetime="2017-03-05T16:42:54.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/zookeeper/">zookeeper</a>►<a class="article-category-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/zookeeper-use/">zookeeper use</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">Zookeeper Server持久化两类数据:Transaction和Snapshot.</span><br><span class="line"></span><br><span class="line">logDir存储transaction命令,dataDir存储snap快照,其下子目录名称以version-2命名,子目录内部文件是分别以log.zxid和snapshot.lastProcessedZxid命名,每个目录下可以有很多个这样的文件,Transaction文件的文件名中zxid是文件中所有命令中zxid最小的zxid,而Snapshot中的lastProcessedZxid是最后一个操作的zxid,一般来讲是最大的zxid。</span><br><span class="line"></span><br><span class="line">事务日志记录的是当前要操作的命令以及命令参数,可以认为是动态的,快照记录的是当前的ZK静态数据结构:包括ACL,节点树,session/临时节点对应关系</span><br><span class="line"></span><br><span class="line">如下:</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1/bin$ ls -l /mnt/data/zookeeper.1/version-2/</span><br><span class="line">total 12</span><br><span class="line">-rw-rw-r-- 1 penn penn   1 Nov  3 14:12 acceptedEpoch</span><br><span class="line">-rw-rw-r-- 1 penn penn   1 Nov  3 14:12 currentEpoch</span><br><span class="line">-rw-rw-r-- 1 penn penn 296 Nov  3 14:12 snapshot.0</span><br><span class="line"></span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1/bin$ ls -l /mnt/log/zookeeper.1/version-2/</span><br><span class="line">total 8</span><br><span class="line">-rw-rw-r-- 1 penn penn 67108880 Nov  3 16:49 log.100000001</span><br><span class="line"></span><br><span class="line">日志文件可视化:</span><br><span class="line">默认存储的日志文件是二进制的,我们可以使用如下命令进行查看其存储内容:</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ java -cp ./zookeeper-3.4.9.jar:./lib/log4j-1.2.16.jar:./lib/slf4j-log4j12-1.6.1.jar:./lib/slf4j-api-1.6.1.jar org.apache.zookeeper.server.LogFormatter /mnt/log/zookeeper.1/version-2/log.100000001</span><br><span class="line"></span><br><span class="line">快照文件:</span><br><span class="line">Zookeeper的数据在内存中是以DataTree为数据结构存储的,而快照就是每间隔一段时间Zookeeper就会把整个DataTree的数据序列化然后把它存储在磁盘中,这就是Zookeeper的快照文件,快照文件是指定时间间隔对数据的备份,所以快照文件中数据通常都不是最新的,多久抓一个快照这也是可以配置的snapCount配置项用于配置处理几个事务请求后生成一个快照文件,与事务日志文件一样快照文件也是使用ZXID作为快照文件的后缀,在FileTxnSnapLog类中的save方法中生成文件并调用FileSnap类序列化DataTree数据并且写入快照文件中；</span><br><span class="line"></span><br><span class="line">快照文件可视化:</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ java -cp ./zookeeper-3.4.9.jar:./lib/log4j-1.2.16.jar:./lib/slf4j-log4j12-1.6.1.jar:./lib/slf4j-api-1.6.1.jar org.apache.zookeeper.server.SnapshotFormatter /mnt/data/zookeeper.1/version-2/snapshot.0</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="zookeeper基本操作"><a href="#zookeeper基本操作" class="headerlink" title="zookeeper基本操作"></a>zookeeper基本操作</h3><ol>
<li><p>查看当前ZK角色</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ <span class="built_in">cd</span> /mnt/app/zookeeper.1/bin/</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1/bin$ ./zkServer.sh status</span><br><span class="line">ZooKeeper JMX enabled by default</span><br><span class="line">Using config: /mnt/app/zookeeper.1/bin/../conf/zoo.cfg</span><br><span class="line">Mode: follower</span><br></pre></td></tr></table></figure>
</li>
<li><p>登录ZK</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:/mnt/app/zookeeper.1/bin$ ./zkCli.sh -server 10.0.2.15:2181</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看帮助</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">help</span></span><br><span class="line">ZooKeeper -server host:port cmd args</span><br><span class="line">        <span class="built_in">stat</span> path [watch]</span><br><span class="line">        <span class="built_in">set</span> path data [version]</span><br><span class="line">        ls path [watch]</span><br><span class="line">        delquota [-n|-b] path</span><br><span class="line">        ls2 path [watch]</span><br><span class="line">        setAcl path acl</span><br><span class="line">        setquota -n|-b val path</span><br><span class="line">        <span class="built_in">history</span></span><br><span class="line">        redo cmdno</span><br><span class="line">        printwatches on|off</span><br><span class="line">        delete path [version]</span><br><span class="line">        sync path</span><br><span class="line">        listquota path</span><br><span class="line">        rmr path</span><br><span class="line">        get path [watch]</span><br><span class="line">        create [-s] [-e] path data acl</span><br><span class="line">        addauth scheme auth</span><br><span class="line">        quit</span><br><span class="line">        getAcl path</span><br><span class="line">        close</span><br><span class="line">        connect host:port</span><br></pre></td></tr></table></figure>
</li>
<li><p>查询</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 0] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建znode节点”zk”并关联其字符串”MyData”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 1] create /zk <span class="string">"MyData"</span></span><br><span class="line">Created /zk</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 2] ls /</span><br><span class="line">[zk, zookeeper]</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//注意: 如果不关联字符串,并不会创建新的znode</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 3] create /<span class="built_in">test</span></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 4] ls /</span><br><span class="line">[zk, zookeeper]</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看是否包含所创建的字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 5] get /zk</span><br><span class="line">MyData</span><br><span class="line">cZxid = 0x100000006</span><br><span class="line">ctime = Thu Nov 03 14:46:39 CST 2016</span><br><span class="line">mZxid = 0x100000006</span><br><span class="line">mtime = Thu Nov 03 14:46:39 CST 2016</span><br><span class="line">pZxid = 0x100000006</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 6</span><br><span class="line">numChildren = 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>现在对关联的字符串进行设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 6] <span class="built_in">set</span> /zk <span class="string">"zsl"</span></span><br><span class="line">cZxid = 0x100000006</span><br><span class="line">ctime = Thu Nov 03 14:46:39 CST 2016</span><br><span class="line">mZxid = 0x100000007</span><br><span class="line">mtime = Thu Nov 03 14:51:12 CST 2016</span><br><span class="line">pZxid = 0x100000006</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 3</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 8] get /zk      </span><br><span class="line">zsl</span><br><span class="line">cZxid = 0x100000006</span><br><span class="line">ctime = Thu Nov 03 14:46:39 CST 2016</span><br><span class="line">mZxid = 0x100000007</span><br><span class="line">mtime = Thu Nov 03 14:51:12 CST 2016</span><br><span class="line">pZxid = 0x100000006</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 1</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 3</span><br><span class="line">numChildren = 0</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除zk node</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 9] delete /zk</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 10] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="zookeeper-进阶操作"><a href="#zookeeper-进阶操作" class="headerlink" title="zookeeper 进阶操作"></a>zookeeper 进阶操作</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 13] create /zk <span class="string">"test"</span></span><br><span class="line">Created /zk</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 14] ls /</span><br><span class="line">[zk, zookeeper]</span><br><span class="line"></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 15] create /zk/n1 <span class="string">"n1"</span>  </span><br><span class="line">Created /zk/n1</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 16] ls /zk</span><br><span class="line">[n1]</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 17] ls /zk/n1</span><br><span class="line">[]</span><br><span class="line"></span><br><span class="line">//如果zk有层次目录,delete删除不成功,需要使用rmr命令</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 18] delete /zk</span><br><span class="line">Node not empty: /zk</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 28] rmr /zk</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 29] ls /</span><br><span class="line">[zookeeper]</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="zookeeper-quota"><a href="#zookeeper-quota" class="headerlink" title="zookeeper quota"></a>zookeeper quota</h3><p><em>zookeeper quota机制支持节点个数(znode)和空间大小(字节数)</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//查看,默认是没有限制的</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 6] create /<span class="built_in">test</span> <span class="string">"test quota"</span></span><br><span class="line">Created /<span class="built_in">test</span></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 7] listquota /<span class="built_in">test</span></span><br><span class="line">absolute path is /zookeeper/quota/<span class="built_in">test</span>/zookeeper_limits</span><br><span class="line">quota <span class="keyword">for</span> /<span class="built_in">test</span> does not exist.</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//设置quota</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 9] setquota -n 3 /<span class="built_in">test</span>      </span><br><span class="line">Comment: the parts are option -n val 3 path /<span class="built_in">test</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//查看quota</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 10] listquota /<span class="built_in">test</span>          </span><br><span class="line">absolute path is /zookeeper/quota/<span class="built_in">test</span>/zookeeper_limits</span><br><span class="line">Output quota <span class="keyword">for</span> /<span class="built_in">test</span> count=3,bytes=-1</span><br><span class="line">Output <span class="built_in">stat</span> <span class="keyword">for</span> /<span class="built_in">test</span> count=1,bytes=10</span><br><span class="line">//-n表示设置znode count限制,这里表示/<span class="built_in">test</span>这个path下的znode count个数限制</span><br><span class="line">//-b表示设置znode数据的字节大小限制</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">//测试</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 14] create /<span class="built_in">test</span>/0 <span class="string">"0"</span></span><br><span class="line">Created /<span class="built_in">test</span>/0</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 15] create /<span class="built_in">test</span>/1 <span class="string">"1"</span></span><br><span class="line">Created /<span class="built_in">test</span>/1</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 16] create /<span class="built_in">test</span>/2 <span class="string">"2"</span></span><br><span class="line">Created /<span class="built_in">test</span>/2</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 17] create /<span class="built_in">test</span>/3 <span class="string">"3"</span></span><br><span class="line">Created /<span class="built_in">test</span>/3</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 18] ls /<span class="built_in">test</span></span><br><span class="line">[0, 1, 2, 3]</span><br><span class="line">//我们发现上面已经超过我们设置的3个znode,但依旧可以创建成功.说明zookeeper的Quota机制是比较温和的,即使超限了,只是在日志中报告一下,并不会限制Client的行为,Client可以继续操作znode</span><br><span class="line">//日志内容:</span><br><span class="line">//2016-11-03 16:38:08,876 [myid:1] - WARN  [CommitProcessor:1:DataTree@301] - Quota exceeded: /<span class="built_in">test</span> count=4 <span class="built_in">limit</span>=3</span><br><span class="line">//2016-11-03 16:38:12,998 [myid:1] - WARN  [CommitProcessor:1:DataTree@301] - Quota exceeded: /<span class="built_in">test</span> count=5 <span class="built_in">limit</span>=3</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">//查看quota内容</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 25] get /zookeeper/quota/<span class="built_in">test</span>/zookeeper_limits</span><br><span class="line">count=3,bytes=-1</span><br><span class="line">cZxid = 0x10000001f</span><br><span class="line">ctime = Thu Nov 03 16:34:55 CST 2016</span><br><span class="line">mZxid = 0x10000001f</span><br><span class="line">mtime = Thu Nov 03 16:34:55 CST 2016</span><br><span class="line">pZxid = 0x10000001f</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 16</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 26] get /zookeeper/quota/<span class="built_in">test</span>/zookeeper_stats</span><br><span class="line">count=5,bytes=14</span><br><span class="line">cZxid = 0x100000020</span><br><span class="line">ctime = Thu Nov 03 16:34:55 CST 2016</span><br><span class="line">mZxid = 0x100000020</span><br><span class="line">mtime = Thu Nov 03 16:34:55 CST 2016</span><br><span class="line">pZxid = 0x100000020</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 0</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 16</span><br><span class="line">numChildren = 0</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="zookeeper-权限认证"><a href="#zookeeper-权限认证" class="headerlink" title="zookeeper 权限认证"></a>zookeeper 权限认证</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ZooKeeper 的权限管理亦即 ACL 控制功能通过 Server , Client 两端协调完成:</span><br><span class="line">* Server 端</span><br><span class="line">  一个ZooKeeper的节点(znode)存储两部分内容:数据和状态(状态中包含ACL信息)</span><br><span class="line">  创建一个znode会产生一个ACL列表,列表中每个ACL包括：</span><br><span class="line">  1.验证模式 (scheme)</span><br><span class="line">  2.具体内容 (Id) （当 scheme=&quot;digest&quot;时,Id为用户名密码,例如&quot;root:J0sTy9BCUKubtK1y8pkbL7qoxSw=&quot;</span><br><span class="line">  3.权限(perms)</span><br><span class="line"></span><br><span class="line">  拓展:</span><br><span class="line">  ZooKeeper提供了如下几种验证模式(scheme):</span><br><span class="line">  1.digest</span><br><span class="line">    Client端由用户名和密码验证,譬如&quot;user:password&quot;,digest的密码生成方式是Sha1摘要的base64形式</span><br><span class="line">  2.auth</span><br><span class="line">    不使用任何id,代表任何已确认用户</span><br><span class="line">  3.ip</span><br><span class="line">    Client 端由 IP 地址验证，譬如 172.2.0.0/24</span><br><span class="line">  4.world</span><br><span class="line">    固定用户为 anyone,为所有 Client 端开放权限</span><br><span class="line">  5.super</span><br><span class="line">    在这种scheme情况下,对应的id拥有超级权限,可以做任何事情(cdrwa)</span><br><span class="line">  注意:exists操作和getAcl操作并不受ACL许可控制,因此任何客户端可以查询节点的状态和节点的ACL</span><br><span class="line"></span><br><span class="line">  节点的权限(perms)主要有以下几种:</span><br><span class="line">  1.Create 允许对子节点 Create 操作,c</span><br><span class="line">  2.Read 允许对本节点 GetChildren 和 GetData 操作,r</span><br><span class="line">  3.Write 允许对本节点 SetData 操作,w</span><br><span class="line">  4.Delete 允许对子节点 Delete 操作,d</span><br><span class="line">  5.Admin 允许对本节点 setAcl 操作,a</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//查看ACL</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 3] create /<span class="built_in">test</span> <span class="string">"test auth"</span></span><br><span class="line">Created /<span class="built_in">test</span></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 6] getAcl /<span class="built_in">test</span>          </span><br><span class="line"><span class="string">'world,'</span>anyone</span><br><span class="line">: cdrwa</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">2.设置ip策略</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 7] setAcl /<span class="built_in">test</span> ip:10.0.2.15:crwda    </span><br><span class="line">cZxid = 0x100000013</span><br><span class="line">ctime = Thu Nov 03 15:22:20 CST 2016</span><br><span class="line">mZxid = 0x100000013</span><br><span class="line">mtime = Thu Nov 03 15:22:20 CST 2016</span><br><span class="line">pZxid = 0x100000013</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 1</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 9</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 8] getAcl /<span class="built_in">test</span>                   </span><br><span class="line"><span class="string">'ip,'</span>10.0.2.15</span><br><span class="line">: cdrwa</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">3.设置digest策略</span><br><span class="line">//生成密钥</span><br><span class="line">penn@ubuntu:~$ <span class="built_in">cd</span> /mnt/app/zookeeper.1/</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ java -cp ./zookeeper-3.4.9.jar:./lib/log4j-1.2.16.jar:./lib/slf4j-log4j12-1.6.1.jar:./lib/slf4j-api-1.6.1.jar org.apache.zookeeper.server.auth.DigestAuthenticationProvider <span class="built_in">test</span>:<span class="built_in">test</span></span><br><span class="line"><span class="built_in">test</span>:<span class="built_in">test</span>-&gt;<span class="built_in">test</span>:V28q/NynI4JI3Rk54h0r8O5kMug=</span><br><span class="line"></span><br><span class="line">//设置权限</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 2] setAcl /<span class="built_in">test</span> digest:<span class="built_in">test</span>:V28q/NynI4JI3Rk54h0r8O5kMug=:crwda</span><br><span class="line">cZxid = 0x100000013</span><br><span class="line">ctime = Thu Nov 03 15:22:20 CST 2016</span><br><span class="line">mZxid = 0x100000013</span><br><span class="line">mtime = Thu Nov 03 15:22:20 CST 2016</span><br><span class="line">pZxid = 0x100000013</span><br><span class="line">cversion = 0</span><br><span class="line">dataVersion = 0</span><br><span class="line">aclVersion = 2</span><br><span class="line">ephemeralOwner = 0x0</span><br><span class="line">dataLength = 9</span><br><span class="line">numChildren = 0</span><br><span class="line"></span><br><span class="line">//查看权限</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 3] getAcl /<span class="built_in">test</span></span><br><span class="line"><span class="string">'digest,'</span><span class="built_in">test</span>:V28q/NynI4JI3Rk54h0r8O5kMug=</span><br><span class="line">: cdrwa</span><br><span class="line"></span><br><span class="line">//验证</span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 4] ls /<span class="built_in">test</span></span><br><span class="line">Authentication is not valid : /<span class="built_in">test</span></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 5] addauth digest <span class="built_in">test</span>:<span class="built_in">test</span></span><br><span class="line">[zk: 10.0.2.15:2181(CONNECTED) 6] ls /<span class="built_in">test</span>                </span><br><span class="line">[]</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">4.设置超级管理员</span><br><span class="line">//设置super用户密</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ java -cp ./zookeeper-3.4.9.jar:./lib/log4j-1.2.16.jar:./lib/slf4j-log4j12-1.6.1.jar:./lib/slf4j-api-1.6.1.jar org.apache.zookeeper.server.auth.DigestAuthenticationProvider super:super</span><br><span class="line">super:super-&gt;super:gG7s8t3oDEtIqF6DM9LlI/R+9Ss=</span><br><span class="line"></span><br><span class="line">//将密码添加到zkServer.sh中</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ vim /mnt/app/zookeeper.1/bin/zkServer.sh</span><br><span class="line">SUPER_ACL=<span class="string">"-Dzookeeper.DigestAuthenticationProvider.superDigest=super:gG7s8t3oDEtIqF6DM9LlI/R+9Ss="</span></span><br><span class="line"></span><br><span class="line">//在start启动选项中,添加</span><br><span class="line">nohup <span class="string">"<span class="variable">$JAVA</span>"</span> <span class="string">"-Dzookeeper.log.dir=<span class="variable">$&#123;ZOO_LOG_DIR&#125;</span>"</span> <span class="string">"-Dzookeeper.root.logger=<span class="variable">$&#123;ZOO_LOG4J_PROP&#125;</span>"</span> <span class="string">"<span class="variable">$&#123;SUPER_ACL&#125;</span>"</span> -cp <span class="string">"<span class="variable">$CLASSPATH</span>"</span> <span class="variable">$JVMFLAGS</span> <span class="variable">$ZOOMAIN</span> <span class="string">"<span class="variable">$ZOOCFG</span>"</span> &gt; <span class="string">"<span class="variable">$_ZOO_DAEMON_OUT</span>"</span> 2&gt;&amp;1 &lt; /dev/null &amp;</span><br><span class="line"></span><br><span class="line">//重启zookeeper</span><br><span class="line">penn@ubuntu:/mnt/app/zookeeper.1$ /mnt/app/zookeeper.1/bin/zkServer.sh restart</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">5.ACL请求过程</span><br><span class="line">一次Client对znode进行操作的验证ACL的方式为:</span><br><span class="line">a.遍历znode的所有ACL:</span><br><span class="line">  i.对于每一个ACL,首先操作类型与权限(perms)匹配</span><br><span class="line"> ii.只有匹配权限成功才进行session的auth信息与ACL的用户名,密码匹配</span><br><span class="line">b.如果两次匹配都成功,则允许操作;否则,返回权限不够error(rc=-102)</span><br><span class="line"></span><br><span class="line">注意: 如果znode ACL List中任何一个ACL都没有setAcl权限,那么就算superDigest也修改不了它的权限,再假如这个znode还不开放delete权限,那么它的所有子节点都将不会被删除.唯一的办法是通过手动删除snapshot和log的方法,将ZK回滚到一个以前的状态,然后重启,当然这会影响到该znode以外其它节点的正常应用.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">6.ACL缺陷</span><br><span class="line">ACL仅仅是访问控制,并非完善的权限管理,通过这种方式做多集群隔离,还有很多局限性:ACL并无递归机制,任何一个znode创建后,都需要单独设置ACL,无法继承父节点的ACL设置.除了ip这种scheme,digest和auth的使用对用户都不是透明的,这也给使用带来了很大的成本,很多依赖zookeeper的开源框架也没有加入对ACL的支持,例如hbase，storm.</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/zookeeper-use/" data-id="cjazey0a80191qcoq2wro70fn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-zookeeper-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/zookeeper-install/" class="article-date">
  <time datetime="2017-03-05T16:41:54.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/zookeeper/">zookeeper</a>►<a class="article-category-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/zookeeper-install/">zookeeper install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="java-install"><a href="#java-install" class="headerlink" title="java install"></a>java install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf jdk-8u73-linux-x64.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv jdk1.8.0_73 /mnt/app/java</span></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R root.root /mnt/app/java</span></span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source  /etc/profile</span></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="zookeeper-standard-install"><a href="#zookeeper-standard-install" class="headerlink" title="zookeeper standard install"></a>zookeeper standard install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@10 app]<span class="comment"># tar xzf zookeeper-3.4.6.tar.gz</span></span><br><span class="line">[root@10 app]<span class="comment"># mv zookeeper-3.4.6 /mnt/app/zookeeper</span></span><br><span class="line"></span><br><span class="line">[root@10 app]<span class="comment"># chown -R wisdom.wisdom /mnt/app/zookeeper</span></span><br><span class="line"></span><br><span class="line">[root@10 app]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/zookeeper</span></span><br><span class="line">[root@10 app]<span class="comment"># chown -R wisdom.wisdom /mnt/&#123;data,log&#125;/zookeeper</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@10 app]<span class="comment"># echo 'export ZK_HOME=/mnt/app/zookeeper' | tee /etc/profile.d/zookeeper.sh</span></span><br><span class="line">[root@10 app]<span class="comment"># echo 'export ZK_BIN=$&#123;ZK_HOME&#125;/bin' | tee -a /etc/profile.d/zookeeper.sh                   </span></span><br><span class="line">[root@10 app]<span class="comment"># echo 'export PATH=$&#123;ZK_BIN&#125;:$PATH' | tee -a /etc/profile.d/zookeeper.sh                      </span></span><br><span class="line">[root@10 app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@10 app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zoo.cfg &lt;&lt;EOF</span></span><br><span class="line">&gt; tickTime=2000</span><br><span class="line">&gt; initLimit=10</span><br><span class="line">&gt; syncLimit=5</span><br><span class="line">&gt; clientPort=2181</span><br><span class="line">&gt; clientPortAddress=10.0.2.113</span><br><span class="line">&gt; dataDir=/mnt/data/zookeeper</span><br><span class="line">&gt; dataLogDir=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; autopurge.snapRetainCount=3</span><br><span class="line">&gt; autopurge.purgeInterval=1</span><br><span class="line">&gt; EOF</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@10 app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zookeeper-env.sh &lt;&lt;EOF</span></span><br><span class="line">&gt; ZOO_LOG_DIR=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; EOF</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@10 ~]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/java.env &lt;&lt;EOF</span></span><br><span class="line">&gt; <span class="built_in">export</span> JAVA_HOME=/mnt/app/java</span><br><span class="line">&gt; <span class="built_in">export</span> JVMFLAGS=<span class="string">"-Xms1024m -Xmx1024m <span class="variable">$JVMFLAGS</span>"</span>   </span><br><span class="line">&gt; EOF</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@10 app]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@10 ~]$ /mnt/app/zookeeper/bin/zkServer.sh start</span><br><span class="line">[wisdom@10 ~]$ /mnt/app/zookeeper/bin/zkServer.sh status</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="zookeeper-cluster-install"><a href="#zookeeper-cluster-install" class="headerlink" title="zookeeper cluster install"></a>zookeeper cluster install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf zookeeper-3.4.6.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv zookeeper-3.4.6 /mnt/app/zookeeper</span></span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R root.root /mnt/app/zookeeper</span></span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/zookeeper</span></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R wisdom.wisdom /mnt/&#123;data,log&#125;/zookeeper</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># echo 'export ZK_HOME=/mnt/app/zookeeper' | tee /etc/profile.d/zookeeper.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export ZK_BIN=$&#123;ZK_HOME&#125;/bin' | tee -a /etc/profile.d/zookeeper.sh                   </span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;ZK_BIN&#125;:$PATH' | tee -a /etc/profile.d/zookeeper.sh                      </span></span><br><span class="line">[root@localhost app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ZK-cluster-1:</span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zookeeper-env.sh &lt;&lt;EOF</span></span><br><span class="line">&gt; ZOO_LOG_DIR=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/data/zookeeper/myid &lt;&lt;EOF</span></span><br><span class="line">&gt; 228</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zoo.cfg &lt;&lt;EOF</span></span><br><span class="line">&gt; tickTime=2000</span><br><span class="line">&gt; initLimit=5</span><br><span class="line">&gt; syncLimit=2</span><br><span class="line">&gt; clientPort=2181</span><br><span class="line">&gt; clientPortAddress=192.168.18.228</span><br><span class="line">&gt; maxClientCnxns=2000</span><br><span class="line">&gt; autopurge.snapRetainCount=5</span><br><span class="line">&gt; autopurge.purgeInterval=3</span><br><span class="line">&gt; dataDir=/mnt/data/zookeeper</span><br><span class="line">&gt; dataLogDir=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; server.228=192.168.18.228:3181:4181</span><br><span class="line">&gt; server.229=192.168.18.229:3181:4181</span><br><span class="line">&gt; server.230=192.168.18.230:3181:4181</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/java.env &lt;&lt;EOF</span></span><br><span class="line">&gt; <span class="built_in">export</span> JAVA_HOME=/mnt/app/java</span><br><span class="line">&gt; <span class="built_in">export</span> JVMFLAGS=<span class="string">"-Xms1024m -Xmx1024m <span class="variable">$JVMFLAGS</span>"</span>   </span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R wisdom.wisdom /mnt/app/zookeeper/conf</span></span><br><span class="line">[root@localhost app]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/zookeeper/bin/zkServer.sh start</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ZK-cluster-2:</span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zookeeper-env.sh &lt;&lt;EOF</span></span><br><span class="line">&gt; ZOO_LOG_DIR=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/data/zookeeper/myid &lt;&lt;EOF</span></span><br><span class="line">&gt; 229</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zoo.cfg &lt;&lt;EOF</span></span><br><span class="line">&gt; tickTime=2000</span><br><span class="line">&gt; initLimit=5</span><br><span class="line">&gt; syncLimit=2</span><br><span class="line">&gt; clientPort=2181</span><br><span class="line">&gt; clientPortAddress=192.168.18.229</span><br><span class="line">&gt; maxClientCnxns=2000</span><br><span class="line">&gt; autopurge.snapRetainCount=5</span><br><span class="line">&gt; autopurge.purgeInterval=3</span><br><span class="line">&gt; dataDir=/mnt/data/zookeeper</span><br><span class="line">&gt; dataLogDir=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; server.228=192.168.18.228:3181:4181</span><br><span class="line">&gt; server.229=192.168.18.229:3181:4181</span><br><span class="line">&gt; server.230=192.168.18.230:3181:4181</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/java.env &lt;&lt;EOF</span></span><br><span class="line">&gt; <span class="built_in">export</span> JAVA_HOME=/mnt/app/java</span><br><span class="line">&gt; <span class="built_in">export</span> JVMFLAGS=<span class="string">"-Xms1024m -Xmx1024m <span class="variable">$JVMFLAGS</span>"</span>   </span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R wisdom.wisdom /mnt/app/zookeeper/conf</span></span><br><span class="line">[root@localhost app]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/zookeeper/bin/zkServer.sh start</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ZK-cluster-3:</span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zookeeper-env.sh &lt;&lt;EOF</span></span><br><span class="line">&gt; ZOO_LOG_DIR=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/data/zookeeper/myid &lt;&lt;EOF</span></span><br><span class="line">&gt; 230</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/zoo.cfg &lt;&lt;EOF</span></span><br><span class="line">&gt; tickTime=2000</span><br><span class="line">&gt; initLimit=5</span><br><span class="line">&gt; syncLimit=2</span><br><span class="line">&gt; clientPort=2181</span><br><span class="line">&gt; clientPortAddress=192.168.18.230</span><br><span class="line">&gt; maxClientCnxns=2000</span><br><span class="line">&gt; autopurge.snapRetainCount=5</span><br><span class="line">&gt; autopurge.purgeInterval=3</span><br><span class="line">&gt; dataDir=/mnt/data/zookeeper</span><br><span class="line">&gt; dataLogDir=/mnt/<span class="built_in">log</span>/zookeeper</span><br><span class="line">&gt; server.228=192.168.18.228:3181:4181</span><br><span class="line">&gt; server.229=192.168.18.229:3181:4181</span><br><span class="line">&gt; server.230=192.168.18.230:3181:4181</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># cat &gt; /mnt/app/zookeeper/conf/java.env &lt;&lt;EOF</span></span><br><span class="line">&gt; <span class="built_in">export</span> JAVA_HOME=/mnt/app/java</span><br><span class="line">&gt; <span class="built_in">export</span> JVMFLAGS=<span class="string">"-Xms1024m -Xmx1024m <span class="variable">$JVMFLAGS</span>"</span>   </span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">[root@localhost app]<span class="comment"># chown -R wisdom.wisdom /mnt/app/zookeeper/conf</span></span><br><span class="line">[root@localhost app]<span class="comment"># su - wisdom</span></span><br><span class="line">[wisdom@localhost ~]$ /mnt/app/zookeeper/bin/zkServer.sh start</span><br></pre></td></tr></table></figure>
<h3 id="zookeeper-cluster-info"><a href="#zookeeper-cluster-info" class="headerlink" title="zookeeper cluster info"></a>zookeeper cluster info</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]# cat /mnt/app/zookeeper/conf/zoo.cfg</span><br><span class="line">tickTime=2000</span><br><span class="line">initLimit=5</span><br><span class="line">syncLimit=2</span><br><span class="line">clientPort=2181</span><br><span class="line">clientPortAddress=192.168.18.230</span><br><span class="line">maxClientCnxns=2000</span><br><span class="line">autopurge.snapRetainCount=5</span><br><span class="line">autopurge.purgeInterval=3</span><br><span class="line">dataDir=/mnt/data/zookeeper</span><br><span class="line">dataLogDir=/mnt/log/zookeeper</span><br><span class="line">server.228=192.168.18.228:3181:4181</span><br><span class="line">server.229=192.168.18.229:3181:4181</span><br><span class="line">server.230=192.168.18.230:3181:4181</span><br><span class="line"></span><br><span class="line">集群参数说明:</span><br><span class="line">server.A=B:C:D</span><br><span class="line">* A是一个数字,表示这个是第几号服务器</span><br><span class="line">* B是这个服务器的ip地址</span><br><span class="line">* C表示这个服务器与集群中的Leader服务器交换信息的端口</span><br><span class="line">* D表示的是集群选举通信端口.例如:集群中的Leader服务器挂了,需要一个端口来重新进行选举,选出一个新的Leader,而这个端口就是用来执行选举时服务器相互通信的端口</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/zookeeper-install/" data-id="cjazey09t018uqcoqp46r582q" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-rsync-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/rsync-install/" class="article-date">
  <time datetime="2017-03-05T16:28:43.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/rsync/">rsync</a>►<a class="article-category-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/rsync-install/">rsync install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="rsync介绍"><a href="#rsync介绍" class="headerlink" title="rsync介绍"></a>rsync介绍</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rsync是类unix系统下的数据镜像备份工具,从软件的命名上就可以看出来了——remote sync</span><br><span class="line">它的特性如下:</span><br><span class="line">1.可以镜像保存整个目录树和文件系统</span><br><span class="line">2.可以很容易做到保持原来文件的权限、时间、软硬链接等等</span><br><span class="line">3.无须特殊权限即可安装</span><br><span class="line">4.优化的流程,文件传输效率高</span><br><span class="line">5.可以使用rcp,ssh等方式来传输文件,当然也可以通过直接的socket连接</span><br><span class="line">6.支持匿名传输,以方便进行网站镜象</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="rsync-安装"><a href="#rsync-安装" class="headerlink" title="rsync 安装"></a>rsync 安装</h3><ol>
<li><p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># yum -y install rsync* inotify-tools*</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建rsyncd用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># useradd -M -s /sbin/nologin rsyncd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建配置文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mkdir -p /etc/rsyncd</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># touch /etc/rsyncd/rsyncd.conf</span></span><br><span class="line">[root@localhost ~]<span class="comment"># touch /etc/rsyncd/rsyncd.secrets</span></span><br><span class="line">[root@localhost ~]<span class="comment"># touch /etc/rsyncd/rsyncd.motd</span></span><br><span class="line">说明:</span><br><span class="line">rsyncd.conf     主配置文件</span><br><span class="line">rsyncd.secrets  用户名密码文件,一组用户一行,用户名和密码使用:分割</span><br><span class="line">rsyncd.motd     非必须,连接上rsyncd显示的欢迎信息</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod 600 /etc/rsyncd/rsyncd.secrets</span></span><br><span class="line">注意: rsyncd.secrets权限必须是600</span><br></pre></td></tr></table></figure>
</li>
<li><p>编辑配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /etc/rsyncd/rsyncd.conf</span></span><br><span class="line"><span class="comment">#rsyncd 守护进程运行系统用户全局配置，也可在具体的块中独立配置,</span></span><br><span class="line">uid = root</span><br><span class="line">gid = root</span><br><span class="line"><span class="comment"># 守护进程监听ip</span></span><br><span class="line">address = 0.0.0.0</span><br><span class="line"><span class="comment"># 护进程监听端口</span></span><br><span class="line">port = 873</span><br><span class="line"><span class="comment"># 守护进程pid文件</span></span><br><span class="line">pid file = /var/run/rsyncd.pid</span><br><span class="line"><span class="comment"># 守护进程lock文件</span></span><br><span class="line">lock file = /var/run/rsyncd.lock</span><br><span class="line"><span class="comment">#允许chroot,提升安全性,客户端连接模块,首先chroot到模块path参数指定的目录下</span></span><br><span class="line"><span class="comment">#chroot为yes时必须使用root权限,且不能备份path路径外的链接文件</span></span><br><span class="line">use chroot = yes</span><br><span class="line"><span class="comment">#只读</span></span><br><span class="line"><span class="built_in">read</span> only = no</span><br><span class="line"><span class="comment">#只写</span></span><br><span class="line">write only = no</span><br><span class="line"><span class="comment">#允许访问rsyncd服务的ip,ip端或者单独ip之间使用空格隔开</span></span><br><span class="line">hosts allow = 0.0.0.0/0</span><br><span class="line"><span class="comment">#不允许访问rsyncd服务的ip,*是全部(不涵盖在hosts allow中声明的ip,注意和hosts allow的先后顺序)</span></span><br><span class="line">hosts deny = *</span><br><span class="line"><span class="comment">#客户端最大连接数</span></span><br><span class="line">max connections = 20</span><br><span class="line"><span class="comment">#欢迎文件路径，可选的</span></span><br><span class="line"><span class="comment">#motd file = /etc/rsyncd/rsyncd.motd</span></span><br><span class="line"><span class="comment"># 是否记录传输文件日志</span></span><br><span class="line">transfer logging = yes</span><br><span class="line"><span class="comment"># 日志文件格式</span></span><br><span class="line"><span class="built_in">log</span> format = %t %a %m %f %b</span><br><span class="line"><span class="comment"># 指定rsync发送消息日志文件,而不是发送给syslog,如果不填这个参数默认发送给syslog</span></span><br><span class="line"><span class="built_in">log</span> file = /var/<span class="built_in">log</span>/rsyncd.log</span><br><span class="line"><span class="comment"># syslog facility rsync发送消息给syslog时的消息级别</span></span><br><span class="line">syslog facility = local3</span><br><span class="line"><span class="comment"># timeout连接超时时间</span></span><br><span class="line">timeout = 300</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模块 模块名称必须使用[]环绕</span></span><br><span class="line"><span class="comment"># 比如:要访问data1,则地址应该是data1user@192.168.1.2::data1</span></span><br><span class="line">[<span class="built_in">test</span>]</span><br><span class="line"><span class="comment">#模块根目录,必须指定</span></span><br><span class="line">path = /home/vsftpduser/ftpdata/<span class="built_in">test</span></span><br><span class="line"><span class="comment">#只读</span></span><br><span class="line"><span class="built_in">read</span> only = yes</span><br><span class="line"><span class="comment">#是否允许列出模块里的内容</span></span><br><span class="line">list=no</span><br><span class="line"><span class="comment"># 忽略错误</span></span><br><span class="line"><span class="comment"># ignore errors</span></span><br><span class="line"><span class="comment"># 模块验证用户名称,可使用空格或者逗号隔开多个用户名</span></span><br><span class="line">auth users = testsync</span><br><span class="line"><span class="comment"># 模块验证密码文件 可放在全局配置里</span></span><br><span class="line">secrets file = /etc/rsyncd/rsyncd.secrets</span><br><span class="line"><span class="comment"># 注释</span></span><br><span class="line">comment = <span class="built_in">test</span> ftp data</span><br><span class="line"><span class="comment"># 排除目录,多个之间使用空格隔开</span></span><br><span class="line">exclude = <span class="built_in">test</span>/</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">补充:</span><br><span class="line"># 主要定义符及含义：</span><br><span class="line"># %h远程主机名</span><br><span class="line"># %a远程IP地址</span><br><span class="line"># %l文件长度字符数</span><br><span class="line"># %p该次rsync会话的进程id</span><br><span class="line"># %o操作类型：&quot;send&quot;或&quot;recv&quot;</span><br><span class="line"># %f文件名</span><br><span class="line"># %P模块路径</span><br><span class="line"># %m模块名</span><br><span class="line"># %t当前时间</span><br><span class="line"># %u认证的用户名(匿名时是null)</span><br><span class="line"># %b实际传输的字节数</span><br><span class="line"># %c当发送文件时，该字段记录该文件的校验码</span><br><span class="line">#默认log格式为：&quot;%o %h [%a] %m (%u) %f %l&quot;，一般来说,在每行的头上会添加&quot;%t [%p] &quot;。</span><br><span class="line">log format=%o %h [%a] %m (%u) %f %l</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动rsyncd服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># /usr/bin/rsync --daemon --config=/etc/rsyncd/rsyncd.conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端测试</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">方式一: 通过SSH同步</span><br><span class="line">1.将当前key拷贝到服务端用户目录</span><br><span class="line">[ec2-user@god ~]$ ssh-keygen</span><br><span class="line">[ec2-user@god ~]$ ssh-copy-id -i ~/.ssh/id_rsa.pub root@1.1.1.1 -p22</span><br><span class="line"></span><br><span class="line">2.通过客户端进行同步</span><br><span class="line">//表示同步目录</span><br><span class="line">[ec2-user@god ~]$ rsync -avzHP --delete --progress --bwlimit=1000000 -e &quot;ssh -p 22&quot; root@1.1.1.1:/home/vsftpduser/ftpdata/test ./test</span><br><span class="line">//表示同步目录下的文件(不包含目录本身)</span><br><span class="line">[ec2-user@god ~]$ rsync -avzHP --delete --progress --bwlimit=1000000 -e &quot;ssh -p 22&quot; root@1.1.1.1:/home/vsftpduser/ftpdata/test/ ./test</span><br><span class="line">注意:</span><br><span class="line">a 保留文件原有权限,用户,用户组,时间且递归的copy包括链接文件,块设备在内的所有文件</span><br><span class="line">v 显示传输信息</span><br><span class="line">P 显示传输进度</span><br><span class="line">H 保留硬链接</span><br><span class="line">z 压缩传输内容进行传输</span><br><span class="line">--delete   删除那些DST中SRC没有的文件</span><br><span class="line">--progress 显示备份过程</span><br><span class="line">--bwlimit  限制带宽,字节/秒</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">方式二:通过rsync账号和密码同步</span><br><span class="line">客户端:</span><br><span class="line">[ec2-user@god ~]$ vim rsync.pass  //注意文件中只保存密码</span><br><span class="line">qxn9fav</span><br><span class="line">[ec2-user@god ~]$ chmod 600 rsync.pass  //密码文件必须是600</span><br><span class="line"></span><br><span class="line">//表示同步目录下的文件</span><br><span class="line">[ec2-user@god ~]$ rsync -avzHP --delete --progress --bwlimit=1000000 --port 52003 --password-file=rsync.pass sspsync@1.1.1.1::test ./test</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="inotify-tools安装"><a href="#inotify-tools安装" class="headerlink" title="inotify-tools安装"></a>inotify-tools安装</h3><ol>
<li><p>安装后文件存放在:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/bin/inotifywait</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/inotifywatch</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改内核参数:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/sysctl.conf</span><br><span class="line">fs.inotify.max_queued_events=99999999</span><br><span class="line">fs.inotify.max_user_watches=99999999</span><br><span class="line">fs.inotify.max_user_instances=65536</span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">说明:</span><br><span class="line">max_queued_events  inotify队列最大长度,如果值太小,会出现&quot;** Event Queue Overflow **&quot;错误,导致监控文件不准确</span><br><span class="line">max_user_watches   要同步的文件包含多少目录,可以用：&quot;find /home/www.osyunwei.com -type d | wc -l&quot;统计,必须保证max_user_watches值大于统计结果</span><br><span class="line">max_user_instances 每个用户创建inotify实例最大值</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写脚本进行实时推送</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rsync_inotify.sh</span><br><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">src=/opt/<span class="built_in">test</span>/</span><br><span class="line">/usr/<span class="built_in">local</span>/bin/inotifywait -mrq --timefmt <span class="string">'%d/%m/%y %H:%M'</span> --format <span class="string">'%T %w%f%e'</span> -e close_write,delete,create,attrib <span class="variable">$src</span> | <span class="keyword">while</span> <span class="built_in">read</span> file;<span class="keyword">do</span></span><br><span class="line">  /usr/bin/rsync -arzuq <span class="variable">$src</span> 192.168.0.2::www/</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">"  <span class="variable">$&#123;file&#125;</span> was rsynced"</span> &gt;&gt;/opt/soft/<span class="built_in">log</span>/rsync.log 2&gt;&amp;1</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">chmod +x rsync_inotify.sh</span><br><span class="line"></span><br><span class="line">./rsync_inotify.sh &amp;</span><br></pre></td></tr></table></figure>
</li>
<li><p>拓展</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-m 是保持一直监听</span><br><span class="line">-r 是递归查看目录</span><br><span class="line">-q 是打印出事件</span><br><span class="line">-e create,move,delete,modify,attrib 是指&quot;监听 创建 移动 删除 写入 权限&quot;事件</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/rsync-install/" data-id="cjazexzl3009oqcoq5vqri5fz" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-modules-path" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/04/python-modules-path/" class="article-date">
  <time datetime="2017-03-04T08:55:00.000Z" itemprop="datePublished">2017-03-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>►<a class="article-category-link" href="/categories/Python/Python-modules/">Python modules</a>►<a class="article-category-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/04/python-modules-path/">python modules path</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><p>查看当前python的模块路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import sys</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(sys.path)</span><br><span class="line">[<span class="string">''</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python27.zip'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7/plat-linux2'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7/lib-tk'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7/lib-old'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7/lib-dynload'</span>, <span class="string">'/root/.pyenv/versions/2.7.13/lib/python2.7/site-packages'</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加模块路径</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># export PYTHONPATH=/path/to/pylib:$PYTHONPATH</span></span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/04/python-modules-path/" data-id="cjazexzjd0089qcoqyrrgsoty" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-modules-use" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/04/python-modules-use/" class="article-date">
  <time datetime="2017-03-04T07:44:48.000Z" itemprop="datePublished">2017-03-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>►<a class="article-category-link" href="/categories/Python/Python-modules/">Python modules</a>►<a class="article-category-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/04/python-modules-use/">python modules use</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li>pylint</li>
</ol>
<ul>
<li><p>pylint 说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pylint是一个python代码检查工具,可以帮助python程序员方便地检查程序代码的语法和风格</span><br></pre></td></tr></table></figure>
</li>
<li><p>pylint安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@penn mnt]<span class="comment"># pip install pylint</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol>
<li>ipython</li>
</ol>
<ul>
<li><p>ipython 说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipython 是交互式的一个友好插件</span><br></pre></td></tr></table></figure>
</li>
<li><p>ipython 安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pip install ipython</span></span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/04/python-modules-use/" data-id="cjazexzjd008aqcoqxvypaps3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-python-pyenv-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/04/python-pyenv-install/" class="article-date">
  <time datetime="2017-03-04T07:36:39.000Z" itemprop="datePublished">2017-03-04</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Python/">Python</a>►<a class="article-category-link" href="/categories/Python/Python-install/">Python install</a>►<a class="article-category-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/04/python-pyenv-install/">python pyenv install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ul>
<li><p>pyenv 安装依赖包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@dev ~]<span class="comment"># yum -y install readline readline-devel readline-static openssl openssl-devel openssl-static sqlite-devel bzip2-devel bzip2-libs</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git ~/.pyenv</span></span><br><span class="line">or:</span><br><span class="line">[root@localhost ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git /mnt/app/pyenv</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># echo 'export PYENV_ROOT="$HOME/.pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">or:</span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export PYENV_ROOT="/mnt/app/pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@localhost ~]<span class="comment"># exec $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv-virtual 安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># git clone https://github.com/yyuu/pyenv-virtualenv.git $(pyenv root)/plugins/pyenv-virtualenv</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv-virtual 环境变量设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># echo 'eval "$(pyenv virtualenv-init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@localhost ~]<span class="comment"># exec $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><p>pyenv 更新</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cd $(pyenv root)</span></span><br><span class="line">[root@localhost .pyenv]<span class="comment"># git pull</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 删除</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># rm -rf $(pyenv root)</span></span><br><span class="line">[root@localhost ~]<span class="comment"># rm -rf /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@localhost ~]<span class="comment"># exec $SHELL</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 查看当前版本(系统版本)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv versions</span></span><br><span class="line">* system (<span class="built_in">set</span> by /root/.pyenv/version)</span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 查看版本列表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv install --list</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 安装python</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv rehash</span></span><br><span class="line"></span><br><span class="line">or:</span><br><span class="line">[root@localhost ~]<span class="comment"># mkdir -p $&#123;PYENV_ROOT&#125;/cache</span></span><br><span class="line">[root@localhost ~]<span class="comment"># v=2.7.13;wget -P /usr/local/pyenv/cache/ http://mirrors.sohu.com/python/$v/Python-$v.tar.xz;python install $v</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 设置全局版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv global 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv versions</span></span><br><span class="line">  system</span><br><span class="line">* 2.7.13 (<span class="built_in">set</span> by /root/.pyenv/version)</span><br><span class="line">[root@localhost ~]<span class="comment"># python -V</span></span><br><span class="line">Python 2.7.13</span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 设置本地版本,优先级高于global</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv local 2.7.13</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>pyenv 设置shell版本,优先级高于local,global</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv shell 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv shell --unset 2.7.13</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>python 卸载python</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv uninstall 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv rehash</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<ul>
<li><p>创建虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv virtualenv 2.7.13 myenv</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>查看当前的虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv virtualenvs</span></span><br><span class="line">  2.7.13/envs/myenv (created from /root/.pyenv/versions/2.7.13)</span><br><span class="line">  myenv (created from /root/.pyenv/versions/2.7.13)</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv uninstall myenv</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>切换到虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># pyenv activate myenv</span></span><br><span class="line">pyenv-virtualenv: prompt changing will be removed from future release. configure `<span class="built_in">export</span> PYENV_VIRTUALENV_DISABLE_PROMPT=1<span class="string">' to simulate the behavior.</span></span><br><span class="line"><span class="string">(myenv) [root@localhost ~]#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">注意:</span></span><br><span class="line"><span class="string">export PYENV_VIRTUALENV_DISABLE_PROMPT=1   表示关闭(myenv)</span></span><br><span class="line"><span class="string">export PYENV_VIRTUALENV_DISABLE_PROMPT=$1  表示打开(myenv)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>退出虚拟环境</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(myenv) [root@localhost ~]<span class="comment"># source deactivate</span></span><br><span class="line">pyenv-virtualenv: deactivate 2.7.13/envs/myenv</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/04/python-pyenv-install/" data-id="cjazexzjd008fqcoqko8k5ewm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/24/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><a class="page-number" href="/page/24/">24</a><span class="page-number current">25</span><a class="page-number" href="/page/26/">26</a><a class="page-number" href="/page/27/">27</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/26/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Domain/">Domain</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Domain/nslookup-dns-search/">nslookup dns search</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-checkout-bat/">svn checkout bat</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-server-for-windows/">svn server for windows</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/12/08/svn-checkout-bat/">svn checkout bat</a>
          </li>
        
          <li>
            <a href="/2017/12/08/svn-server-for-windows/">svn server for windows</a>
          </li>
        
          <li>
            <a href="/2017/12/08/nslookup-dns-search/">nslookup dns search</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>