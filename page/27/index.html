<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/27/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-postgresql-namespace-database-schema-table-user-role-relation" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/02/postgresql-namespace-database-schema-table-user-role-relation/" class="article-date">
  <time datetime="2017-03-02T08:11:03.000Z" itemprop="datePublished">2017-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/02/postgresql-namespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-用户和角色的关系"><a href="#1-用户和角色的关系" class="headerlink" title="1. 用户和角色的关系"></a>1. 用户和角色的关系</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">1.创建角色</span><br><span class="line">postgres=<span class="comment"># create role irole PASSWORD 'iuser' ;                      </span></span><br><span class="line">CREATE ROLE</span><br><span class="line"></span><br><span class="line">2.创建用户</span><br><span class="line">postgres=<span class="comment"># create user iuser PASSWORD 'iuser';        </span></span><br><span class="line">CREATE ROLE</span><br><span class="line"></span><br><span class="line">3.使用角色登录</span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres -U irole</span><br><span class="line">psql: FATAL:  role <span class="string">"irole"</span> is not permitted to <span class="built_in">log</span> <span class="keyword">in</span></span><br><span class="line"></span><br><span class="line">4.使用用户登录</span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres -U iuser</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">postgres=&gt; \q</span><br></pre></td></tr></table></figure>
<h2 id="由上-我们可以看出用户和角色的差别在于：用户有登录权限-角色没有登录权限"><a href="#由上-我们可以看出用户和角色的差别在于：用户有登录权限-角色没有登录权限" class="headerlink" title="由上,我们可以看出用户和角色的差别在于：用户有登录权限,角色没有登录权限"></a><strong>由上,我们可以看出用户和角色的差别在于：用户有登录权限,角色没有登录权限</strong></h2><h3 id="2-数据库和模式的关系"><a href="#2-数据库和模式的关系" class="headerlink" title="2. 数据库和模式的关系"></a>2. 数据库和模式的关系</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">1. 创建数据库</span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">postgres=<span class="comment"># create database mydb;</span></span><br><span class="line">CREATE DATABASE</span><br><span class="line">postgres=<span class="comment"># \l</span></span><br><span class="line">                                  List of databases</span><br><span class="line">   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   </span><br><span class="line">-----------+----------+----------+-------------+-------------+-----------------------</span><br><span class="line"> mydb      | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span><br><span class="line"> postgres  | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span><br><span class="line"> template0 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line"> template1 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line">(4 rows)</span><br><span class="line">postgres=<span class="comment"># \q</span></span><br><span class="line"></span><br><span class="line">2.对用户和角色授权</span><br><span class="line">postgres=<span class="comment"># grant all privileges on database mydb to iuser;          </span></span><br><span class="line">GRANT</span><br><span class="line">postgres=<span class="comment"># grant all privileges on database mydb to irole;</span></span><br><span class="line">GRANT</span><br><span class="line"></span><br><span class="line">3.使用用户登录数据库mydb,查看当前的模式</span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d mydb -U iuser</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">mydb=&gt; \dn</span><br><span class="line">  List of schemas</span><br><span class="line">  Name  |  Owner   </span><br><span class="line">--------+----------</span><br><span class="line"> public | smallasa</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">说明: 数据库默认有一个public模式</span><br><span class="line"></span><br><span class="line">4.在mydb中创建一张表,并查看表的映射关系</span><br><span class="line">mydb=&gt; CREATE TABLE <span class="built_in">test</span>(id <span class="built_in">integer</span> not null);</span><br><span class="line">CREATE TABLE</span><br><span class="line">mydb=&gt; \d</span><br><span class="line">       List of relations</span><br><span class="line"> Schema | Name | Type  | Owner</span><br><span class="line">--------+------+-------+-------</span><br><span class="line"> public | <span class="built_in">test</span> | table | iuser</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">说明:默认表创建在了public模式中</span><br><span class="line"></span><br><span class="line">5.创建一个新模式</span><br><span class="line">mydb=&gt; create schema myschema authorization iuser;</span><br><span class="line">CREATE SCHEMA</span><br><span class="line"></span><br><span class="line">mydb=&gt; create schema mydb authorization irole;      </span><br><span class="line">ERROR:  must be member of role <span class="string">"irole"</span></span><br><span class="line"></span><br><span class="line">说明: 我们创建一个模式myschema,并给它授权iuser的权限; 上面创建模式时为它授权irole的权限失败,是因为当前登录用户为iuser,iuser用户没有在irole中</span><br><span class="line">重要说明: role相当于一个组,理想创建方式为:首先创建一个role,其次对role授权,然后创建N个用户,将用户加入到role.此时加入到role的用户拥有role的权限</span><br><span class="line"></span><br><span class="line">6.在指定的模式内创建表</span><br><span class="line">mydb=&gt; create table myschema.test(id <span class="built_in">integer</span> not null);   </span><br><span class="line">CREATE TABLE</span><br><span class="line"></span><br><span class="line">7.切换到创建的新模式</span><br><span class="line">mydb=&gt; <span class="built_in">set</span> search_path to myschema;</span><br><span class="line">SET</span><br><span class="line">mydb=&gt; show search_path;           </span><br><span class="line"> search_path</span><br><span class="line">-------------</span><br><span class="line"> myschema</span><br><span class="line">(1 row)</span><br><span class="line">说明,如果不切换到新模式下,无法看到表的列表信息</span><br><span class="line"></span><br><span class="line">8.查看列表信息</span><br><span class="line">mydb=&gt; \dt</span><br><span class="line">        List of relations</span><br><span class="line">  Schema  | Name | Type  | Owner</span><br><span class="line">----------+------+-------+-------</span><br><span class="line"> myschema | <span class="built_in">test</span> | table | iuser</span><br><span class="line">(1 row)</span><br><span class="line"></span><br><span class="line">9.补充一:删除schema中的表</span><br><span class="line">mydb=&gt; drop table myschema.test;</span><br><span class="line">or:</span><br><span class="line">mydb=&gt; <span class="built_in">set</span> search_path to myschema;</span><br><span class="line">mydb=&gt; drop table <span class="built_in">test</span>;</span><br><span class="line"></span><br><span class="line">10.补充二: 删除schema</span><br><span class="line">mydb=&gt; drop schema myschema;   //删除空的schema</span><br><span class="line">or</span><br><span class="line">mydb=&gt; drop schema myschema cascade;  //强制删除非空schema</span><br></pre></td></tr></table></figure>
<p><strong>综上,模式是数据库的逻辑分割.一个数据库可以有多个模式.数据库内的对象是被创建在模式内的</strong></p>
<h2 id="注意-用户登录到系统-连接到一个数据库后-是通过该数据库的search-path来寻找schema的搜索顺序-可以通过命令”show-search-path-”-具体的顺序-也可以通过”SET-search-path-TO-‘schema-name’”-来修改顺序"><a href="#注意-用户登录到系统-连接到一个数据库后-是通过该数据库的search-path来寻找schema的搜索顺序-可以通过命令”show-search-path-”-具体的顺序-也可以通过”SET-search-path-TO-‘schema-name’”-来修改顺序" class="headerlink" title="注意: 用户登录到系统,连接到一个数据库后,是通过该数据库的search_path来寻找schema的搜索顺序,可以通过命令”show search_path;”.具体的顺序,也可以通过”SET search_path TO ‘schema_name’” 来修改顺序."></a><em>注意: 用户登录到系统,连接到一个数据库后,是通过该数据库的search_path来寻找schema的搜索顺序,可以通过命令”show search_path;”.具体的顺序,也可以通过”SET search_path TO ‘schema_name’” 来修改顺序.</em></h2><h3 id="3-表空间和数据库关系"><a href="#3-表空间和数据库关系" class="headerlink" title="3. 表空间和数据库关系"></a>3. 表空间和数据库关系</h3><p><strong>数据库创建语句”CREATE DATABASE dbname”默认的数据库所有者是当前创建数据库的角色,默认的表空间是系统的默认表空间–”pg_default”</strong><br><strong>在PostgreSQL中,数据的创建是通过克隆数据库模板来实现的,这与SQL SERVER是同样的机制</strong><br><strong>由于”CREATE DATABASE dbname”并没有指明数据库模板,所以系统将默认克隆template1数据库,得到新的数据库dbname.而template1数据库的默认表空间是pg_default,这个表空间是在数据库初始化时创建的,所以所有template1中的对象将被同步克隆到新的数据库中.</strong><br><strong>相对完整的语法应该是这样的：”CREATE DATABASE dbname OWNER kanon TEMPLATE template1 TABLESPACE tablespacename;”</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.创建表空间存放位置</span><br><span class="line">[smallasa@localhost ~]$ mkdir /mnt/data/pgsql/tablespace</span><br><span class="line"></span><br><span class="line">2.创建表空间</span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br><span class="line">postgres=<span class="comment"># create tablespace tspace owner smallasa location '/mnt/data/pgsql/tablespace';</span></span><br><span class="line"></span><br><span class="line">3.创建数据库</span><br><span class="line">postgres=<span class="comment"># create database dbname template template1 owner smallasa tablespace tspace;</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><ul>
<li>表空间是一个存储区域,在一个表空间中可以存储多个数据库,尽管PostgreSQL不建议这么做,但我们这么做完全可行</li>
<li>一个数据库并不知直接存储表结构等对象的,而是在数据库中逻辑创建了至少一个模式,在模式中创建了表等对象,将不同的模式指派该不同的角色,可以实现权限分离,又可以通过授权,实现模式间对象的共享,并且,还有一个特点就是：public模式可以存储大家都需要访问的对象.</li>
</ul>
<p><strong>注意:</strong><br><em>既然一个表在创建的时候可以指定表空间,那么,是否可以给一个表指定它所在的数据库表空间之外的表空间呢？</em><br><strong>完全可以,但这不是违背了表属于模式,而模式属于数据库,数据库最终存在于指定表空间这个网的模型了吗?是的,看上去这确实是不合常理的,但这么做又是有它的道理的,而且现实中,我们往往需要这么做:将表的数据存在一个较慢的磁盘上的表空间，而将表的索引存在于一个快速的磁盘上的表空间.但我们再查看表所属的模式还是没变的,它依然属于指定的模式.所以这并不违反常理.实际上,PostgreSQL并没有限制一张表必须属于某个特定的表空间,我们之所以会这么认为,是因为在关系递进时,偷换了一个概念:模式是逻辑存在的,它不受表空间的限制!!!</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/02/postgresql-namespace-database-schema-table-user-role-relation/" data-id="cjavy9k2g007l0coq3fa1y5el" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-postgresql-book-use" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/02/postgresql-book-use/" class="article-date">
  <time datetime="2017-03-02T06:02:52.000Z" itemprop="datePublished">2017-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/02/postgresql-book-use/">postgresql book use</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-连接数据库"><a href="#1-连接数据库" class="headerlink" title="1. 连接数据库"></a>1. 连接数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># su - smallasa</span></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">postgres=<span class="comment"># select version();</span></span><br><span class="line">                                                 version                                                  </span><br><span class="line">----------------------------------------------------------------------------------------------------------</span><br><span class="line"> PostgreSQL 9.6.1 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-11), 64-bit</span><br><span class="line">(1 row)</span><br><span class="line">postgres=<span class="comment"># \q</span></span><br></pre></td></tr></table></figure>
<p>  <strong>说明:</strong></p>
<ul>
<li>连接PG数据库时,必须先切换到PG启动用户,此时是”su - smallasa”</li>
<li>-d 表示需要连接的数据库</li>
<li>\q 表示退出PG控制台</li>
</ul>
<hr>
<h3 id="2-创建数据库"><a href="#2-创建数据库" class="headerlink" title="2. 创建数据库"></a>2. 创建数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/createdb mydb</span><br><span class="line"></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d mydb</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">mydb=<span class="comment"># \l</span></span><br><span class="line">                                  List of databases</span><br><span class="line">   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   </span><br><span class="line">-----------+----------+----------+-------------+-------------+-----------------------</span><br><span class="line"> mydb      | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span><br><span class="line"> postgres  | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span><br><span class="line"> template0 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line"> template1 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line">(4 rows)</span><br><span class="line">mydb=<span class="comment"># \q</span></span><br></pre></td></tr></table></figure>
<p>  <strong>说明:</strong></p>
<ul>
<li>\l 表示显示数据库列表</li>
</ul>
<hr>
<h3 id="3-删除数据库"><a href="#3-删除数据库" class="headerlink" title="3. 删除数据库"></a>3. 删除数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/dropdb mydb</span><br><span class="line"></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d mydb</span><br><span class="line">psql: FATAL:  database <span class="string">"mydb"</span> does not exist</span><br><span class="line"></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br><span class="line">psql (9.6.1)</span><br><span class="line">Type <span class="string">"help"</span> <span class="keyword">for</span> <span class="built_in">help</span>.</span><br><span class="line">postgres=<span class="comment"># \l</span></span><br><span class="line">                                  List of databases</span><br><span class="line">   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges   </span><br><span class="line">-----------+----------+----------+-------------+-------------+-----------------------</span><br><span class="line"> postgres  | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 |</span><br><span class="line"> template0 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line"> template1 | smallasa | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/smallasa          +</span><br><span class="line">           |          |          |             |             | smallasa=CTc/smallasa</span><br><span class="line">(3 rows)</span><br><span class="line">postgres=<span class="comment"># \q</span></span><br></pre></td></tr></table></figure>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/02/postgresql-book-use/" data-id="cjavy9k2l007o0coq000swy37" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-postgresql-standard" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/02/postgresql-standard/" class="article-date">
  <time datetime="2017-03-02T04:53:30.000Z" itemprop="datePublished">2017-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/02/postgresql-standard/">postgresql standard</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-源码安装"><a href="#1-源码安装" class="headerlink" title="1. 源码安装"></a>1. 源码安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf postgresql-9.6.1.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd postgresql-9.6.1</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># ./configure --prefix=/mnt/app/pgsql</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># make</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<h3 id="2-插件安装"><a href="#2-插件安装" class="headerlink" title="2. 插件安装"></a>2. 插件安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cd contrib/</span></span><br><span class="line">[root@localhost contrib]<span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<p>  <strong>补充: 安装一个插件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cd contrib/pgcrypto/</span></span><br><span class="line">[root@localhost pgcrypto]<span class="comment"># mkdir install</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-环境变量设置"><a href="#3-环境变量设置" class="headerlink" title="3. 环境变量设置"></a>3. 环境变量设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PGSQL_HOME=/mnt/app/pgsql' | tee /etc/profile.d/postgresql.sh</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PGSQL_BIN=$&#123;PGSQL_HOME&#125;/bin' | tee -a /etc/profile.d/postgresql.sh                   </span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PATH=$&#123;PGSQL_BIN&#125;:$PATH' | tee -a /etc/profile.d/postgresql.sh                        </span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
<h3 id="4-创建数据和日志存放位置"><a href="#4-创建数据和日志存放位置" class="headerlink" title="4. 创建数据和日志存放位置"></a>4. 创建数据和日志存放位置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/pgsql</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># chown -R smallasa.smallasa /mnt/&#123;data,log&#125;/pgsql</span></span><br></pre></td></tr></table></figure>
<h3 id="5-初始化数据库"><a href="#5-初始化数据库" class="headerlink" title="5. 初始化数据库"></a>5. 初始化数据库</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># su - smallasa</span></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/initdb -D /mnt/data/pgsql/</span><br></pre></td></tr></table></figure>
<h3 id="6-设置访问权限"><a href="#6-设置访问权限" class="headerlink" title="6. 设置访问权限"></a>6. 设置访问权限</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/pg_hba.conf</span><br><span class="line"><span class="built_in">local</span>   all             all                                     trust</span><br><span class="line">host    all             all             127.0.0.1/32            trust</span><br><span class="line">host    all             all             ::1/128                 trust</span><br><span class="line">host    all             all             0.0.0.0/0               md5</span><br></pre></td></tr></table></figure>
<h3 id="7-修改配置文件"><a href="#7-修改配置文件" class="headerlink" title="7. 修改配置文件"></a>7. 修改配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/postgresql.conf</span><br><span class="line">listen_addresses = <span class="string">'\*'</span></span><br><span class="line">port = 5432</span><br><span class="line">max_connections = 2000</span><br></pre></td></tr></table></figure>
<p>  <strong>补充:设置PG连接数,需要修改内核参数kernel.sem</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOF</span></span><br><span class="line">&gt; kernel.sem = 50100 128256000 50100 2560</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># sysctl -p</span></span><br></pre></td></tr></table></figure></p>
<h3 id="8-启动服务"><a href="#8-启动服务" class="headerlink" title="8. 启动服务"></a>8. 启动服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/pg_ctl -D /mnt/data/pgsql/ -l /mnt/<span class="built_in">log</span>/pgsql/pgsql.log start</span><br></pre></td></tr></table></figure>
<h3 id="9-登录数据库进行验证"><a href="#9-登录数据库进行验证" class="headerlink" title="9. 登录数据库进行验证"></a>9. 登录数据库进行验证</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/02/postgresql-standard/" data-id="cjavy9k2r007t0coqynmulhg1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-postgresql-master-slave" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/02/postgresql-master-slave/" class="article-date">
  <time datetime="2017-03-02T04:52:28.000Z" itemprop="datePublished">2017-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/02/postgresql-master-slave/">postgresql master slave</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-源码安装"><a href="#1-源码安装" class="headerlink" title="1. 源码安装"></a>1. 源码安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf postgresql-9.6.1.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd postgresql-9.6.1</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># ./configure --prefix=/mnt/app/pgsql</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># make</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<h3 id="2-插件安装"><a href="#2-插件安装" class="headerlink" title="2. 插件安装"></a>2. 插件安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cd contrib/</span></span><br><span class="line">[root@localhost contrib]<span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<p>  <strong>补充: 安装一个插件</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cd contrib/pgcrypto/</span></span><br><span class="line">[root@localhost pgcrypto]<span class="comment"># mkdir install</span></span><br></pre></td></tr></table></figure></p>
<h3 id="3-环境变量设置"><a href="#3-环境变量设置" class="headerlink" title="3. 环境变量设置"></a>3. 环境变量设置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PGSQL_HOME=/mnt/app/pgsql' | tee /etc/profile.d/postgresql.sh</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PGSQL_BIN=$&#123;PGSQL_HOME&#125;/bin' | tee -a /etc/profile.d/postgresql.sh                   </span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># echo 'export PATH=$&#123;PGSQL_BIN&#125;:$PATH' | tee -a /etc/profile.d/postgresql.sh                        </span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
<h3 id="4-创建数据和日志存放位置"><a href="#4-创建数据和日志存放位置" class="headerlink" title="4. 创建数据和日志存放位置"></a>4. 创建数据和日志存放位置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/pgsql</span></span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># chown -R smallasa.smallasa /mnt/&#123;data,log&#125;/pgsql</span></span><br></pre></td></tr></table></figure>
<h3 id="5-PG-master服务器上操作"><a href="#5-PG-master服务器上操作" class="headerlink" title="5. PG master服务器上操作"></a>5. PG master服务器上操作</h3><h5 id="1-初始化数据库"><a href="#1-初始化数据库" class="headerlink" title="1. 初始化数据库"></a>1. 初始化数据库</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># su - smallasa</span></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/initdb -D /mnt/data/pgsql/</span><br></pre></td></tr></table></figure>
<h5 id="2-设置访问权限"><a href="#2-设置访问权限" class="headerlink" title="2. 设置访问权限"></a>2. 设置访问权限</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/pg_hba.conf</span><br><span class="line"><span class="built_in">local</span>   all             all                                     trust</span><br><span class="line">host    all             all             127.0.0.1/32            trust</span><br><span class="line">host    all             all             ::1/128                 trust</span><br><span class="line">host    replication     repl            192.168.0.0/16          md5     =&gt;追加语句</span><br><span class="line">host    all             all             192.168.0.0/16          md5     =&gt;其它用户访问策略</span><br></pre></td></tr></table></figure>
<h5 id="3-修改配置文件"><a href="#3-修改配置文件" class="headerlink" title="3. 修改配置文件"></a>3. 修改配置文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/postgresql.conf</span><br><span class="line">listen_addresses = <span class="string">'\*'</span></span><br><span class="line">port = 5432</span><br><span class="line">wal_level = replica</span><br><span class="line">max_wal_senders = 5</span><br><span class="line">wal_keep_segments = 64</span><br><span class="line">synchronous_standby_names = <span class="string">'\*'</span></span><br><span class="line">archive_mode = on</span><br><span class="line">archive_command = <span class="string">'DIR=/mnt/log/pgsql/archive/$(date +%Y%m%d);test ! -d $DIR &amp;&amp; mkdir -p $DIR;test ! -f $DIR/%f &amp;&amp; cp %p $DIR/%f'</span></span><br></pre></td></tr></table></figure>
<p>  <strong>补充:设置PG连接数,需要修改内核参数kernel.sem</strong><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># cat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOF</span></span><br><span class="line">&gt; kernel.sem = 50100 128256000 50100 2560</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># sysctl -p</span></span><br></pre></td></tr></table></figure></p>
<h5 id="4-启动服务"><a href="#4-启动服务" class="headerlink" title="4. 启动服务"></a>4. 启动服务</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/pg_ctl -D /mnt/data/pgsql/ -l /mnt/<span class="built_in">log</span>/pgsql/pgsql.log start</span><br></pre></td></tr></table></figure>
<h5 id="5-登录PG数据库-创建同步账号"><a href="#5-登录PG数据库-创建同步账号" class="headerlink" title="5. 登录PG数据库,创建同步账号"></a>5. 登录PG数据库,创建同步账号</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br><span class="line">postgres=<span class="comment"># create user repl superuser password 'klip2[gE0_%y';</span></span><br><span class="line">postgres-<span class="comment"># \q</span></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/pg_ctl -D /mnt/data/pgsql/ -l /mnt/<span class="built_in">log</span>/pgsql/pgsql.log restart</span><br></pre></td></tr></table></figure>
<h3 id="5-PG-slave服务器上操作"><a href="#5-PG-slave服务器上操作" class="headerlink" title="5. PG slave服务器上操作"></a>5. PG slave服务器上操作</h3><h5 id="1-同步master数据"><a href="#1-同步master数据" class="headerlink" title="1. 同步master数据"></a>1. 同步master数据</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost postgresql-9.6.1]<span class="comment"># su - smallasa</span></span><br><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/pg_basebackup -F p --progress -R -D /mnt/data/pgsql/ -h 192.168.18.226 -p 5432 -U repl --password</span><br><span class="line">Password:</span><br><span class="line">22824/22824 kB (100%), 1/1 tablespace</span><br><span class="line">NOTICE:  pg_stop_backup complete, all required WAL segments have been archived</span><br></pre></td></tr></table></figure>
<h5 id="2-修改recovery配置文件"><a href="#2-修改recovery配置文件" class="headerlink" title="2. 修改recovery配置文件"></a>2. 修改recovery配置文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/recovery.conf</span><br><span class="line">standby_mode = <span class="string">'on'</span></span><br><span class="line">primary_conninfo = <span class="string">'user=repl password=klip2[gE0_%y host=192.168.18.226 port=5432 sslmode=disable sslcompression=1'</span></span><br><span class="line">recovery_target_timeline = <span class="string">'latest'</span></span><br></pre></td></tr></table></figure>
<h5 id="3-修改配置文件-1"><a href="#3-修改配置文件-1" class="headerlink" title="3. 修改配置文件"></a>3. 修改配置文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ vim /mnt/data/pgsql/postgresql.conf</span><br><span class="line">hot_standby = on</span><br><span class="line">max_standby_streaming_delay = 30s</span><br><span class="line">wal_receiver_status_interval = 1s</span><br><span class="line">hot_standby_feedback = on</span><br></pre></td></tr></table></figure>
<h5 id="4-启动服务-1"><a href="#4-启动服务-1" class="headerlink" title="4. 启动服务"></a>4. 启动服务</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/pg_ctl -D /mnt/data/pgsql/ -l /mnt/<span class="built_in">log</span>/pgsql/pgsql.log start</span><br></pre></td></tr></table></figure>
<h3 id="6-登录数据库-创建数据库进行主从验证"><a href="#6-登录数据库-创建数据库进行主从验证" class="headerlink" title="6. 登录数据库,创建数据库进行主从验证"></a>6. 登录数据库,创建数据库进行主从验证</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[smallasa@localhost ~]$ /mnt/app/pgsql/bin/psql -d postgres</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/02/postgresql-master-slave/" data-id="cjavy9k2j007n0coq4e02x1r1" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Linux-base-env" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/02/Linux-base-env/" class="article-date">
  <time datetime="2017-03-02T04:31:38.000Z" itemprop="datePublished">2017-03-02</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/CentOS/">CentOS</a>►<a class="article-category-link" href="/categories/system-service/CentOS/Base-env/">Base env</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/02/Linux-base-env/">Linux base env</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-查看系统版本"><a href="#1-查看系统版本" class="headerlink" title="1. 查看系统版本"></a>1. 查看系统版本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/redhat-release</span></span><br><span class="line">CentOS Linux release 7.0.1406 (Core)</span><br></pre></td></tr></table></figure>
<h3 id="2-设置主机名"><a href="#2-设置主机名" class="headerlink" title="2. 设置主机名"></a>2. 设置主机名</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># hostname smallasa &amp;&amp; echo smallasa |tee /etc/hostname</span></span><br><span class="line">[root@localhost ~]<span class="comment"># $SHELL</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># echo '192.168.13.188 smallasa' |tee -a /etc/hosts</span></span><br></pre></td></tr></table></figure>
<h3 id="3-硬盘格式化"><a href="#3-硬盘格式化" class="headerlink" title="3. 硬盘格式化"></a>3. 硬盘格式化</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># mkfs.xfs /dev/vdb</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># echo '/dev/vdb /mnt xfs defaults 0 0' | tee -a /etc/fstab</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># mount -a</span></span><br></pre></td></tr></table></figure>
<h3 id="4-设置打开最大文件数"><a href="#4-设置打开最大文件数" class="headerlink" title="4. 设置打开最大文件数"></a>4. 设置打开最大文件数</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># echo '* - nproc  65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># echo '* - nofile 65535' | tee -a /etc/security/limits.conf</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># ls /etc/security/limits.d/*|xargs rm -f</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">'* - nproc  65535'</span> | tee -a /etc/security/limits.conf</span><br><span class="line"><span class="built_in">echo</span> <span class="string">'* - nofile 65535'</span> | tee -a /etc/security/limits.conf</span><br><span class="line">ls /etc/security/limits.d/*|xargs rm -f</span><br></pre></td></tr></table></figure>
<h3 id="5-修改yum源"><a href="#5-修改yum源" class="headerlink" title="5. 修改yum源"></a>5. 修改yum源</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># mkdir /etc/yum.repos.d/backup &amp;&amp; mv /etc/yum.repos.d/&#123;*,backup&#125;</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># curl -o /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># curl -O https://mirrors.aliyun.com/centos/RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># rpm --import RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># rm -f RPM-GPG-KEY-CentOS-7</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># yum clean all</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># yum makecache</span></span><br></pre></td></tr></table></figure>
<h3 id="6-安装基础软件库和常用软件包"><a href="#6-安装基础软件库和常用软件包" class="headerlink" title="6. 安装基础软件库和常用软件包"></a>6. 安装基础软件库和常用软件包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">//安装基础软件包(ALL)</span><br><span class="line">CentOS6:</span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">cmake \</span><br><span class="line">bison-devel\</span><br><span class="line">bzip2 bzip2-devel bzip2-libs \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-static openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs ncurses-static \</span><br><span class="line">bzip2 bzip2-devel bzip2-libs \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-devel \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel</span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br><span class="line"></span><br><span class="line">CentOS7:</span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y groupinstall "Development Tools"</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y install \</span></span><br><span class="line">make cmake \</span><br><span class="line">bison-devel \</span><br><span class="line">bzip2-devel \</span><br><span class="line">zlib zlib-devel \</span><br><span class="line">openssl openssl-devel openssl-libs openssl-static \</span><br><span class="line">pcre pcre-devel pcre-static \</span><br><span class="line">ncurses ncurses-devel ncurses-libs \</span><br><span class="line">curl-devel \</span><br><span class="line">expat-devel \</span><br><span class="line">gettext-devel \</span><br><span class="line">openldap openldap-devel \</span><br><span class="line">readline readline-devel readline-static \</span><br><span class="line">libssh2 libssh2-devel \</span><br><span class="line">unixODBC unixODBC-devel \</span><br><span class="line">sqlite sqlite-devel \</span><br><span class="line">tcl tcl-devel \</span><br><span class="line">perl-Digest-SHA1 \</span><br><span class="line">python-libs python-devel python2-pip python-crypto \</span><br><span class="line">perl-libs \</span><br><span class="line">perl-ExtUtils-MakeMaker \</span><br><span class="line">GeoIP GeoIP-devel \</span><br><span class="line">gperftools gperftools-devel gperftools-libs \</span><br><span class="line">libatomic_ops-devel \</span><br><span class="line">gtest gtest-devel \</span><br><span class="line">gdk-pixbuf2 gdk-pixbuf2-deve \</span><br><span class="line">libffi libffi-devel \</span><br><span class="line">libcurl libcurl-devel \</span><br><span class="line">http-parser http-parser-devel</span><br><span class="line"></span><br><span class="line">[root@[ALL] ~]<span class="comment"># yum -y install bash-completion fop lftp ntp ntpdate vim wget telnet dstat tree lrzsz net-tools nmap-ncat nmap sysstat dmidecode bc</span></span><br></pre></td></tr></table></figure>
<h3 id="7-关闭selinux"><a href="#7-关闭selinux" class="headerlink" title="7. 关闭selinux"></a>7. 关闭selinux</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># setenforce 0</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># sed -i s/'SELINUX=enforcing'/'SELINUX=disabled'/g /etc/selinux/config</span></span><br><span class="line"></span><br><span class="line">setenforce 0</span><br><span class="line">sed -i s/<span class="string">'SELINUX=enforcing'</span>/<span class="string">'SELINUX=disabled'</span>/g /etc/selinux/config</span><br></pre></td></tr></table></figure>
<h3 id="8-关闭防火墙"><a href="#8-关闭防火墙" class="headerlink" title="8. 关闭防火墙"></a>8. 关闭防火墙</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CentOS6:</span><br><span class="line">[root@smallasa ~]<span class="comment"># /etc/init.d/iptables stop &amp;&amp; chkconfig iptables off</span></span><br><span class="line"></span><br><span class="line">CentOS7:</span><br><span class="line">[root@smallasa ~]<span class="comment"># systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span></span><br></pre></td></tr></table></figure>
<h3 id="9-设置系统时区"><a href="#9-设置系统时区" class="headerlink" title="9. 设置系统时区"></a>9. 设置系统时区</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">&gt; driftfile /var/lib/ntp/drift</span><br><span class="line">&gt; restrict default nomodify notrap nopeer noquery</span><br><span class="line">&gt; restrict 127.0.0.1</span><br><span class="line">&gt; restrict ::1</span><br><span class="line">&gt; server cn.pool.ntp.org prefer</span><br><span class="line">&gt; server 0.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 1.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 2.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 3.centos.pool.ntp.org iburst</span><br><span class="line">&gt; includefile /etc/ntp/crypto/pw</span><br><span class="line">&gt; keys /etc/ntp/keys</span><br><span class="line">&gt; <span class="built_in">disable</span> monitor</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@smallasa ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">&gt; cn.pool.ntp.org</span><br><span class="line">&gt; 0.centos.pool.ntp.org</span><br><span class="line">&gt; 1.centos.pool.ntp.org</span><br><span class="line">&gt; 2.centos.pool.ntp.org</span><br><span class="line">&gt; 3.centos.pool.ntp.org</span><br><span class="line">&gt; EOF</span><br><span class="line"></span><br><span class="line">CentOS6:</span><br><span class="line">[root@smallasa ~]<span class="comment"># /etc/init.d/ntpd start &amp;&amp; chkconfig ntpd on</span></span><br><span class="line"></span><br><span class="line">CentOS7:</span><br><span class="line">[root@smallasa ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span><br><span class="line">[ -f /etc/sysconfig/clock ] &amp;&amp; <span class="built_in">echo</span> <span class="string">'ZONE="Asia/Shanghai"'</span> | tee /etc/sysconfig/clock</span><br><span class="line">[ -f /etc/timezone ] &amp;&amp; <span class="built_in">echo</span> <span class="string">'Asia/Shanghai'</span> | tee /etc/timezone</span><br><span class="line">[ -f /etc/sysconfig/ntpd ] &amp;&amp; <span class="built_in">echo</span> <span class="string">'SYNC_HWCLOCK=yes'</span> | tee -a /etc/sysconfig/ntpd</span><br><span class="line">ntpdate cn.pool.ntp.org</span><br><span class="line">cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span><br><span class="line">cat &gt; /etc/ntp.conf &lt;&lt;EOF</span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"><span class="built_in">disable</span> monitor</span><br><span class="line">EOF</span><br><span class="line">cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span><br><span class="line">cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span><br><span class="line">cn.pool.ntp.org</span><br><span class="line">0.centos.pool.ntp.org</span><br><span class="line">1.centos.pool.ntp.org</span><br><span class="line">2.centos.pool.ntp.org</span><br><span class="line">3.centos.pool.ntp.org</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">/etc/init.d/ntpd start &amp;&amp; chkconfig ntpd on</span><br><span class="line">systemctl start ntpd &amp;&amp; systemctl <span class="built_in">enable</span> ntpd</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//此种方法已经不被推荐使用</span><br><span class="line">[root@smallasa ~]<span class="comment"># systemctl stop ntpd</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># systemctl disable ntpd</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># echo '1 1 * * *     /usr/sbin/ntpdate -s cn.pool.ntp.org' | tee /var/spool/cron/root</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>修改系统python pip源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># mkdir ~/.pip</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span></span><br><span class="line">&gt; [global]</span><br><span class="line">&gt; trusted-host=mirrors.aliyun.com</span><br><span class="line">&gt; index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">&gt; [list]</span><br><span class="line">&gt; format=columns</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@smallasa ~]<span class="comment"># pip install --upgrade pip</span></span><br><span class="line">[root@smallasa ~]<span class="comment"># python -V</span></span><br><span class="line">Python 2.7.5</span><br><span class="line"></span><br><span class="line">mkdir ~/.pip</span><br><span class="line">cat &gt; ~/.pip/pip.conf &lt;&lt;EOF</span><br><span class="line">[global]</span><br><span class="line">trusted-host=mirrors.aliyun.com</span><br><span class="line">index-url=http://mirrors.aliyun.com/pypi/simple/</span><br><span class="line">[list]</span><br><span class="line">format=columns</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置开机启动文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># chmod +x /etc/rc.d/rc.local</span></span><br><span class="line"></span><br><span class="line">chmod +x /etc/rc.d/rc.local</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建常用目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa ~]<span class="comment"># mkdir -p /mnt/&#123;app,data,log,web,ops/&#123;app,data,cron&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">mkdir -p /mnt/&#123;app,data,<span class="built_in">log</span>,web,ops/&#123;app,data,cron&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建一个普通用户用于启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># useradd smallasa</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'smallasa' | passwd --stdin smallasa</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭IPv6</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># echo 'net.ipv6.conf.all.disable_ipv6 = 1'|tee -a /etc/sysctl.conf</span></span><br><span class="line">[root@localhost ~]<span class="comment"># sysctl -p</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/hosts</span></span><br><span class="line"><span class="comment">#::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭swap</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># echo 'vm.swappiness=0' |tee -a /etc/sysctl.conf</span></span><br><span class="line">[root@localhost ~]<span class="comment"># sysctl -p</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>开启DNS缓存</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># yum -y install nscd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># cat /etc/nscd.conf</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /etc/nscd.conf</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># An example Name Service Cache config file.  This file is needed by nscd.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Legal entries are:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       logfile                 &lt;file&gt;</span></span><br><span class="line"><span class="comment">#       debug-level             &lt;level&gt;</span></span><br><span class="line"><span class="comment">#       threads                 &lt;initial #threads to use&gt;</span></span><br><span class="line"><span class="comment">#       max-threads             &lt;maximum #threads to use&gt;</span></span><br><span class="line"><span class="comment">#       server-user             &lt;user to run server as instead of root&gt;</span></span><br><span class="line"><span class="comment">#               server-user is ignored if nscd is started with -S parameters</span></span><br><span class="line"><span class="comment">#       stat-user               &lt;user who is allowed to request statistics&gt;</span></span><br><span class="line"><span class="comment">#       reload-count            unlimited|&lt;number&gt;</span></span><br><span class="line"><span class="comment">#       paranoia                &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#       restart-interval        &lt;time in seconds&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#       enable-cache            &lt;service&gt; &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#       positive-time-to-live   &lt;service&gt; &lt;time in seconds&gt;</span></span><br><span class="line"><span class="comment">#       negative-time-to-live   &lt;service&gt; &lt;time in seconds&gt;</span></span><br><span class="line"><span class="comment">#       suggested-size          &lt;service&gt; &lt;prime number&gt;</span></span><br><span class="line"><span class="comment">#       check-files             &lt;service&gt; &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#       persistent              &lt;service&gt; &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#       shared                  &lt;service&gt; &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#       max-db-size             &lt;service&gt; &lt;number bytes&gt;</span></span><br><span class="line"><span class="comment">#       auto-propagate          &lt;service&gt; &lt;yes|no&gt;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Currently supported cache names (services): passwd, group, hosts, services</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#       logfile                 /var/log/nscd.log</span></span><br><span class="line"><span class="comment">#       threads                 4</span></span><br><span class="line"><span class="comment">#       max-threads             32</span></span><br><span class="line">        server-user             nscd</span><br><span class="line"><span class="comment">#       stat-user               somebody</span></span><br><span class="line">        debug-level             0</span><br><span class="line"><span class="comment">#       reload-count            5</span></span><br><span class="line">        paranoia                no</span><br><span class="line"><span class="comment">#       restart-interval        3600</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">enable</span>-cache            passwd          yes</span><br><span class="line">        positive-time-to-live   passwd          600</span><br><span class="line">        negative-time-to-live   passwd          20</span><br><span class="line">        suggested-size          passwd          211</span><br><span class="line">        check-files             passwd          yes</span><br><span class="line">        persistent              passwd          yes</span><br><span class="line">        shared                  passwd          yes</span><br><span class="line">        max-db-size             passwd          33554432</span><br><span class="line">        auto-propagate          passwd          yes</span><br><span class="line"></span><br><span class="line">        <span class="built_in">enable</span>-cache            group           yes</span><br><span class="line">        positive-time-to-live   group           3600</span><br><span class="line">        negative-time-to-live   group           60</span><br><span class="line">        suggested-size          group           211</span><br><span class="line">        check-files             group           yes</span><br><span class="line">        persistent              group           yes</span><br><span class="line">        shared                  group           yes</span><br><span class="line">        max-db-size             group           33554432</span><br><span class="line">        auto-propagate          group           yes</span><br><span class="line"></span><br><span class="line">        <span class="built_in">enable</span>-cache            hosts           yes</span><br><span class="line">        positive-time-to-live   hosts           3600</span><br><span class="line">        negative-time-to-live   hosts           20</span><br><span class="line">        suggested-size          hosts           211</span><br><span class="line">        check-files             hosts           yes</span><br><span class="line">        persistent              hosts           yes</span><br><span class="line">        shared                  hosts           yes</span><br><span class="line">        max-db-size             hosts           33554432</span><br><span class="line"></span><br><span class="line">        <span class="built_in">enable</span>-cache            services        yes</span><br><span class="line">        positive-time-to-live   services        28800</span><br><span class="line">        negative-time-to-live   services        20</span><br><span class="line">        suggested-size          services        211</span><br><span class="line">        check-files             services        yes</span><br><span class="line">        persistent              services        yes</span><br><span class="line">        shared                  services        yes</span><br><span class="line">        max-db-size             services        33554432</span><br><span class="line"></span><br><span class="line">        <span class="built_in">enable</span>-cache            netgroup        yes</span><br><span class="line">        positive-time-to-live   netgroup        28800</span><br><span class="line">        negative-time-to-live   netgroup        20</span><br><span class="line">        suggested-size          netgroup        211</span><br><span class="line">        check-files             netgroup        yes</span><br><span class="line">        persistent              netgroup        yes</span><br><span class="line">        shared                  netgroup        yes</span><br><span class="line">        max-db-size             netgroup        33554432</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl start nscd</span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl enable nscd</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># nscd -g 查看缓存</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/02/Linux-base-env/" data-id="cjavy9jth000g0coq52y1yqqc" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-vsftpd-info" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/28/vsftpd-info/" class="article-date">
  <time datetime="2017-02-27T17:57:56.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/vsftpd/">vsftpd</a>►<a class="article-category-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/vsftpd-info/">vsftpd info</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="FTP是什么"><a href="#FTP是什么" class="headerlink" title="FTP是什么?"></a>FTP是什么?</h2><p><em>FTP Transfer Protocol 是文件传输协议的缩写,在RFC 959中具体说明</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">FTP会话时包含了两个通道:**一个叫控制通道,一个叫数据通道**</span><br><span class="line">* 控制通道</span><br><span class="line">  控制通道是和FTP服务器进行沟通的通道,连接FTP,发送FTP指令都是通过控制通道来完成的</span><br><span class="line">* 数据通道</span><br><span class="line">  数据通道是和FTP服务器进行文件传输或者列表的通道</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">FTP协议中,控制连接均有客户端发起,而数据连接有两种工作方式:**PORT方式和PASV方式**</span><br><span class="line">1. PORT模式(主动方式)</span><br><span class="line">   FTP客户端首先和FTP Server的TCP 21端口建立连接,通过这个通道发送命令,客户端需要接收数据的时候在这个通道上发送PORT命令.</span><br><span class="line">   PORT命令包含了客户端用什么端口(一个大于1024的端口)接收数据.</span><br><span class="line">   在传送数据的时候,服务器端通过自己的TCP 20端口发送数据.</span><br><span class="line">   FTP server必须和客户端建立一个新的连接用来传送数据</span><br><span class="line">2. PASV模式(被动方式)</span><br><span class="line">   在建立控制通道的时候和PORT模式类似,当客户端通过这个通道发送PASV命令的时候,</span><br><span class="line">   FTP server打开一个位于1024和5000之间的随机端口并且通知客户端在这个端口上传送数据的请求,</span><br><span class="line">   然后FTP server将通过这个端口进行数据的传送,这个时候FTP server不再需要建立一个新的和客户端之间的连接传送数据</span><br><span class="line">3. 如果从C/S模型这个角度来说,PORT对于服务器来说是OUTBOUND,而PASV模式对于服务器是INBOUND,</span><br><span class="line">   这一点请特别注意,尤其是在使用防火墙的企业里,这一点非常关键,如果设置错了,那么客户将无法连接</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vsftpd的xinetd模式和initd模式</span><br><span class="line">standalone一次性启动,运行期间一直驻留在内存中,优点是对接入信号反应快,缺点是损耗了一定的系统资源,因此经常应用于对实时反应要求较高的专业FTP服务器.inetd恰恰相反,由于只在外部连接发送请求时才调用FTP进程,因此不适合应用在同时连接数量较多的系统.此外,inetd模式不占用系统资源.除了反应速度和占用资源两方面的影响外,vsftpd还提供了一些额外的高级功能,如inetd模式支持per_IP(单一IP)限制,而standalone模式则更有利于PAM验证功能的应用</span><br><span class="line">1.xinetd运行模式</span><br><span class="line">  大多数较新的系统采用的是xinetd超级服务守护进程</span><br><span class="line">  使用&quot;vi /etc/xinetd.d/vsftpd&quot;看一下它的内容,如下：</span><br><span class="line">    disable = no</span><br><span class="line">    socket_type = stream</span><br><span class="line">    wait = no</span><br><span class="line">    #这表示设备是激活的,它正在使用标准的TCP Sockets</span><br><span class="line">  如果&quot;/etc/vsftpd.conf&quot;中的有选项为&quot;listen=YES&quot;,注销它</span><br><span class="line">  最后,重启xinetd: /etc/rc.d/init.d/xinetd restart</span><br><span class="line">  需要注意的是,&quot;/etc/xinetd.d&quot;目录中仅能开启一个FTP服务</span><br><span class="line">2.standalone模式</span><br><span class="line">  standalone模式便于实现PAM验证功能</span><br><span class="line">  进入这种模式首先要关闭xinetd下的vsftpd,设置</span><br><span class="line">  &quot;disable = yes&quot;</span><br><span class="line">  或者注销掉&quot;/etc/inetd.conf&quot;中相应的行</span><br><span class="line">  然后修改&quot;&quot;/etc/vsftpd.conf&quot;中的选项为&quot;listen=YES&quot;</span><br><span class="line"></span><br><span class="line">如果是standlone模式,那么它是作为单独的一个服务启动的,不需要系统协作,不作为系统服务</span><br><span class="line">如果要是成为xinetd模式,那么它的服务就要受系统服务的限制,比如创建一个新的服务进程,但是也有缺点,如果xinetd服务本身出了问题,那么相关的服务也是会受到影响的</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">xinetd模式和standalone模式的区别:</span><br><span class="line">* 以xinetd模式运行的服务表示该服务进程并不以守护进程执行</span><br><span class="line">* 以xinetd模式运行这个服务,本身FTP服务是会监听21号端口的,但是以这种模式运行这个服务的话,21号端口则由xinetd进程来监听(此时FTPD服务并没有运行),如果你的网卡接收到有21号端口请求,则有xinetd进程会去调用FTPD程序,将在21号端口接收到的请求数据移交给FTPD进程去处理,处理完后FTPD进程退出,而xinetd进程继续监听21号端口,这有点类似windows的svhost进程</span><br><span class="line">* 以standalone模式运行的服务则是服务进程,如ftpd以守护进程在内存中运行,接收到21号端口的请求后由FTPD进程fork出一个子进程进行处理,而原进程继续监听21号端口</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/02/28/vsftpd-info/" data-id="cjavy9k7l00b60coqf3w18qfp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-golang-env" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/28/golang-env/" class="article-date">
  <time datetime="2017-02-27T17:48:03.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/golang/">golang</a>►<a class="article-category-link" href="/categories/golang/go-env/">go env</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/golang-env/">golang env</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@gitserver ~]<span class="comment"># mkdir -p /mnt/app</span></span><br><span class="line">[root@gitserver ~]<span class="comment"># tar xzf go1.7.4.linux-amd64.tar.gz -C /mnt/app/</span></span><br><span class="line">[root@gitserver ~]<span class="comment"># echo 'export GOROOT=/mnt/app/go' |tee /etc/profile.d/go.sh</span></span><br><span class="line">[root@gitserver ~]<span class="comment"># echo 'export GOPATH=$HOME/work'  |tee -a /etc/profile.d/go.sh</span></span><br><span class="line">[root@gitserver ~]<span class="comment"># echo 'export PATH=$GOROOT/bin:$PATH' |tee -a /etc/profile.d/go.sh</span></span><br><span class="line">[root@gitserver ~]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/02/28/golang-env/" data-id="cjavy9jwq003j0coqqhuwt49d" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-k8s-dashboard-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/28/k8s-dashboard-install/" class="article-date">
  <time datetime="2017-02-27T17:43:59.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/k8s/">k8s</a>►<a class="article-category-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/k8s-dashboard-install/">k8s dashboard install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@192:~/node<span class="comment"># docker pull registry.cn-hangzhou.aliyuncs.com/kubernetes/kubernetes-dashboard-amd64:v1.4.1</span></span><br><span class="line">root@192:~/node<span class="comment"># docker tag registry.cn-hangzhou.aliyuncs.com/kubernetes/kubernetes-dashboard-amd64:v1.4.1 d.hub.io/kubernetes-dashboard-amd64:v1.4.1</span></span><br><span class="line">root@192:~/node<span class="comment"># docker run -it -d  -p 9090:9090 d.hub.io/kubernetes-dashboard-amd64:v1.4.1 /dashboard --apiserver-host=http://192.168.15.114:8080</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/02/28/k8s-dashboard-install/" data-id="cjavy9jxr004c0coqjbjsrkzl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-k8s-registry-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/28/k8s-registry-install/" class="article-date">
  <time datetime="2017-02-27T17:21:34.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/k8s/">k8s</a>►<a class="article-category-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/k8s-registry-install/">k8s registry install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <ol>
<li><p><strong>安装nginx</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># apt-get install gcc make libpcre3 libpcre3-dev openssl libssl-dev</span></span><br><span class="line">root@192:~<span class="comment"># apt-get install libauthen-htpasswd-perl libapache-htpasswd-perl apache2-utils</span></span><br><span class="line">root@192:~<span class="comment"># useradd -s /usr/sbin/nologin nginx</span></span><br><span class="line">root@192:~<span class="comment"># wget http://nginx.org/download/nginx-1.10.2.tar.gz</span></span><br><span class="line">root@192:~<span class="comment"># tar xzf nginx-1.10.2.tar.gz</span></span><br><span class="line">root@192:~<span class="comment"># cd nginx-1.10.2/</span></span><br><span class="line">root@192:~/nginx-1.10.2<span class="comment"># ./configure --prefix=/opt/nginx --user=nginx --group=nginx --with-pcre --with-http_stub_status_module --with-http_ssl_module --with-http_addition_module --with-http_realip_module --with-http_flv_module</span></span><br><span class="line">root@192:~/nginx-1.10.2<span class="comment"># make</span></span><br><span class="line">root@192:~/nginx-1.10.2<span class="comment"># make install</span></span><br></pre></td></tr></table></figure>
<p><em>可以设置认证,但实际部署时不建议设置账号和密码,请看nginx配置文件</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># htpasswd -cb /opt/nginx/conf/.htpasswd admin admin</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>创建证书</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># mkdir -p /opt/nginx/ssl</span></span><br><span class="line">root@192:~<span class="comment"># cd /opt/nginx/ssl/</span></span><br><span class="line">root@192:/opt/nginx/ssl<span class="comment"># openssl req -newkey rsa:4096 -nodes -sha256 -keyout domain.key -x509 -days 365 -out domain.crt</span></span><br><span class="line">Generating a 4096 bit RSA private key</span><br><span class="line">........++</span><br><span class="line">.........................................................................................................................................................................................................................................++</span><br><span class="line">writing new private key to \<span class="string">'domain.key\'</span></span><br><span class="line">\-----</span><br><span class="line">You are about to be asked to enter information that will be incorporated</span><br><span class="line">into your certificate request.</span><br><span class="line">What you are about to enter is what is called a Distinguished Name or a DN.</span><br><span class="line">There are quite a few fields but you can leave some blank</span><br><span class="line">For some fields there will be a default value,</span><br><span class="line">If you enter <span class="string">'.'</span>, the field will be left blank.</span><br><span class="line">\-----</span><br><span class="line">Country Name (2 letter code) [AU]:CN</span><br><span class="line">State or Province Name (full name) [Some-State]:BJ</span><br><span class="line">Locality Name (eg, city) []:bj</span><br><span class="line">Organization Name (eg, company) [Internet Widgits Pty Ltd]:zhonghui</span><br><span class="line">Organizational Unit Name (eg, section) []:</span><br><span class="line">Common Name (e.g. server FQDN or YOUR name) []:d.hub.io</span><br><span class="line">Email Address []:pengliu@brandwisdom.cn</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>拷贝CA证书到docker客户端</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># mkdir -p /etc/docker/certs.d/d.hub.io</span></span><br><span class="line">root@192:~<span class="comment"># cp /opt/nginx/ssl/domain.crt /etc/docker/certs.d/d.hub.io/ca.crt</span></span><br></pre></td></tr></table></figure>
<p><em>注意:将ca.crt 拷贝到所有的k8s node节点上:</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># mkdir -p /etc/docker/certs.d/d.hub.io</span></span><br><span class="line">root@192:~<span class="comment"># cp /opt/nginx/ssl/domain.crt /etc/docker/certs.d/d.hub.io/ca.crt</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>启动docker服务</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># source /var/run/flannel/subnet.env</span></span><br><span class="line">root@192:~<span class="comment"># /usr/bin/dockerd --bip=$&#123;FLANNEL_SUBNET&#125; --mtu=$&#123;FLANNEL_MTU&#125; &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>启动docker registry容器</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># docker pull index.alauda.cn/library/registry</span></span><br><span class="line">root@192:~<span class="comment"># docker tag index.alauda.cn/library/registry:latest registry:latest</span></span><br><span class="line">root@192:~<span class="comment"># mkdir -p /mnt/data/registry</span></span><br><span class="line">root@192:~<span class="comment"># docker run -d -p 5000:5000 --restart=always --name registry -v /mnt/data/registry/:/var/lib/registry/ registry:latest</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>修改nginx配置文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># cat /opt/nginx/conf/nginx.conf</span></span><br><span class="line">user  nginx nginx;</span><br><span class="line">worker_processes  auto;</span><br><span class="line"></span><br><span class="line">error_log  logs/error.log;</span><br><span class="line">pid        logs/nginx.pid;</span><br><span class="line">worker_rlimit_nofile 51200;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    use epoll;</span><br><span class="line">    worker_connections  51200;</span><br><span class="line">    multi_accept on;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    log_format  main  <span class="string">'$remote_addr - $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent "$http_referer" '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" "$http_x_forwarded_for"'</span>;</span><br><span class="line">    access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    server_names_hash_bucket_size 128;</span><br><span class="line">    client_header_buffer_size 32k;</span><br><span class="line">    large_client_header_buffers 4 32k;</span><br><span class="line"></span><br><span class="line">    sendfile       on;</span><br><span class="line">    tcp_nopush     on;</span><br><span class="line">    tcp_nodelay    on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    upstream registry &#123;</span><br><span class="line">      server 192.168.15.114:5000;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       443;</span><br><span class="line">        server_name  d.hub.io;</span><br><span class="line"></span><br><span class="line">        ssl    on;</span><br><span class="line">        ssl_certificate /opt/nginx/ssl/domain.crt;</span><br><span class="line">        ssl_certificate_key /opt/nginx/ssl/domain.key;</span><br><span class="line"></span><br><span class="line">        client_max_body_size 0;</span><br><span class="line">        chunked_transfer_encoding on;</span><br><span class="line">        location /v2/ &#123;</span><br><span class="line">          <span class="comment">#auth_basic "Registry realm";</span></span><br><span class="line">          <span class="comment">#auth_basic_user_file /opt/nginx/conf/.htpasswd;</span></span><br><span class="line">          add_header <span class="string">'Docker-Distribution-Api-Version'</span> <span class="string">'registry/2.0'</span> always;</span><br><span class="line"></span><br><span class="line">          proxy_pass http://registry;</span><br><span class="line">          proxy_set_header Host               <span class="variable">$http_host</span>;</span><br><span class="line">          proxy_set_header X-Real-IP          <span class="variable">$remote_addr</span>;</span><br><span class="line">          proxy_set_header X-Forwarded-For    <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">          proxy_set_header X-Forwarded-Proto  <span class="variable">$scheme</span>;</span><br><span class="line">          proxy_read_timeout                  900;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>启动nginx</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># /opt/nginx/sbin/nginx -t -c /opt/nginx/conf/nginx.conf</span></span><br><span class="line">root@192:~<span class="comment"># /opt/nginx/sbin/nginx -c /opt/nginx/conf/nginx.conf &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>将域名加入hosts文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@192:/etc/docker/ssl<span class="comment"># echo "192.168.15.114 d.hub.io" | tee -a  /etc/hosts</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>验证</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># curl -i -k -v https://d.hub.io/v2/</span></span><br><span class="line">*   Trying 192.168.15.114...</span><br><span class="line">* Connected to d.hub.io (192.168.15.114) port 443 (<span class="comment">#0)</span></span><br><span class="line">* found 173 certificates <span class="keyword">in</span> /etc/ssl/certs/ca-certificates.crt</span><br><span class="line">* found 692 certificates <span class="keyword">in</span> /etc/ssl/certs</span><br><span class="line">* ALPN, offering http/1.1</span><br><span class="line">* SSL connection using TLS1.2 / ECDHE_RSA_AES_128_GCM_SHA256</span><br><span class="line">*        server certificate verification SKIPPED</span><br><span class="line">*        server certificate status verification SKIPPED</span><br><span class="line">*        common name: d.hub.io (matched)</span><br><span class="line">*        server certificate expiration date OK</span><br><span class="line">*        server certificate activation date OK</span><br><span class="line">*        certificate public key: RSA</span><br><span class="line">*        certificate version: <span class="comment">#3</span></span><br><span class="line">*        subject: C=CN,ST=BJ,L=bj,O=zhonghui,CN=d.hub.io,EMAIL=pengliu@brandwisdom.cn</span><br><span class="line">*        start date: Mon, 19 Dec 2016 02:42:31 GMT</span><br><span class="line">*        expire date: Tue, 19 Dec 2017 02:42:31 GMT</span><br><span class="line">*        issuer: C=CN,ST=BJ,L=bj,O=zhonghui,CN=d.hub.io,EMAIL=pengliu@brandwisdom.cn</span><br><span class="line">*        compression: NULL</span><br><span class="line">* ALPN, server accepted to use http/1.1</span><br><span class="line">* Server auth using Basic with user \<span class="string">'admin\'</span></span><br><span class="line">&gt; GET /v2/ HTTP/1.1</span><br><span class="line">&gt; Host: d.hub.io</span><br><span class="line">&gt; Authorization: Basic YWRtaW46YWRtaW4=</span><br><span class="line">&gt; User-Agent: curl/7.47.0</span><br><span class="line">&gt; Accept: */*</span><br><span class="line">&gt;</span><br><span class="line">&lt; HTTP/1.1 200 OK</span><br><span class="line">HTTP/1.1 200 OK</span><br><span class="line">&lt; Server: nginx/1.10.2</span><br><span class="line">Server: nginx/1.10.2</span><br><span class="line">&lt; Date: Mon, 19 Dec 2016 02:57:43 GMT</span><br><span class="line">Date: Mon, 19 Dec 2016 02:57:43 GMT</span><br><span class="line">&lt; Content-Type: application/json; charset=utf-8</span><br><span class="line">Content-Type: application/json; charset=utf-8</span><br><span class="line">&lt; Content-Length: 2</span><br><span class="line">Content-Length: 2</span><br><span class="line">&lt; Connection: keep-alive</span><br><span class="line">Connection: keep-alive</span><br><span class="line">&lt; Docker-Distribution-Api-Version: registry/2.0</span><br><span class="line">Docker-Distribution-Api-Version: registry/2.0</span><br><span class="line">&lt; X-Content-Type-Options: nosniff</span><br><span class="line">X-Content-Type-Options: nosniff</span><br><span class="line">&lt; Docker-Distribution-Api-Version: registry/2.0</span><br><span class="line">Docker-Distribution-Api-Version: registry/2.0</span><br><span class="line">&lt;</span><br><span class="line">* Connection <span class="comment">#0 to host d.hub.io left intact</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>提交下载</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># docker tag 192.168.15.114:5000/node-web:latest d.hub.io/node-web:latest</span></span><br><span class="line">root@192:~<span class="comment"># docker push d.hub.io/node-web:latest</span></span><br><span class="line">root@192:~<span class="comment"># docker pull d.hub.io/node-web:latest</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>安装完docker 私有仓库后需要重启kubernetes minion上的dockerd服务</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@192:~<span class="comment"># /usr/bin/dockerd --bip=$&#123;FLANNEL_SUBNET&#125; --mtu=$&#123;FLANNEL_MTU&#125; --insecure-registry=d.hub.io &amp;</span></span><br><span class="line">root@192:~<span class="comment"># docker tag ubuntu:latest 192.168.15.114:5000/ubuntu:latest</span></span><br><span class="line">root@192:~<span class="comment"># docker images</span></span><br><span class="line">REPOSITORY                   TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">192.168.15.114:5000/ubuntu   latest              4ca3a192ff2a        10 days ago         128.2 MB</span><br><span class="line">ubuntu                       latest              4ca3a192ff2a        10 days ago         128.2 MB</span><br><span class="line">registry                     latest              c9bd19d022f6        7 weeks ago         33.3 MB</span><br><span class="line">root@192:~<span class="comment"># docker push 192.168.15.114:5000/ubuntu:latest</span></span><br><span class="line">0d45be5b95d8: Pushed</span><br><span class="line">18568efa7ad4: Pushed</span><br><span class="line">1c53295311c1: Pushed</span><br><span class="line">dfcc17ddae9e: Pushed</span><br><span class="line">d29d52f94ad5: Pushed</span><br><span class="line">latest: digest: sha256:3b64c309deae7ab0f7dbdd42b6b326261ccd6261da5d88396439353162703fb5 size: 1357</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/02/28/k8s-registry-install/" data-id="cjavy9jxv004f0coq50t5ias4" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-k8s-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/28/k8s-install/" class="article-date">
  <time datetime="2017-02-27T16:52:00.000Z" itemprop="datePublished">2017-02-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/k8s/">k8s</a>►<a class="article-category-link" href="/categories/k8s/k8s-install/">k8s install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/28/k8s-install/">k8s install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Kubernets-是什么"><a href="#Kubernets-是什么" class="headerlink" title="Kubernets 是什么?"></a>Kubernets 是什么?</h2><p>Kubernetes是Google开源的容器集群管理系统,其提供应用部署、维护、扩展机制等功能，利用Kubernetes能方便地管理跨机器运行容器化的应用。</p>
<h2 id="Kubernets-主要功能"><a href="#Kubernets-主要功能" class="headerlink" title="Kubernets 主要功能:"></a>Kubernets 主要功能:</h2><ul>
<li>使用Docker对应用程序包装(package),实例化(instantiate),运行(run)</li>
<li>以集群的方式运行,管理跨机器的容器</li>
<li>解决Docker跨机器容器之间的通讯问题</li>
<li>Kubernetes的自我修复机制使得容器集群总是运行在用户期望的状态</li>
</ul>
<h2 id="Kubernets-搭建"><a href="#Kubernets-搭建" class="headerlink" title="Kubernets 搭建"></a>Kubernets 搭建</h2><table>
<thead>
<tr>
<th>名称</th>
<th>IP</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>node.1</td>
<td>192.168.99.182</td>
<td>kubernets-minion</td>
</tr>
<tr>
<td>node.2</td>
<td>192.168.99.177</td>
<td>kubernets-minion</td>
</tr>
<tr>
<td>node.3</td>
<td>192.168.99.142</td>
<td>kubernets-master</td>
</tr>
</tbody>
</table>
<h2 id="基础安装"><a href="#基础安装" class="headerlink" title="基础安装"></a>基础安装</h2><ol>
<li><p>更新源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ sudo su -</span><br><span class="line">root@ubuntu:~<span class="comment"># cp /etc/apt/&#123;sources.list,sources.list.bak&#125;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># vim /etc/apt/sources.list</span></span><br><span class="line">deb-src http://archive.ubuntu.com/ubuntu xenial main restricted</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial main restricted multiverse universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-updates main restricted multiverse universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-updates multiverse</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-backports main restricted universe multiverse</span><br><span class="line">deb http://archive.canonical.com/ubuntu xenial partner</span><br><span class="line">deb-src http://archive.canonical.com/ubuntu xenial partner</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted</span><br><span class="line">deb-src http://mirrors.aliyun.com/ubuntu/ xenial-security main restricted multiverse universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security universe</span><br><span class="line">deb http://mirrors.aliyun.com/ubuntu/ xenial-security multiverse</span><br><span class="line">root@ubuntu:~<span class="comment"># apt-get clean</span></span><br><span class="line">root@ubuntu:~<span class="comment"># apt-get update</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>基础软件安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># apt-get -y install lrzsz curl wget dstat vim tree git</span></span><br><span class="line">root@ubuntu:~<span class="comment"># apt-get -y install ntpdate</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">root@ubuntu:~<span class="comment"># crontab -e</span></span><br><span class="line">5 0 * * * /usr/sbin/ntpdate -s cn.pool.ntp.org &gt;/dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改主机名</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># echo 192.168.99.177 &gt; /etc/hostname</span></span><br><span class="line">root@ubuntu:~<span class="comment"># hostname 192.168.99.17</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h2 id="docker-install"><a href="#docker-install" class="headerlink" title="docker install"></a>docker install</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ sudo apt-get -y install apt-transport-https ca-certificates</span><br><span class="line">penn@ubuntu:~$ sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-keys 58118E89F3A912897C070ADBF76221572C52609D</span><br><span class="line">penn@ubuntu:~$ <span class="built_in">echo</span> <span class="string">"deb https://apt.dockerproject.org/repo ubuntu-xenial main"</span> | sudo tee /etc/apt/sources.list.d/docker.list</span><br><span class="line">penn@ubuntu:~$ sudo apt-get update</span><br><span class="line">penn@ubuntu:~$ apt-cache policy docker-engine</span><br><span class="line">penn@ubuntu:~$ sudo apt-get -y install linux-image-extra-$(uname -r) linux-image-extra-virtual</span><br><span class="line">penn@ubuntu:~$ apt-cache madison docker-engine</span><br><span class="line">penn@ubuntu:~$ sudo apt-get -y install docker-engine</span><br><span class="line">penn@ubuntu:~$ sudo systemctl <span class="built_in">enable</span> docker</span><br><span class="line">penn@ubuntu:~$ sudo systemctl restart docker.service</span><br><span class="line">penn@ubuntu:~$ docker -v</span><br><span class="line">Docker version 1.12.3, build 6b644ec</span><br></pre></td></tr></table></figure>
<p><em>补充:</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ sudo apt-get -y upgrade docker-engine  更新</span><br><span class="line">penn@ubuntu:~$ sudo apt-get -y purge docker-engine    卸载</span><br><span class="line">penn@ubuntu:~$ sudo apt-get -y autoremove --purge docker-engine 卸载和依赖包</span><br><span class="line">penn@ubuntu:~$ rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="k8s-binary-download"><a href="#k8s-binary-download" class="headerlink" title="k8s binary download"></a>k8s binary download</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ tar xzf kubernetes.tar.gz</span><br><span class="line">penn@ubuntu:~$ <span class="built_in">cd</span> kubernetes</span><br><span class="line">penn@ubuntu:~$ <span class="built_in">cd</span> kubernetes/cluster/ubuntu/</span><br><span class="line">penn@ubuntu:~/kubernetes/cluster/ubuntu$ vim download-release.sh</span><br><span class="line">... ...</span><br><span class="line"><span class="comment"># flannel</span></span><br><span class="line">FLANNEL_VERSION=<span class="variable">$&#123;FLANNEL_VERSION:-"0.5.5"&#125;</span></span><br><span class="line">... ...</span><br><span class="line"><span class="comment"># ectd</span></span><br><span class="line">ETCD_VERSION=<span class="variable">$&#123;ETCD_VERSION:-"2.3.1"&#125;</span></span><br><span class="line">... ...</span><br><span class="line"><span class="comment"># k8s</span></span><br><span class="line"><span class="keyword">function</span> get_latest_version_number &#123;</span><br><span class="line">  <span class="built_in">local</span> -r latest_url=<span class="string">"https://storage.googleapis.com/kubernetes-release/release/stable.txt"</span></span><br><span class="line">  <span class="keyword">if</span> [[ $(<span class="built_in">which</span> wget) ]]; <span class="keyword">then</span></span><br><span class="line">    wget -qO- <span class="variable">$&#123;latest_url&#125;</span></span><br><span class="line">  <span class="keyword">elif</span> [[ $(<span class="built_in">which</span> curl) ]]; <span class="keyword">then</span></span><br><span class="line">    curl -Ss <span class="variable">$&#123;latest_url&#125;</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Couldn't find curl or wget.  Bailing out."</span> &gt;&amp;2</span><br><span class="line">    <span class="built_in">exit</span> 4</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> [ -z <span class="string">"<span class="variable">$KUBE_VERSION</span>"</span> ]; <span class="keyword">then</span></span><br><span class="line">  KUBE_VERSION=$(get_latest_version_number | sed <span class="string">'s/^v//'</span>)</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">penn@ubuntu:~/kubernetes/cluster/ubuntu$ sudo ./download-release.sh</span><br></pre></td></tr></table></figure>
<hr>
<h2 id="k8s-binary-copy"><a href="#k8s-binary-copy" class="headerlink" title="k8s binary copy"></a>k8s binary copy</h2><ul>
<li><p><strong>master:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ sudo su -</span><br><span class="line">root@ubuntu:~<span class="comment"># sudo mkdir /opt/bin</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cp kubernetes/cluster/ubuntu/binaries/master/* /opt/bin/</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cp kubernetes/cluster/ubuntu/binaries/kubectl /opt/bin/</span></span><br><span class="line">root@ubuntu:~<span class="comment"># ls -l /opt/bin/</span></span><br><span class="line">total 487708</span><br><span class="line">-rwxr-xr-x 1 root root  16687744 Dec  7 03:21 etcd</span><br><span class="line">-rwxr-xr-x 1 root root  14347456 Dec  7 03:21 etcdctl</span><br><span class="line">-rwxr-xr-x 1 root root  16581152 Dec  7 03:21 flanneld</span><br><span class="line">-rwxr-x--- 1 root root 151001624 Dec  7 03:21 kube-apiserver</span><br><span class="line">-rwxr-x--- 1 root root 141028448 Dec  7 03:21 kube-controller-manager</span><br><span class="line">-rwxr-x--- 1 root root  79537832 Dec  7 03:26 kubectl</span><br><span class="line">-rwxr-x--- 1 root root  80201536 Dec  7 03:22 kube-scheduler</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>minion:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">penn@ubuntu:~$ sudo su -</span><br><span class="line">root@ubuntu:~<span class="comment"># sudo mkdir /opt/bin</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cp kubernetes/cluster/ubuntu/binaries/minion/* /opt/bin/</span></span><br><span class="line">root@ubuntu:~<span class="comment"># ls -l /opt/bin/</span></span><br><span class="line">total 212976</span><br><span class="line">-rwxr-xr-x 1 root root  16581152 Dec  7 03:23 flanneld</span><br><span class="line">-rwxr-x--- 1 root root 129126768 Dec  7 03:23 kubelet</span><br><span class="line">-rwxr-x--- 1 root root  72367392 Dec  7 03:23 kube-proxy</span><br></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<h2 id="k8s-deploy"><a href="#k8s-deploy" class="headerlink" title="k8s deploy"></a>k8s deploy</h2><ul>
<li><p><strong>master:</strong></p>
<ol>
<li><p>停止docker服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># systemctl stop docker.service</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动etcd服务并设置网段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># mkdir -p  /opt/data/etcd</span></span><br><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/etcd --data-dir '/opt/data/etcd' --listen-peer-urls 'http://0.0.0.0:2380,http://0.0.0.0:7001' --listen-client-urls 'http://0.0.0.0:2379,http://0.0.0.0:4001' --initial-advertise-peer-urls 'http://0.0.0.0:2380,http://0.0.0.0:7001' --initial-cluster 'default=http://0.0.0.0:2380,default=http://0.0.0.0:7001' --advertise-client-urls 'http://0.0.0.0:2379,http://0.0.0.0:4001' &amp;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/etcdctl set /coreos.com/network/config '&#123;"Network":"172.16.0.0/16"&#125;'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动flanneld</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/flanneld --etcd-endpoints="http://127.0.0.1:4001" -iface=enp0s3 &amp;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cat /run/flannel/subnet.env</span></span><br><span class="line">FLANNEL_NETWORK=172.16.0.0/16</span><br><span class="line">FLANNEL_SUBNET=172.16.24.1/24</span><br><span class="line">FLANNEL_MTU=1472</span><br><span class="line">FLANNEL_IPMASQ=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重新初始化docker0网卡,启动docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># source /run/flannel/subnet.env</span></span><br><span class="line">root@ubuntu:~<span class="comment"># ifconfig docker0 $&#123;FLANNEL_SUBNET&#125;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># /usr/bin/dockerd --bip=$&#123;FLANNEL_SUBNET&#125; --mtu=$&#123;FLANNEL_MTU&#125; &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动kube-apiserver</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kube-apiserver --address=0.0.0.0 --port=8080 --etcd_servers=http://127.0.0.1:4001 --portal_net=172.16.1.0/24 --allow_privileged=false --kubelet_port=10250 --v=0  &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动kube-controller-manager</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kube-controller-manager --address=0.0.0.0 --master=127.0.0.1:8080  --v=0 &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动kube-scheduler</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kube-scheduler --address=0.0.0.0 --master=127.0.0.1:8080 --v=0 &amp;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
<li><p><strong>minion:</strong></p>
<ol>
<li><p>停止docker服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># systemctl stop docker.service</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动flanneld服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/flanneld --etcd-endpoints="http://192.168.99.142:4001" -iface=enp0s3 &amp;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># cat /run/flannel/subnet.env</span></span><br><span class="line">FLANNEL_NETWORK=172.16.0.0/16</span><br><span class="line">FLANNEL_SUBNET=172.16.44.1/24</span><br><span class="line">FLANNEL_MTU=1472</span><br><span class="line">FLANNEL_IPMASQ=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重新初始化docker0网卡,启动docker</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># source /run/flannel/subnet.env</span></span><br><span class="line">root@ubuntu:~<span class="comment"># ifconfig docker0 $&#123;FLANNEL_SUBNET&#125;</span></span><br><span class="line">root@ubuntu:~<span class="comment"># /usr/bin/dockerd --bip=$&#123;FLANNEL_SUBNET&#125; --mtu=$&#123;FLANNEL_MTU&#125; &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动kubelet</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kubelet --address=0.0.0.0 --port=10250 --api_servers=http://192.168.99.142:8080 --enable_server=true --v=0 &amp;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动kube-proxy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kube-proxy --master=http://192.168.99.142:8080 --v=0 &amp;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
</li>
</ul>
<hr>
<h2 id="k8s-work-test"><a href="#k8s-work-test" class="headerlink" title="k8s work test"></a>k8s work test</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:~<span class="comment"># /opt/bin/kubectl get nodes</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/02/28/k8s-install/" data-id="cjavy9jxw004g0coqpjbeoalm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/26/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/25/">25</a><a class="page-number" href="/page/26/">26</a><span class="page-number current">27</span><a class="page-number" href="/page/28/">28</a><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/28/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
          <li>
            <a href="/2017/11/27/svn-auto-update/">svn auto update</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-event-reactor/">salt manage event reactor</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-job/">salt manage job</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>