<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/24/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-maven-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/maven-install/" class="article-date">
  <time datetime="2017-03-06T01:43:22.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/automation/">automation</a>►<a class="article-category-link" href="/categories/automation/maven/">maven</a>►<a class="article-category-link" href="/categories/automation/maven/maven-install/">maven install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/maven-install/">maven install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="java-install"><a href="#java-install" class="headerlink" title="java install"></a>java install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf jdk-8u111-linux-x64.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv jdk1.8.0_111 /mnt/app/java</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source  /etc/profile</span></span><br><span class="line">[root@localhost app]<span class="comment"># java -version</span></span><br></pre></td></tr></table></figure>
<h3 id="maven-install"><a href="#maven-install" class="headerlink" title="maven install"></a>maven install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf apache-maven-3.3.9-bin.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv apache-maven-3.3.9 /mnt/app/maven</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'MAVEN_HOME=/mnt/app/maven' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;PATH&#125;:$&#123;MAVEN_HOME&#125;/bin' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/maven-install/" data-id="cjavy9k0000600coqiad2aldp" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-nexus-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/nexus-install/" class="article-date">
  <time datetime="2017-03-06T01:43:14.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/automation/">automation</a>►<a class="article-category-link" href="/categories/automation/nexus/">nexus</a>►<a class="article-category-link" href="/categories/automation/nexus/nexus-install/">nexus install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/nexus-install/">nexus install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="java-install"><a href="#java-install" class="headerlink" title="java install"></a>java install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf jdk-8u111-linux-x64.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv jdk1.8.0_111 /mnt/app/java</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source  /etc/profile</span></span><br><span class="line">[root@localhost app]<span class="comment"># java -version</span></span><br></pre></td></tr></table></figure>
<h3 id="maven-install"><a href="#maven-install" class="headerlink" title="maven install"></a>maven install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf apache-maven-3.3.9-bin.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv apache-maven-3.3.9 /mnt/app/maven</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'MAVEN_HOME=/mnt/app/maven' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;PATH&#125;:$&#123;MAVEN_HOME&#125;/bin' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
<h3 id="nexus-install"><a href="#nexus-install" class="headerlink" title="nexus install"></a>nexus install</h3><ol>
<li><p>创建用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># useradd nexus</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'cMaxj(^s7:do! | passwd --stdin nexus</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nexus 安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># tar xzf nexus-3.1.0-04-unix.tar.gz</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mv nexus-3.1.0-04 /mnt/app/nexus</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export NEXUS_HOME=/mnt/app/nexus' | tee /etc/profile.d/nexus.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export NEXUS_BIN=$&#123;NEXUS_HOME&#125;/bin' | tee -a /etc/profile.d/nexus.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export PATH=$&#123;NEXUS_BIN&#125;:$PATH' | tee -a /etc/profile.d/nexus.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nexus 修改配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># vim /mnt/app/nexus/etc/nexus-default.properties</span></span><br><span class="line"><span class="comment"># Jetty section</span></span><br><span class="line">application-port=8081</span><br><span class="line">application-host=0.0.0.0</span><br><span class="line">nexus-args=<span class="variable">$&#123;jetty.etc&#125;</span>/jetty.xml,<span class="variable">$&#123;jetty.etc&#125;</span>/jetty-http.xml,<span class="variable">$&#123;jetty.etc&#125;</span>/jetty-requestlog.xml</span><br><span class="line">nexus-context-path=/</span><br><span class="line"><span class="comment"># Nexus section</span></span><br><span class="line">nexus-edition=nexus-pro-edition</span><br><span class="line">nexus-features=\</span><br><span class="line"> nexus-pro-feature</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /mnt/app/nexus/bin/nexus.rc</span></span><br><span class="line">run_as_user=<span class="string">"nexus"</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># vim /mnt/app/nexus/bin/nexus.vmoptions</span></span><br><span class="line">-Xms1200M</span><br><span class="line">-Xmx1200M</span><br><span class="line">-XX:MaxDirectMemorySize=2G</span><br><span class="line">-XX:+HeapDumpOnOutOfMemoryError</span><br><span class="line">-XX:+UnlockDiagnosticVMOptions</span><br><span class="line">-XX:+UnsyncloadClass</span><br><span class="line">-XX:+LogVMOutput</span><br><span class="line">-XX:LogFile=/mnt/<span class="built_in">log</span>/nexus/nexus.log</span><br><span class="line">-Djava.net.preferIPv4Stack=<span class="literal">true</span></span><br><span class="line">-Dkaraf.home=.</span><br><span class="line">-Dkaraf.base=.</span><br><span class="line">-Dkaraf.etc=etc/karaf</span><br><span class="line">-Djava.util.logging.config.file=etc/karaf/java.util.logging.properties</span><br><span class="line">-Dkaraf.data=/mnt/data/nexus</span><br><span class="line">-Djava.io.tmpdir=/mnt/data/nexus/tmp</span><br><span class="line">-Dkaraf.startLocalConsole=<span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nexus 创建日志和数据目录,并修改文件属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mkdir -p /mnt/&#123;data,log&#125;/nexus</span></span><br><span class="line">[root@localhost ~]<span class="comment"># mkdir -p /mnt/data/nexus/tmp</span></span><br><span class="line">[root@localhost ~]<span class="comment"># chown -R nexus.nexus /mnt/&#123;app,data,log&#125;/nexus</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nexus 启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># su - nexus</span></span><br><span class="line">[nexus@localhost ~]$ /mnt/app/nexus/bin/nexus start</span><br><span class="line">[nexus@localhost ~]$ /mnt/app/nexus/bin/nexus stop</span><br><span class="line">[nexus@localhost ~]$ /mnt/app/nexus/bin/nexus status</span><br></pre></td></tr></table></figure>
</li>
<li><p>nexus 加入开机启动项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">方式一:</span><br><span class="line">[root@localhost ~]<span class="comment"># vim /etc/rc.local</span></span><br><span class="line">su nexus -c <span class="string">"/mnt/app/nexus/bin/nexus start"</span></span><br><span class="line"></span><br><span class="line">方式二:</span><br><span class="line">[root@localhost ~]<span class="comment">#  vim /usr/lib/systemd/system/nexus.service</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=nexus service</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/nexus/bin/nexus start</span><br><span class="line">ExecStop=/mnt/app/nexus/bin/nexus stop</span><br><span class="line">User=nexus</span><br><span class="line">Restart=on-abort</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment">#  systemctl daemon-reload</span></span><br><span class="line">[root@localhost ~]<span class="comment">#  systemctl enable nexus</span></span><br><span class="line">[root@localhost ~]<span class="comment">#  systemctl start nexus</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过浏览器打开</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.10.75:8081</span><br><span class="line"></span><br><span class="line">默认密码: admin/admin123</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/nexus-install/" data-id="cjavy9k1j006x0coq5g4drer6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-datax-info" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/datax-info/" class="article-date">
  <time datetime="2017-03-06T01:04:48.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/datax/">datax</a>►<a class="article-category-link" href="/categories/hadoop/datax/datax-info/">datax info</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/datax-info/">datax info</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="datax-https-github-com-alibaba-DataX-wiki-DataX-Introduction"><a href="#datax-https-github-com-alibaba-DataX-wiki-DataX-Introduction" class="headerlink" title="datax[https://github.com/alibaba/DataX/wiki/DataX-Introduction]"></a>datax[<a href="https://github.com/alibaba/DataX/wiki/DataX-Introduction" target="_blank" rel="noopener">https://github.com/alibaba/DataX/wiki/DataX-Introduction</a>]</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">DataX 是一个异构数据源离线同步工具,致力于实现包括关系型数据库(MySQL、Oracle等),HDFS,Hive,MaxCompute(原ODPS),HBase,FTP等各种异构数据源之间稳定高效的数据同步功能</span><br><span class="line"></span><br><span class="line">设计理念:</span><br><span class="line">为了解决异构数据源同步问题,DataX将复杂的网状的同步链路变成了星型数据链路,DataX作为中间传输载体负责连接各种数据源.当需要接入一个新的数据源的时候,只需要将此数据源对接到DataX,便能跟已有的数据源做到无缝数据同步</span><br><span class="line"></span><br><span class="line">datax框架设计:</span><br><span class="line">例如:</span><br><span class="line">Mysql =&gt; | ReadPlugin =&gt; FrameWork =&gt; HDFSWriter | =&gt; HDFS</span><br><span class="line"></span><br><span class="line">DataX本身作为离线数据同步框架,采用&quot;Framework + plugin&quot;架构构建.</span><br><span class="line">将数据源读取和写入抽象成为Reader/Writer插件,纳入到整个同步框架中:</span><br><span class="line">1.Reader：</span><br><span class="line">  Reader为数据采集模块,负责采集数据源的数据,将数据发送给Framework</span><br><span class="line">2.Writer:</span><br><span class="line">  Writer为数据写入模块,负责不断向Framework取数据,并将数据写入到目的端</span><br><span class="line">3.Framework:</span><br><span class="line">  Framework用于连接reader和writer,作为两者的数据传输通道,并处理缓冲,流控,并发,数据转换等核心技术问题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">DataX 3.0 开源版本支持单机多线程模式完成同步作业运行：</span><br><span class="line">1.DataX完成单个数据同步的作业,我们称之为Job,DataX接受到一个Job之后,将启动一个进程来完成整个作业同步过程.DataX Job模块是单个作业的中枢管理节点,承担了数据清理,子任务切分(将单一作业计算转化为多个子Task),TaskGroup管理等功能</span><br><span class="line"></span><br><span class="line">2.DataXJob启动后,会根据不同的源端切分策略,将Job切分成多个小的Task(子任务),以便于并发执行.Task便是DataX作业的最小单元,每一个Task都会负责一部分数据的同步工作.</span><br><span class="line"></span><br><span class="line">3.切分多个Task之后,DataX Job会调用Scheduler模块,根据配置的并发数据量,将拆分成的Task重新组合,组装成TaskGroup(任务组).每一个TaskGroup负责以一定的并发运行完毕分配好的所有Task,默认单个任务组的并发数量为5</span><br><span class="line"></span><br><span class="line">4.每一个Task都由TaskGroup负责启动,Task启动后,会固定启动Reader—&gt;Channel—&gt;Writer的线程来完成任务同步工作</span><br><span class="line"></span><br><span class="line">5.DataX作业运行起来之后,Job监控并等待多个TaskGroup模块任务完成,等待所有TaskGroup任务完成后Job成功退出.否则,异常退出,进程退出值非0</span><br><span class="line"></span><br><span class="line">例如:</span><br><span class="line">用户提交了一个DataX作业,并且配置了20个并发,目的是将一个100张分表的mysql数据同步到odps里面.</span><br><span class="line">DataX的调度决策思路是：</span><br><span class="line">1.DataXJob根据分库分表切分成了100个Task。</span><br><span class="line">2.根据20个并发,DataX计算共需要分配4个TaskGroup</span><br><span class="line">3.4个TaskGroup平分切分好的100个Task,每一个TaskGroup负责以5个并发共计运行25个Task。</span><br></pre></td></tr></table></figure>
<h3 id="datax-windows乱码解决问题-https-github-com-alibaba-DataX-wiki-windows-error-encoding"><a href="#datax-windows乱码解决问题-https-github-com-alibaba-DataX-wiki-windows-error-encoding" class="headerlink" title="datax windows乱码解决问题[https://github.com/alibaba/DataX/wiki/windows-error-encoding]"></a>datax windows乱码解决问题[<a href="https://github.com/alibaba/DataX/wiki/windows-error-encoding" target="_blank" rel="noopener">https://github.com/alibaba/DataX/wiki/windows-error-encoding</a>]</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/datax-info/" data-id="cjavy9jus001k0coqvjsrwbf5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-datax-job" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/datax-job/" class="article-date">
  <time datetime="2017-03-06T01:03:09.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/datax/">datax</a>►<a class="article-category-link" href="/categories/hadoop/datax/datax-job/">datax job</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/datax-job/">datax job</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="从数据库读取数据写入到hdfs-mysql"><a href="#从数据库读取数据写入到hdfs-mysql" class="headerlink" title="从数据库读取数据写入到hdfs(mysql)"></a>从数据库读取数据写入到hdfs(mysql)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">    <span class="attr">"setting"</span>: &#123;</span><br><span class="line">      <span class="attr">"speed"</span>: &#123;</span><br><span class="line">        <span class="attr">"channel"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"byte"</span>: <span class="number">2048576000</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"errorLimit"</span>: &#123;</span><br><span class="line">        <span class="attr">"record"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">"percentage"</span>: <span class="number">0.02</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"content"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"reader"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"$username"</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"$password"</span>,</span><br><span class="line">            <span class="attr">"connection"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"querySql"</span>: [</span><br><span class="line">                  <span class="string">"select column1,column2,column3 from tablename;"</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"jdbcUrl"</span>: [</span><br><span class="line">                  <span class="string">"jdbc:mysql://$IP_addr:$port/$dbname?characterEncoding=utf-8"</span></span><br><span class="line">                ]</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"writer"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"hdfswriter"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"defaultFS"</span>: <span class="string">"hdfs://IP_addr:9000"</span>,</span><br><span class="line">            <span class="attr">"fileType"</span>: <span class="string">"text"</span>,</span><br><span class="line">            <span class="attr">"fileName"</span>: <span class="string">"$&#123;dbname&#125;_$&#123;time&#125;"</span>,</span><br><span class="line">            <span class="attr">"path"</span>: <span class="string">"/p/test/tablename/$&#123;time&#125;"</span>,</span><br><span class="line">            <span class="attr">"column"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"xx"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"yy"</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"xx"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"yy"</span></span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"name"</span>: <span class="string">"xx"</span>,</span><br><span class="line">                <span class="attr">"type"</span>: <span class="string">"yy"</span></span><br><span class="line">              &#125;,</span><br><span class="line">              ... ...</span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"writeMode"</span>: <span class="string">"append"</span>,</span><br><span class="line">            <span class="attr">"fieldDelimiter"</span>: <span class="string">"\t"</span>,</span><br><span class="line">            <span class="attr">"encoding"</span>: <span class="string">"utf-8"</span>,</span><br><span class="line">            <span class="attr">"compress"</span>: <span class="string">" "</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="从数据库读取数据写入到数据库-mysql"><a href="#从数据库读取数据写入到数据库-mysql" class="headerlink" title="从数据库读取数据写入到数据库(mysql)"></a>从数据库读取数据写入到数据库(mysql)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">    <span class="attr">"setting"</span>: &#123;</span><br><span class="line">      <span class="attr">"speed"</span>: &#123;</span><br><span class="line">        <span class="attr">"channel"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"byte"</span>: <span class="number">2048576000</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"errorLimit"</span>: &#123;</span><br><span class="line">        <span class="attr">"record"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">"percentage"</span>: <span class="number">0.02</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"content"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"reader"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"$username"</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"$password"</span>,</span><br><span class="line">            <span class="attr">"connection"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"querySql"</span>: [</span><br><span class="line">                  <span class="string">"SELECT colume1,colume2,colume3 FROM tablename;"</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"jdbcUrl"</span>: [</span><br><span class="line">                  <span class="string">"jdbc:mysql://$IP_addr:$port/$dbname?characterEncoding=utf-8"</span></span><br><span class="line">                ]</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"writer"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"mysqlwriter"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"writeMode"</span>: <span class="string">"insert"</span>,</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"$username"</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"$password"</span>,</span><br><span class="line">            <span class="attr">"column"</span>: [</span><br><span class="line">              <span class="string">"colume1"</span>,</span><br><span class="line">              <span class="string">"colume2"</span>,</span><br><span class="line">              <span class="string">"colume3"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"session"</span>: [</span><br><span class="line">              <span class="string">"set session sql_mode='ANSI'"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"preSql"</span>: [</span><br><span class="line">              <span class="string">"delete from tabename;"</span></span><br><span class="line">            ],</span><br><span class="line">            <span class="attr">"connection"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"jdbcUrl"</span>: <span class="string">"jdbc:mysql://$IP_addr:$port/$dbname?characterEncoding=utf-8"</span>,</span><br><span class="line">                <span class="attr">"table"</span>: [</span><br><span class="line">                  <span class="string">"tablename"</span></span><br><span class="line">                ]</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="从数据库读取数据写入到文本文件-mysql"><a href="#从数据库读取数据写入到文本文件-mysql" class="headerlink" title="从数据库读取数据写入到文本文件(mysql)"></a>从数据库读取数据写入到文本文件(mysql)</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"job"</span>: &#123;</span><br><span class="line">    <span class="attr">"setting"</span>: &#123;</span><br><span class="line">      <span class="attr">"speed"</span>: &#123;</span><br><span class="line">        <span class="attr">"channel"</span>: <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"byte"</span>: <span class="number">2048576000</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">"errorLimit"</span>: &#123;</span><br><span class="line">        <span class="attr">"record"</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">"percentage"</span>: <span class="number">0.02</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"content"</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">"reader"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"mysqlreader"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"username"</span>: <span class="string">"$username"</span>,</span><br><span class="line">            <span class="attr">"password"</span>: <span class="string">"$password"</span>,</span><br><span class="line">            <span class="attr">"connection"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">"querySql"</span>: [</span><br><span class="line">                  <span class="string">"SELECT colume1,colume2,colume3 FROM tablename;"</span></span><br><span class="line">                ],</span><br><span class="line">                <span class="attr">"jdbcUrl"</span>: [</span><br><span class="line">                  <span class="string">"jdbc:mysql://$IP_addr:$port/$dbname?characterEncoding=utf-8"</span></span><br><span class="line">                ]</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"writer"</span>: &#123;</span><br><span class="line">          <span class="attr">"name"</span>: <span class="string">"txtfilewriter"</span>,</span><br><span class="line">          <span class="attr">"parameter"</span>: &#123;</span><br><span class="line">            <span class="attr">"path"</span>: <span class="string">"/path/to/tablename"</span>,</span><br><span class="line">            <span class="attr">"fileName"</span>: <span class="string">"$&#123;dbname&#125;_$time"</span>,</span><br><span class="line">            <span class="attr">"writeMode"</span>: <span class="string">"append"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/datax-job/" data-id="cjavy9jux001o0coqpou0cp5o" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-datax-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/datax-install/" class="article-date">
  <time datetime="2017-03-06T01:02:45.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/datax/">datax</a>►<a class="article-category-link" href="/categories/hadoop/datax/datax-install/">datax install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/datax-install/">datax install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="java-install"><a href="#java-install" class="headerlink" title="java install"></a>java install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf jdk-8u111-linux-x64.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv jdk1.8.0_111 /mnt/app/java</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JAVA_HOME=/mnt/app/java' | tee /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'JRE_HOME=$&#123;JAVA_HOME&#125;/jre' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH' | tee -a /etc/profile.d/java.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source  /etc/profile</span></span><br><span class="line">[root@localhost app]<span class="comment"># java -version</span></span><br></pre></td></tr></table></figure>
<h3 id="maven-install"><a href="#maven-install" class="headerlink" title="maven install"></a>maven install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf apache-maven-3.3.9-bin.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv apache-maven-3.3.9 /mnt/app/maven</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'MAVEN_HOME=/mnt/app/maven' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;PATH&#125;:$&#123;MAVEN_HOME&#125;/bin' | tee -a /etc/profile.d/maven.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
<h3 id="python-install"><a href="#python-install" class="headerlink" title="python install"></a>python install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># git clone https://github.com/yyuu/pyenv.git ~/.pyenv</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export PYENV_ROOT="$HOME/.pyenv"' | tee /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'export PATH="$PYENV_ROOT/bin:$PATH"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'eval "$(pyenv init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># echo 'eval "$(pyenv virtualenv-init -)"' | tee -a /etc/profile.d/pyenv.sh</span></span><br><span class="line">[root@localhost ~]<span class="comment"># source /etc/profile</span></span><br><span class="line">[root@localhost ~]<span class="comment"># exec $SHELL</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv install 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv rehash</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv global 2.7.13</span></span><br><span class="line">[root@localhost ~]<span class="comment"># pyenv versions</span></span><br></pre></td></tr></table></figure>
<h3 id="datax-install"><a href="#datax-install" class="headerlink" title="datax install"></a>datax install</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># tar xzf datax.tar.gz</span></span><br><span class="line">[root@localhost app]<span class="comment"># mv datax /mnt/app/datax</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export DATAX_HOME=/mnt/app/datax' | tee /etc/profile.d/datax.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export DATAX_BIN=$&#123;DATAX_HOME&#125;/bin' | tee -a /etc/profile.d/datax.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># echo 'export PATH=$&#123;DATAX_BIN&#125;:$PATH' | tee -a /etc/profile.d/datax.sh</span></span><br><span class="line">[root@localhost app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
<h3 id="datax-use-https-github-com-alibaba-DataX"><a href="#datax-use-https-github-com-alibaba-DataX" class="headerlink" title="datax use[https://github.com/alibaba/DataX]"></a>datax use[<a href="https://github.com/alibaba/DataX" target="_blank" rel="noopener">https://github.com/alibaba/DataX</a>]</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost app]<span class="comment"># touch /mnt/app/datax/job/test.json</span></span><br><span class="line">[root@localhost app]<span class="comment"># cd /mnt/app/datax &amp;&amp; python ./bin/datax.py ./job/test.json -p "-Dtime=$&#123;DAY&#125; -Ddays=$&#123;num&#125;"</span></span><br><span class="line"></span><br><span class="line">说明:</span><br><span class="line">-p 表示传参</span><br><span class="line">-D 表示定义的变量,在job中引用变量</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/datax-install/" data-id="cjavy9jut001l0coqn04xw2bt" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ntpd-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/ntpd-install/" class="article-date">
  <time datetime="2017-03-05T18:23:01.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/ntpd/">ntpd</a>►<a class="article-category-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/ntpd-install/">ntpd install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="时间同步"><a href="#时间同步" class="headerlink" title="时间同步"></a>时间同步</h3><ol>
<li><p>设置时区和时间</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@[ALL] ~]<span class="comment"># [ -f /etc/localtime ] &amp;&amp; cp -f /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># [ -f /etc/sysconfig/clock ] &amp;&amp; echo 'ZONE="Asia/Shanghai"' | tee /etc/sysconfig/clock</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># [ -f /etc/timezone ] &amp;&amp; echo 'Asia/Shanghai' | tee /etc/timezone</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># [ -f /etc/sysconfig/ntpd ] &amp;&amp; echo 'SYNC_HWCLOCK=yes' | tee -a /etc/sysconfig/ntpd</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># ntpdate cn.pool.ntp.org</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># cp -f /etc/&#123;ntp.conf,ntp.conf.bak&#125;</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># cat &gt; /etc/ntp.conf &lt;&lt;EOF</span></span><br><span class="line">&gt; driftfile /var/lib/ntp/drift</span><br><span class="line">&gt; restrict default nomodify notrap nopeer noquery</span><br><span class="line">&gt; restrict 127.0.0.1</span><br><span class="line">&gt; restrict ::1</span><br><span class="line">&gt; server cn.pool.ntp.org prefer</span><br><span class="line">&gt; server 0.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 1.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 2.centos.pool.ntp.org iburst</span><br><span class="line">&gt; server 3.centos.pool.ntp.org iburst</span><br><span class="line">&gt; includefile /etc/ntp/crypto/pw</span><br><span class="line">&gt; keys /etc/ntp/keys</span><br><span class="line">&gt; <span class="built_in">disable</span> monitor</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@[ALL] ~]<span class="comment"># cp -f /etc/ntp/&#123;step-tickers,step-tickers.bak&#125;</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># cat &gt; /etc/ntp/step-tickers &lt;&lt;EOF</span></span><br><span class="line">&gt; cn.pool.ntp.org</span><br><span class="line">&gt; 0.centos.pool.ntp.org</span><br><span class="line">&gt; 1.centos.pool.ntp.org</span><br><span class="line">&gt; 2.centos.pool.ntp.org</span><br><span class="line">&gt; 3.centos.pool.ntp.org</span><br><span class="line">&gt; EOF</span><br><span class="line">[root@[ALL] ~]<span class="comment"># systemctl start ntpd &amp;&amp; systemctl enable ntpd</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//不在推荐使用</span><br><span class="line">[root@[ALL] ~]<span class="comment"># systemctl stop ntpd</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># systemctl disable ntpd</span></span><br><span class="line">[root@[ALL] ~]<span class="comment"># echo '1 1 * * *     /usr/sbin/ntpdate -s cn.pool.ntp.org' | tee /var/spool/cron/root</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<ol>
<li><p>ntpd 和 ntpdate 简介</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">在Windwos中,系统时间的设置很简单,界面操作,通俗易懂.而且设置后,重启,关机都没关系.系统时间会自动保存在Bios的时钟里面,启动计算机的时候,系统会自动在Bios里面取硬件时间,以保证时间的不间断.</span><br><span class="line"></span><br><span class="line">在Linux下,默认情况下,系统时间和硬件时间,并不会自动同步.在Linux运行过程中,系统时间和硬件时间以异步的方式运行,互不干扰.硬件时间的运行,是靠Bios电池来维持,而系统时间,是用CPU tick来维持的</span><br><span class="line"></span><br><span class="line">在系统开机的时候,会自动从Bios中取得硬件时间,设置为系统时间.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linux系统时间的设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//查看时间</span><br><span class="line">[root@localhost ~]# date</span><br><span class="line">2008年 12月 12日 星期五 14:44:12 CST</span><br><span class="line"></span><br><span class="line">//修改时间</span><br><span class="line">[root@localhost ~]# date --set &quot;1/1/09 00:01&quot; ==&gt;月/日/年时:分:秒</span><br><span class="line">2009年 01月 01日 星期四 00:01:00 CST</span><br><span class="line"></span><br><span class="line">//date 有几种时间格式可接受,这样也可以设置时间:</span><br><span class="line">[root@localhost ~]# date 012501012009.30    ==&gt;月日时分年.秒</span><br><span class="line">2009年 01月 25日 星期日 01:01:30 CST</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linux硬件时间的设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">硬件时间的设置,可以用hwclock或者clock命令.其中,clock和hwclock用法相近,只用一个就行,只不过clock命令除了支持x86硬件体系外,还支持Alpha硬件体系</span><br><span class="line"></span><br><span class="line">//查看硬件时间 可以是用 hwclock ，hwclock --show 或者 hwclock -r</span><br><span class="line">[root@localhost ~]# hwclock --show</span><br><span class="line">2008年12月12日 星期五 06时52分07秒  -0.376932 seconds</span><br><span class="line"></span><br><span class="line">//设置硬件时间</span><br><span class="line">[root@localhost ~]# hwclock --set --date=&quot;1/25/09 00:00&quot; &lt;== 月/日/年时:分:秒</span><br><span class="line">[root@localhost ~]# hwclock</span><br><span class="line">2009年01月25日 星期日 00时00分06秒  -0.870868 seconds</span><br></pre></td></tr></table></figure>
</li>
<li><p>Linux系统时间和硬件时间的同步</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">同步系统时间和硬件时间,可以使用hwclock命令:</span><br><span class="line"></span><br><span class="line">//以系统时间为基准,修改硬件时间</span><br><span class="line">[root@localhost ~]# hwclock --systohc ==&gt; sys(系统时间)to(写到)hc(Hard Clock)</span><br><span class="line">[root@localhost ~]# hwclock -w</span><br><span class="line"></span><br><span class="line">//以硬件时间为基准,修改系统时间</span><br><span class="line">[root@localhost ~]# hwclock --hctosys</span><br><span class="line">[root@localhost ~]# hwclock -s</span><br></pre></td></tr></table></figure>
</li>
<li><p>不同机器之间的时间同步</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">为了避免主机时间因为长期运作下所导致的时间偏差,进行时间同步(synchronize)的工作是非常必要的.</span><br><span class="line">Linux系统下,一般使用ntp服务器来同步不同机器的时间.一台机器,可以同时是ntp服务器和ntp客户机.在网络中,推荐使用像DNS服务器一样分层的时间服务器来同步时间.</span><br><span class="line">同步时间,可以使用ntpdate命令,也可以使用ntpd服务</span><br><span class="line"></span><br><span class="line">//使用ntpdate比较简单,格式如下:</span><br><span class="line">[root@linux ~]# ntpdate [-nv] [NTP IP/hostname]</span><br><span class="line">[root@linux ~]# ntpdate 192.168.0.1</span><br><span class="line">[root@linux ~]# ntpdate time.ntp.org</span><br><span class="line"></span><br><span class="line">但这样的同步,只是强制性的将系统时间设置为ntp服务器时间.如果cpu tick有问题,只是治标不治本.所以,一般配合cron命令,来进行定期同步设置.比如,在crontab中添加:</span><br><span class="line">0 12 * * * * /usr/sbin/ntpdate time.ntp.org</span><br><span class="line"></span><br><span class="line">//使用ntpd服务,要好于ntpdate加cron的组合</span><br><span class="line">因为,ntpdate同步时间,会造成时间的跳跃,对一些依赖时间的程序和服务会造成影响.比如: sleep,timer等.而且,ntpd服务可以在修正时间的同时,修正cpu tick.理想的做法为,在开机的时候,使用ntpdate强制同步时间,在其他时候使用ntpd服务来同步时间.</span><br><span class="line">要注意的是,ntpd有一个自我保护设置: 如果本机与上源时间相差太大,ntpd不运行.所以新设置的时间服务器一定要先 ntpdate从上源取得时间初值,然后启动ntpd服务.ntpd服务运行后,先是每64秒与上源服务器同步一次,根据每次同步时测得的误差值经复杂计算逐步调整自己的时间,随着误差减小,逐步增加同步的间隔.每次跳动,都会重复这个调整的过程.</span><br></pre></td></tr></table></figure>
</li>
<li><p>ntpd服务的设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">//ntpd服务的相关设置文件</span><br><span class="line">* /etc/ntp.conf</span><br><span class="line">  这个是NTP daemon的主要设文件,也是 NTP 唯一的设定文件</span><br><span class="line">* /usr/share/zoneinfo/</span><br><span class="line">  在这个目录下的文件其实是规定了各主要时区的时间设定文件(例如:北京地区的时区设定文件在/usr/share/zoneinfo/Asia/Beijing).</span><br><span class="line">  这个目录里面的文件与下面要谈的两个文件(clock与localtime)是有关系的</span><br><span class="line">* /etc/sysconfig/clock</span><br><span class="line">  这个文件其实也不包含在NTP的daemon当中,因为这个是linux的主要时区设定文件.</span><br><span class="line">  每次开机后,Linux会自动的读取这个文件来设定自己系统所默认要显示的时间</span><br><span class="line">* /etc/localtime</span><br><span class="line">  这个文件就是&quot;本地端的时间配置文件&quot;.</span><br><span class="line">  刚刚那个clock文件里面规定了使用的时间设置文件(ZONE)为&quot;/usr/share/zoneinfo/Asia/Beijing&quot;,所以说,这就是本地端的时间了.此时,Linux系统就会将Beijing那个文件另存为一份/etc/localtime文件,所以未来我们的时间显示就会以Beijing那个时间设定文件为准</span><br><span class="line">* /etc/timezone</span><br><span class="line">  系统时区文件</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">下面重点说说&quot;/etc/ntp.conf&quot;文件的设置: 在NTP Server的设定上面,其实最好不要对Internet无限制的开放,尽量仅提供您自己内部的Client端联机进行网络校时就好.此外,NTP Server也是需要网络上面较为准确的主机来自行更新自己的时间,所以在我们的NTP Server上面也要找一部最靠近自己的Time Server来进行自我校正.事实上,NTP这个服务也是C/S的一种模式</span><br><span class="line"></span><br><span class="line">[root@linux ~]# vi /etc/ntp.conf</span><br><span class="line"># 1.关于权限设定部分</span><br><span class="line">#   权限设定主要以&quot;restrict&quot;这个参数来设定,主要语法为:</span><br><span class="line"># 　restrict &#123;IP_addr&#125; mask &#123;net_mast&#125; parameter</span><br><span class="line"># 　* IP 可以是软件地址,也可以是&quot;default&quot;,&quot;default&quot;类似&quot;0.0.0.0&quot;</span><br><span class="line">#　 * paramter则有:</span><br><span class="line">#　　 * ignore: 关闭所有的NTP联机服务</span><br><span class="line">#　　 * nomodify: 表示Client端不能更改Server端的时间参数.不过,Client端仍然可以透过Server端来进行网络校时</span><br><span class="line">#　　 * notrust: 该Client除非通过认证,否则该Client来源将被视为不信任网域</span><br><span class="line">#　　 * noquery: 不提供Client端的时间查询</span><br><span class="line">#　　 * notrap: 不提供trap这个远程事件登入</span><br><span class="line">#　　 * Kod: kod技术可以阻止&quot;Kiss of Death&quot;包对服务器的破坏</span><br><span class="line">#　　 * Nopeer: 不与其他同一层的NTP服务器进行时间同步</span><br><span class="line">#　　 如果paramter完全没有设定,那就表示该IP(或网域)没有任何限制</span><br><span class="line"></span><br><span class="line">restrict default nomodify notrap noquery　 #关闭所有的NTP要求封包</span><br><span class="line">restrict 127.0.0.1　　　                   #这是允许本地查询</span><br><span class="line">restrict 192.168.0.1 mask 255.255.255.0 nomodify</span><br><span class="line"># 在192.168.0.1/24网段内的服务器就可以通过这台NTPServer进行时间同步了</span><br><span class="line"></span><br><span class="line"># 2.上层主机的设定</span><br><span class="line">#   要设定上层主机主要以server这个参数来设定,语法为:</span><br><span class="line">#　 server [IP|HOST Name] [prefer]</span><br><span class="line">#　 * Server后面接的就是我们上层&quot;Time Server&quot;,如果Server参数后面加上&quot;perfer&quot;的话,那表示我们的NTP主机主要以该部主机来作为时间校正的对应.另外,为了解决更新时间封包的传送延迟动作,所以可以使用&quot;driftfile&quot;来规定我们的主机在与Time Server&quot;沟通时所花费的时间,可以记录在&quot;driftfile&quot;后面接的文件内.</span><br><span class="line">#   * prefer 表示优先级最高</span><br><span class="line">#   * burst  当一个运程NTP服务器可用时,向它发送一系列的并发包进行检测</span><br><span class="line">#   * iburst 当一个运程NTP服务器不可用时,向它发送一系列的并发包进行检测</span><br><span class="line">#   默认情况小15分钟后才会与上层NTP服务器进行时间校对</span><br><span class="line">#   例如:我们的NTP server与cn.pool.ntp.org联机时所花费的时间会记录在&quot;/etc/ntp/drift&quot;文件内</span><br><span class="line">server 0.pool.ntp.org</span><br><span class="line">server 1.pool.ntp.org</span><br><span class="line">server 2.pool.ntp.org</span><br><span class="line">server cn.pool.ntp.org prefer</span><br><span class="line"></span><br><span class="line"># 3.其他设置值,以系统默认值即可</span><br><span class="line">server  127.127.1.0     # local clock</span><br><span class="line">fudge   127.127.1.0 stratum 10</span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">broadcastdelay  0.008</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line"></span><br><span class="line">综上,restrict用来设置访问权限,server用来设置上层时间服务器,driftfile用来设置保存漂移时间的文件</span><br></pre></td></tr></table></figure>
</li>
<li><p>ntp服务的启动与观察</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">在启动NTP服务前,先对提供服务的这台主机手动的校正一次时间.()因为启动服务器,端口会被服务端占用,就不能手动同步时间了)</span><br><span class="line">[root@linux ~] # ntpdate cn.pool.ntp.org</span><br><span class="line"></span><br><span class="line">然后,启动ntpd服务:</span><br><span class="line">[root@linux ~] # /etc/init.d/ntpd start</span><br><span class="line"></span><br><span class="line">查看端口:</span><br><span class="line">[root@linux ~] # netstat -ln|grep 123</span><br><span class="line">udp        0      0 192.168.228.153:123        0.0.0.0:*</span><br><span class="line">udp        0      0 127.0.0.1:123              0.0.0.0:*</span><br><span class="line">udp        0      0 0.0.0.0:123                0.0.0.0:*</span><br><span class="line">udp        0      0 :::123                     :::*</span><br><span class="line"></span><br><span class="line">确认我们的NTP服务器已经更新了自己的时间:</span><br><span class="line">[root@linux ~] # ntpstat</span><br><span class="line">synchronized to NTP server(127.127.1.0) at stratum 11</span><br><span class="line">time correct to within 950ms</span><br><span class="line">polling server every 64 s</span><br><span class="line"></span><br><span class="line">常见错误:</span><br><span class="line">25 Apr 15:30:17 ntpdate[11520]: no server suitable for synchronization found</span><br><span class="line">其实,这不是一个错误.而是由于每次重启NTP服务器之后大约要3-5分钟客户端才能与server建立正常的通讯连接.当此时用客户端连接服务端就会报这样的信息.一般等待几分钟就可以了.</span><br><span class="line"></span><br><span class="line">[root@linux ~] # ntptrace –n 127.0.0.1</span><br><span class="line">127.0.0.1:stratum 11, offset 0.000000，synch distance 0.950951</span><br><span class="line">222.73.214.125：stratum 2，offset –0.000787，synch distance 0.108575</span><br><span class="line">209.81.9.7:stratum 1，offset 0.000028，synch distance 0.00436，refid ‘GPS’</span><br><span class="line">#这个指令可以列出目前NTP服务器(第一层)与上层NTP服务器(第二层)彼此之间的关系</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">指令&quot;ntpq -p&quot;可以列出目前我们的NTP与相关的上层NTP的状态,以上的几个字段的意义如下:</span><br><span class="line">* remote</span><br><span class="line">  即NTP主机的IP或主机名称</span><br><span class="line">  注意最左边的符号,如果由&quot;+&quot;则代表目前正在作用中的上层NTP,如果是&quot;*&quot;则表示也有连上线,不过是作为次要联机的NTP主机</span><br><span class="line">* refid  参考的上一层NTP主机的地址</span><br><span class="line">* st     即stratum阶层</span><br><span class="line">* when   几秒前曾做过时间同步更新的操作</span><br><span class="line">* poll   下次更新在几秒之后</span><br><span class="line">* reach  已经向上层NTP服务器要求更新的次数</span><br><span class="line">* delay  网络传输过程钟延迟的时间</span><br><span class="line">* offset 时间补偿的结果</span><br><span class="line">* jitter Linux系统时间与BIOS硬件时间的差异时间</span><br><span class="line"></span><br><span class="line">最后提及一点,ntp服务,默认只会同步系统时间!!!</span><br><span class="line">如果想要让ntp同时同步硬件时间,可以设置/etc/sysconfig/ntpd文件</span><br><span class="line">在/etc/sysconfig/ntpd文件中,添加&quot;SYNC_HWCLOCK=yes&quot;.这样,就可以让硬件时间与系统时间一起同步</span><br></pre></td></tr></table></figure>
</li>
<li><p>快速部署</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// 私有ntp服务器,同步公网的ntp服务器</span><br><span class="line">* 编辑配置</span><br><span class="line">  /etc/ntp.conf:</span><br><span class="line">  # 定义服务器</span><br><span class="line">  server pool.ntp.org</span><br><span class="line">  restrict default nomodify notrap noquery</span><br><span class="line"></span><br><span class="line">  #从192.168.0.1-192.168.0.254的服务器都可以使用我们的NTP服务器来同步时间</span><br><span class="line">  restrict 192.168.0.0 mask 255.255.255.0 notrust nomodify notrap</span><br><span class="line"></span><br><span class="line">  server 127.127.1.0</span><br><span class="line">  fudge 127.127.1.0 stratum 8   当NTP服务不可用时,使用NTP服务器当前时间同步给客户机</span><br><span class="line"></span><br><span class="line">  #注释掉</span><br><span class="line">  #restrict default ignore</span><br><span class="line"></span><br><span class="line">* 启动:</span><br><span class="line">  /etc/init.d/ntpd start</span><br><span class="line">  chkconfig ntpd on</span><br><span class="line"></span><br><span class="line">默认情况下,我们配置的NTP服务器不会去时间源那里同步时间,所以必须修改&quot;/etc/ntp/step-tickers&quot;文件,加入我们的时间源,这样每次通过&quot;/etc/init.d/ntpd&quot;来启动服务的时候就会自动更新时间了</span><br><span class="line"></span><br><span class="line">//配置LINUX客户端</span><br><span class="line">在linux客户端上执行&quot;ntpdate ntp_server_ip&quot;就可以根据时间服务器统一局域网的时间了,将上面的命令放到cron里每天早上3点定期执行,crontab –e 然后输入:</span><br><span class="line">0 3 * * * /usr/sbin/ntpdate 192.168.0.179</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//防火墙</span><br><span class="line">iptables -I INPUT -p udp -m udp --sport 123 -j ACCEPT</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<ol>
<li><p>安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install ntp ntpdate</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ignore  ：关闭所有的 NTP 联机服务</span><br><span class="line">nomodify：客户端不能更改服务端的时间参数,但是客户端可以通过服务端进行网络校时</span><br><span class="line">notrust ：客户端除非通过认证,否则该客户端来源将被视为不信任子网</span><br><span class="line">noquery ：不提供客户端的时间查询：用户端不能使用ntpq，ntpc等命令来查询ntp服务器</span><br><span class="line">notrap  ：不提供trap远端登陆：拒绝为匹配的主机提供模式 6 控制消息陷阱服务。陷阱服务是 ntpdq 控制消息协议的子系统，用于远程事件日志记录程序。</span><br><span class="line">nopeer  ：用于阻止主机尝试与服务器对等，并允许欺诈性服务器控制时钟</span><br><span class="line">kod     ： 访问违规时发送 KoD 包。</span><br></pre></td></tr></table></figure>
</li>
<li><p>通用配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/etc/ntp.conf:</span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap nopeer noquery</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line">disable monitor</span><br></pre></td></tr></table></figure>
</li>
<li><p>限制网段访问</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/etc/ntp.conf:</span><br><span class="line">driftfile /var/lib/ntp/drift</span><br><span class="line">restrict default nomodify notrap</span><br><span class="line">restrict 127.0.0.1</span><br><span class="line">restrict ::1</span><br><span class="line">server 0.centos.pool.ntp.org iburst</span><br><span class="line">server 1.centos.pool.ntp.org iburst</span><br><span class="line">server 2.centos.pool.ntp.org iburst</span><br><span class="line">server 3.centos.pool.ntp.org iburst</span><br><span class="line">includefile /etc/ntp/crypto/pw</span><br><span class="line">keys /etc/ntp/keys</span><br><span class="line">disable monitor</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动ntp服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl start ntpd</span><br><span class="line">systemctl <span class="built_in">enable</span> ntpd</span><br><span class="line"></span><br><span class="line">iptables -A INPUT -p UDP -i eno16777736 -s 192.168.1.0/24 --dport 123 -j ACCEPT</span><br><span class="line">setsebool -P ntp_disable_trans</span><br><span class="line"></span><br><span class="line">vi /etc/sysconfig/ntpd  <span class="comment">#允许BIOS与系统时间同步，添加下面一行。</span></span><br><span class="line">SYNC_HWCLOCK=yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>检测ntp服务是否运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//检测ntp服务是否运行</span><br><span class="line">netstat -tlunp | grep ntp</span><br><span class="line"></span><br><span class="line">//检测有无和上层ntp联通</span><br><span class="line">ntpstat</span><br><span class="line"></span><br><span class="line">//检测ntp和上层ntp的联通状态</span><br><span class="line">ntpq -p</span><br><span class="line"></span><br><span class="line">remote   - 本机和上层ntp的ip或主机名，“+”表示优先，“*”表示次优先</span><br><span class="line">refid    - 参考上一层ntp主机地址</span><br><span class="line">st       - stratum阶层</span><br><span class="line">when     - 多少秒前曾经同步过时间</span><br><span class="line">poll     - 下次更新在多少秒后</span><br><span class="line">reach    - 已经向上层ntp服务器要求更新的次数</span><br><span class="line">delay    - 网络延迟</span><br><span class="line">offset   - 时间补偿</span><br><span class="line">jitter   - 系统时间与bios时间差</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端配置时间同步</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">//与ntp服务端同步</span><br><span class="line">ntpdate 192.168.1.101</span><br><span class="line"></span><br><span class="line">//写入到bios</span><br><span class="line">hclock -w</span><br><span class="line"></span><br><span class="line">//写入到计划任务</span><br><span class="line">/etc/crontab:</span><br><span class="line">01 0 * * * root /usr/sbin/ntpdate 192.168.1.101 2&gt;&amp;1 &gt;/dev/null</span><br><span class="line"></span><br><span class="line">//重启crond计划任务</span><br><span class="line">/etc/init.d/crond restart</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/ntpd-install/" data-id="cjavy9k2a007h0coq5b6i0f5e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis-cluster-redis-trib-rb" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-cluster-redis-trib-rb/" class="article-date">
  <time datetime="2017-03-05T18:00:52.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-cluster-redis-trib-rb/">redis cluster redis-trib.rb</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-trib.rb是redis官方推出的管理redis集群的工具,集成在redis的源码src目录下,是基于redis提供的集群命令封装成简单、便捷、实用的操作工具。redis-trib.rb是redis作者用ruby完成的.</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb <span class="built_in">help</span></span><br><span class="line">Usage: redis-trib &lt;<span class="built_in">command</span>&gt; &lt;options&gt; &lt;arguments ...&gt;</span><br><span class="line">  create          host1:port1 ... hostN:portN</span><br><span class="line">                  --replicas &lt;arg&gt;</span><br><span class="line">  check           host:port</span><br><span class="line">  info            host:port</span><br><span class="line">  fix             host:port</span><br><span class="line">                  --timeout &lt;arg&gt;</span><br><span class="line">  reshard         host:port</span><br><span class="line">                  --from &lt;arg&gt;</span><br><span class="line">                  --to &lt;arg&gt;</span><br><span class="line">                  --slots &lt;arg&gt;</span><br><span class="line">                  --yes</span><br><span class="line">                  --timeout &lt;arg&gt;</span><br><span class="line">                  --pipeline &lt;arg&gt;</span><br><span class="line">  rebalance       host:port</span><br><span class="line">                  --weight &lt;arg&gt;</span><br><span class="line">                  --auto-weights</span><br><span class="line">                  --threshold &lt;arg&gt;</span><br><span class="line">                  --use-empty-masters</span><br><span class="line">                  --timeout &lt;arg&gt;</span><br><span class="line">                  --simulate</span><br><span class="line">                  --pipeline &lt;arg&gt;</span><br><span class="line">  add-node        new_host:new_port existing_host:existing_port</span><br><span class="line">                  --slave</span><br><span class="line">                  --master-id &lt;arg&gt;</span><br><span class="line">  del-node        host:port node_id</span><br><span class="line">  <span class="built_in">set</span>-timeout     host:port milliseconds</span><br><span class="line">  call            host:port <span class="built_in">command</span> arg arg .. arg</span><br><span class="line">  import          host:port</span><br><span class="line">                  --from &lt;arg&gt;</span><br><span class="line">                  --copy</span><br><span class="line">                  --replace</span><br><span class="line">  <span class="built_in">help</span>            (show this <span class="built_in">help</span>)</span><br><span class="line">For check, fix, reshard, del-node, <span class="built_in">set</span>-timeout you can specify the host and port of any working node <span class="keyword">in</span> the cluster.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">redis-trib.rb具有以下功能：</span><br><span class="line">1、create：创建集群</span><br><span class="line">2、check：检查集群</span><br><span class="line">3、info：查看集群信息</span><br><span class="line">4、fix：修复集群</span><br><span class="line">5、reshard：在线迁移slot</span><br><span class="line">6、rebalance：平衡集群节点slot数量</span><br><span class="line">7、add-node：将新节点加入集群</span><br><span class="line">8、del-node：从集群中删除节点</span><br><span class="line">9、set-timeout：设置集群节点间心跳连接的超时时间</span><br><span class="line">10、call：在集群全部节点上执行命令</span><br><span class="line">11、import：将外部redis数据导入集群</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="create创建集群"><a href="#create创建集群" class="headerlink" title="create创建集群"></a>create创建集群</h3><p><em>create命令可选replicas参数,replicas表示需要有几个slave</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">最简单命令使用如下：</span><br><span class="line"><span class="variable">$ruby</span> redis-trib.rb create 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003</span><br><span class="line"></span><br><span class="line">有一个slave的创建命令如下：</span><br><span class="line"><span class="variable">$ruby</span> redis-trib.rb create --replicas 1 127.0.0.1:7001 127.0.0.1:7002 127.0.0.1:7003 127.0.0.1:7004 127.0.0.1:7005 127.0.0.1:7006</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">创建流程如下:</span><br><span class="line">1、首先为每个节点创建ClusterNode对象，包括连接每个节点。检查每个节点是否为独立且db为空的节点。执行load_info方法导入节点信息。</span><br><span class="line">2、检查传入的master节点数量是否大于等于3个。只有大于3个节点才能组成集群。</span><br><span class="line">3、计算每个master需要分配的slot数量，以及给master分配slave。分配的算法大致如下：</span><br><span class="line">   先把节点按照host分类，这样保证master节点能分配到更多的主机中。</span><br><span class="line">   不停遍历遍历host列表，从每个host列表中弹出一个节点，放入interleaved数组。直到所有的节点都弹出为止。</span><br><span class="line">   master节点列表就是interleaved前面的master数量的节点列表。保存在masters数组。</span><br><span class="line">   计算每个master节点负责的slot数量，保存在slots_per_node对象，用slot总数除以master数量取整即可。</span><br><span class="line">   遍历masters数组，每个master分配slots_per_node个slot，最后一个master，分配到16384个slot为止。</span><br><span class="line">   接下来为master分配slave，分配算法会尽量保证master和slave节点不在同一台主机上。对于分配完指定slave数量的节点，还有多余的节点，也会为这些节点寻找master。分配算法会遍历两次masters数组。</span><br><span class="line">   第一次遍历masters数组，在余下的节点列表找到replicas数量个slave。每个slave为第一个和master节点host不一样的节点，如果没有不一样的节点，则直接取出余下列表的第一个节点。</span><br><span class="line">   第二次遍历是在对于节点数除以replicas不为整数，则会多余一部分节点。遍历的方式跟第一次一样，只是第一次会一次性给master分配replicas数量个slave，而第二次遍历只分配一个，直到余下的节点被全部分配出去。</span><br><span class="line">4、打印出分配信息，并提示用户输入“yes”确认是否按照打印出来的分配方式创建集群。</span><br><span class="line">5、输入“yes”后，会执行flush_nodes_config操作，该操作执行前面的分配结果，给master分配slot，让slave复制master，对于还没有握手（cluster meet）的节点，slave复制操作无法完成，不过没关系，flush_nodes_config操作出现异常会很快返回，后续握手后会再次执行flush_nodes_config。</span><br><span class="line">6、给每个节点分配epoch，遍历节点，每个节点分配的epoch比之前节点大1。</span><br><span class="line">7、节点间开始相互握手，握手的方式为节点列表的其他节点跟第一个节点握手。</span><br><span class="line">8、然后每隔1秒检查一次各个节点是否已经消息同步完成，使用ClusterNode的get_config_signature方法，检查的算法为获取每个节点cluster nodes信息，排序每个节点，组装成node_id1:slots|node_id2:slot2|...的字符串。如果每个节点获得字符串都相同，即认为握手成功。</span><br><span class="line">9、此后会再执行一次flush_nodes_config，这次主要是为了完成slave复制操作。</span><br><span class="line">10、最后再执行check_cluster，全面检查一次集群状态。包括和前面握手时检查一样的方式再检查一遍。确认没有迁移的节点。确认所有的slot都被分配出去了。</span><br><span class="line">11、至此完成了整个创建流程，返回[OK] All 16384 slots covered.。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="check检查集群"><a href="#check检查集群" class="headerlink" title="check检查集群"></a>check检查集群</h3><p><em>检查集群状态的命令，没有其他参数，只需要选择一个集群中的一个节点即可。</em></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">执行命令以及结果如下：</span><br><span class="line"><span class="variable">$ruby</span> redis-trib.rb check 127.0.0.1:7001</span><br><span class="line">&gt;&gt;&gt; Performing Cluster Check (using node 127.0.0.1:7001)</span><br><span class="line">M: b2506515b38e6bbd3034d540599f4cd2a5279ad1 127.0.0.1:7001</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: d376aaf80de0e01dde1f8cd4647d5ac3317a8641 127.0.0.1:7002</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">M: 15126fb33796c2c26ea89e553418946f7443d5a5 127.0.0.1:7003</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 59fa6ee455f58a5076f6d6f83ddd74161fd7fb55 127.0.0.1:7004</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 15126fb33796c2c26ea89e553418946f7443d5a5</span><br><span class="line">S: 460b3a11e296aafb2615043291b7dd98274bb351 127.0.0.1:7005</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates b2506515b38e6bbd3034d540599f4cd2a5279ad1</span><br><span class="line">M: e36c46dbe90960f30861af00786d4c2064e63df2 127.0.0.1:7006</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check <span class="keyword">for</span> open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">检查前会先执行load_cluster_info_from_node方法，把所有节点数据load进来。load的方式为通过自己的cluster nodes发现其他节点，然后连接每个节点，并加入nodes数组。接着生成节点间的复制关系。load完数据后，开始检查数据，检查的方式也是调用创建时候使用的check_cluster。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="info查看集群信息"><a href="#info查看集群信息" class="headerlink" title="info查看集群信息"></a>info查看集群信息</h3><p><em>info命令用来查看集群的信息。info命令也是先执行load_cluster_info_from_node获取完整的集群信息。然后显示ClusterNode的info_string结果</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">示例如下：</span><br><span class="line"><span class="variable">$ruby</span> redis-trib.rb info 127.0.0.1:7001</span><br><span class="line">127.0.0.1:7001 (b2506515...) -&gt; 0 keys | 5461 slots | 1 slaves.</span><br><span class="line">127.0.0.1:7003 (15126fb3...) -&gt; 0 keys | 5461 slots | 1 slaves.</span><br><span class="line">127.0.0.1:7005 (e36c46db...) -&gt; 0 keys | 5462 slots | 1 slaves.</span><br><span class="line">[OK] 0 keys <span class="keyword">in</span> 3 masters.</span><br><span class="line">0.00 keys per slot on average.</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="fix修复集群"><a href="#fix修复集群" class="headerlink" title="fix修复集群"></a>fix修复集群</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fix命令的流程跟check的流程很像，显示加载集群信息，然后在check_cluster方法内传入fix为</span><br><span class="line">true的变量，会在集群检查出现异常的时候执行修复流程。目前fix命令能修复两种异常，一种是集群有处于迁移中的slot的节点，一种是slot未完全分配的异常。</span><br><span class="line">fix_open_slot方法是修复集群有处于迁移中的slot的节点异常。</span><br><span class="line">1、先检查该slot是谁负责的，迁移的源节点如果没完成迁移，owner还是该节点。没有owner的slot无法完成修复功能。</span><br><span class="line">2、遍历每个节点，获取哪些节点标记该slot为migrating状态，哪些节点标记该slot为importing状态。对于owner不是该节点，但是通过cluster countkeysinslot获取到该节点有数据的情况，也认为该节点为importing状态。</span><br><span class="line">3、如果migrating和importing状态的节点均只有1个，这可能是迁移过程中redis-trib.rb被中断所致，直接执行move_slot继续完成迁移任务即可。传递dots和fix为true。</span><br><span class="line">4、如果migrating为空，importing状态的节点大于0，那么这种情况执行回滚流程，将importing状态的节点数据通过move_slot方法导给slot的owner节点，传递dots、fix和cold为true。接着对importing的节点执行cluster stable命令恢复稳定。</span><br><span class="line">5、如果importing状态的节点为空，有一个migrating状态的节点，而且该节点在当前slot没有数据，那么可以直接把这个slot设为stable。</span><br><span class="line">6、如果migrating和importing状态不是上述情况，目前redis-trib.rb工具无法修复，上述的三种情况也已经覆盖了通过redis-trib.rb工具迁移出现异常的各个方面，人为的异常情形太多，很难考虑完全。</span><br><span class="line"></span><br><span class="line">fix_slots_coverage方法能修复slot未完全分配的异常。未分配的slot有三种状态。</span><br><span class="line">1、所有节点的该slot都没有数据。该状态redis-trib.rb工具直接采用随机分配的方式，并没有考虑节点的均衡。本人尝试对没有分配slot的集群通过fix修复集群，结果slot还是能比较平均的分配，但是没有了连续性，打印的slot信息非常离散。</span><br><span class="line">2、有一个节点的该slot有数据。该状态下，直接把slot分配给该slot有数据的节点。</span><br><span class="line">3、有多个节点的该slot有数据。此种情况目前还处于TODO状态，不过redis作者列出了修复的步骤，对这些节点，除第一个节点，执行cluster migrating命令，然后把这些节点的数据迁移到第一个节点上。清除migrating状态，然后把slot分配给第一个节点。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="reshard在线迁移slot"><a href="#reshard在线迁移slot" class="headerlink" title="reshard在线迁移slot"></a>reshard在线迁移slot</h3><p><em>reshard命令可以在线把集群的一些slot从集群原来slot负责节点迁移到新的节点，利用reshard可以完成集群的在线横向扩容和缩容。</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">reshard         host:port</span><br><span class="line">                --from &lt;arg&gt;</span><br><span class="line">                --to &lt;arg&gt;</span><br><span class="line">                --slots &lt;arg&gt;</span><br><span class="line">                --yes</span><br><span class="line">                --timeout &lt;arg&gt;</span><br><span class="line">                --pipeline &lt;arg&gt;</span><br><span class="line"></span><br><span class="line">host:port：这个是必传参数，用来从一个节点获取整个集群信息，相当于获取集群信息的入口。</span><br><span class="line">--from &lt;arg&gt;：需要从哪些源节点上迁移slot，可从多个源节点完成迁移，以逗号隔开，传递的是节点的node id，还可以直接传递--from all，这样源节点就是集群的所有节点，不传递该参数的话，则会在迁移过程中提示用户输入。</span><br><span class="line">--to &lt;arg&gt;：slot需要迁移的目的节点的node id，目的节点只能填写一个，不传递该参数的话，则会在迁移过程中提示用户输入。</span><br><span class="line">--slots &lt;arg&gt;：需要迁移的slot数量，不传递该参数的话，则会在迁移过程中提示用户输入。</span><br><span class="line">--yes：设置该参数，可以在打印执行reshard计划的时候，提示用户输入yes确认后再执行reshard。</span><br><span class="line">--timeout &lt;arg&gt;：设置migrate命令的超时时间。</span><br><span class="line">--pipeline &lt;arg&gt;：定义cluster getkeysinslot命令一次取出的key数量，不传的话使用默认值为10。</span><br><span class="line"></span><br><span class="line">迁移的流程如下：</span><br><span class="line">1、通过load_cluster_info_from_node方法装载集群信息。</span><br><span class="line">2、执行check_cluster方法检查集群是否健康。只有健康的集群才能进行迁移。</span><br><span class="line">3、获取需要迁移的slot数量，用户没传递--slots参数，则提示用户手动输入。</span><br><span class="line">4、获取迁移的目的节点，用户没传递--to参数，则提示用户手动输入。此处会检查目的节点必须为master节点。</span><br><span class="line">5、获取迁移的源节点，用户没传递--from参数，则提示用户手动输入。此处会检查源节点必须为master节点。--from all的话，源节点就是除了目的节点外的全部master节点。这里为了保证集群slot分配的平均，建议传递--from all。</span><br><span class="line">6、执行compute_reshard_table方法，计算需要迁移的slot数量如何分配到源节点列表，采用的算法是按照节点负责slot数量由多到少排序，计算每个节点需要迁移的slot的方法为：迁移slot数量 * (该源节点负责的slot数量 / 源节点列表负责的slot总数)。这样算出的数量可能不为整数，这里代码用了下面的方式处理：</span><br><span class="line"></span><br><span class="line">n = (numslots/source_tot_slots*s.slots.length)</span><br><span class="line">if i == 0</span><br><span class="line">    n = n.ceil</span><br><span class="line">else</span><br><span class="line">    n = n.floor</span><br><span class="line">这样的处理方式会带来最终分配的slot与请求迁移的slot数量不一致，这个BUG已经在github上提给作者，https://github.com/antirez/redis/issues/2990。</span><br><span class="line"></span><br><span class="line">7、打印出reshard计划，如果用户没传--yes，就提示用户确认计划。</span><br><span class="line">8、根据reshard计划，一个个slot的迁移到新节点上，迁移使用move_slot方法，该方法被很多命令使用，具体可以参见下面的迁移流程。move_slot方法传递dots为true和pipeline数量。</span><br><span class="line">9、至此，就完成了全部的迁移任务。</span><br><span class="line">下面看下一次reshard的执行结果：</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb reshard --from all --to 80b661ecca260c89e3d8ea9b98f77edaeef43dcd --slots 11 10.180.157.199:6379</span><br><span class="line">&gt;&gt;&gt; Performing Cluster Check (using node 10.180.157.199:6379)</span><br><span class="line">S: b2506515b38e6bbd3034d540599f4cd2a5279ad1 10.180.157.199:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 460b3a11e296aafb2615043291b7dd98274bb351</span><br><span class="line">S: d376aaf80de0e01dde1f8cd4647d5ac3317a8641 10.180.157.205:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">M: 15126fb33796c2c26ea89e553418946f7443d5a5 10.180.157.201:6379</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">S: 59fa6ee455f58a5076f6d6f83ddd74161fd7fb55 10.180.157.208:6379</span><br><span class="line">   slots: (0 slots) slave</span><br><span class="line">   replicates 15126fb33796c2c26ea89e553418946f7443d5a5</span><br><span class="line">M: 460b3a11e296aafb2615043291b7dd98274bb351 10.180.157.202:6379</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">M: 80b661ecca260c89e3d8ea9b98f77edaeef43dcd 10.180.157.200:6380</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">M: e36c46dbe90960f30861af00786d4c2064e63df2 10.180.157.200:6379</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check <span class="keyword">for</span> open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line"></span><br><span class="line">Ready to move 11 slots.</span><br><span class="line">  Source nodes:</span><br><span class="line">    M: 15126fb33796c2c26ea89e553418946f7443d5a5 10.180.157.201:6379</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">    M: 460b3a11e296aafb2615043291b7dd98274bb351 10.180.157.202:6379</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">    M: e36c46dbe90960f30861af00786d4c2064e63df2 10.180.157.200:6379</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">   1 additional replica(s)</span><br><span class="line">  Destination node:</span><br><span class="line">    M: 80b661ecca260c89e3d8ea9b98f77edaeef43dcd 10.180.157.200:6380</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">  Resharding plan:</span><br><span class="line">    Moving slot 5461 from e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">    Moving slot 5462 from e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">    Moving slot 5463 from e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">    Moving slot 5464 from e36c46dbe90960f30861af00786d4c2064e63df2</span><br><span class="line">    Moving slot 0 from 460b3a11e296aafb2615043291b7dd98274bb351</span><br><span class="line">    Moving slot 1 from 460b3a11e296aafb2615043291b7dd98274bb351</span><br><span class="line">    Moving slot 2 from 460b3a11e296aafb2615043291b7dd98274bb351</span><br><span class="line">    Moving slot 10923 from 15126fb33796c2c26ea89e553418946f7443d5a5</span><br><span class="line">    Moving slot 10924 from 15126fb33796c2c26ea89e553418946f7443d5a5</span><br><span class="line">    Moving slot 10925 from 15126fb33796c2c26ea89e553418946f7443d5a5</span><br><span class="line">Do you want to proceed with the proposed reshard plan (yes/no)? yes</span><br><span class="line">Moving slot 5461 from 10.180.157.200:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 5462 from 10.180.157.200:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 5463 from 10.180.157.200:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 5464 from 10.180.157.200:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 0 from 10.180.157.202:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 1 from 10.180.157.202:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 2 from 10.180.157.202:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 10923 from 10.180.157.201:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 10924 from 10.180.157.201:6379 to 10.180.157.200:6380:</span><br><span class="line">Moving slot 10925 from 10.180.157.201:6379 to 10.180.157.200:6380:</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">move_slot方法可以在线将一个slot的全部数据从源节点迁移到目的节点，fix、reshard、rebalance都需要调用该方法迁移slot。</span><br><span class="line">move_slot接受下面几个参数，</span><br><span class="line">1、pipeline：设置一次从slot上获取多少个key。</span><br><span class="line">2、quiet：迁移会打印相关信息，设置quiet参数，可以不用打印这些信息。</span><br><span class="line">3、cold：设置cold，会忽略执行importing和migrating。</span><br><span class="line">4、dots：设置dots，则会在迁移过程打印迁移key数量的进度。</span><br><span class="line">5、update：设置update，则会更新内存信息，方便以后的操作。</span><br><span class="line"></span><br><span class="line">move_slot流程如下：</span><br><span class="line">1、如果没有设置cold，则对源节点执行cluster importing命令，对目的节点执行migrating命令。fix的时候有可能importing和migrating已经执行过来，所以此种场景会设置cold。</span><br><span class="line">2、通过cluster getkeysinslot命令，一次性获取远节点迁移slot的pipeline个key的数量.</span><br><span class="line">3、对这些key执行migrate命令，将数据从源节点迁移到目的节点。</span><br><span class="line">4、如果migrate出现异常，在fix模式下，BUSYKEY的异常，会使用migrate的replace模式再执行一次，BUSYKEY表示目的节点已经有该key了，replace模式可以强制替换目的节点的key。不是fix模式就直接返回错误了。</span><br><span class="line">5、循环执行cluster getkeysinslot命令，直到返回的key数量为0，就退出循环。</span><br><span class="line">6、如果没有设置cold，对每个节点执行cluster setslot命令，把slot赋给目的节点。</span><br><span class="line">7、如果设置update，则修改源节点和目的节点的slot信息。</span><br><span class="line">8、至此完成了迁移slot的流程。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="rebalance平衡集群节点slot数量"><a href="#rebalance平衡集群节点slot数量" class="headerlink" title="rebalance平衡集群节点slot数量"></a>rebalance平衡集群节点slot数量</h3><p><em>rebalance命令可以根据用户传入的参数平衡集群节点的slot数量，rebalance功能非常强大，可以传入的参数很多，以下是rebalance的参数列表和命令示例。</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rebalance       host:port</span><br><span class="line">                --weight &lt;arg&gt;</span><br><span class="line">                --auto-weights</span><br><span class="line">                --threshold &lt;arg&gt;</span><br><span class="line">                --use-empty-masters</span><br><span class="line">                --timeout &lt;arg&gt;</span><br><span class="line">                --simulate</span><br><span class="line">                --pipeline &lt;arg&gt;</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb rebalance --threshold 1 --weight b31e3a2e=5 --weight 60b8e3a1=5 --use-empty-masters  --simulate 10.180.157.199:6379</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">下面也先一一解释下每个参数的用法：</span><br><span class="line">host:port：这个是必传参数，用来从一个节点获取整个集群信息，相当于获取集群信息的入口。</span><br><span class="line">--weight &lt;arg&gt;：节点的权重，格式为node_id=weight，如果需要为多个节点分配权重的话，需要添加多个--weight &lt;arg&gt;参数，即--weight b31e3a2e=5 --weight 60b8e3a1=5，node_id可为节点名称的前缀，只要保证前缀位数能唯一区分该节点即可。没有传递–weight的节点的权重默认为1。</span><br><span class="line">--auto-weights：这个参数在rebalance流程中并未用到。</span><br><span class="line">--threshold &lt;arg&gt;：只有节点需要迁移的slot阈值超过threshold，才会执行rebalance操作。具体计算方法可以参考下面的rebalance命令流程的第四步。</span><br><span class="line">--use-empty-masters：rebalance是否考虑没有节点的master，默认没有分配slot节点的master是不参与rebalance的，设置--use-empty-masters可以让没有分配slot的节点参与rebalance。</span><br><span class="line">--timeout &lt;arg&gt;：设置migrate命令的超时时间。</span><br><span class="line">--simulate：设置该参数，可以模拟rebalance操作，提示用户会迁移哪些slots，而不会真正执行迁移操作。</span><br><span class="line">--pipeline &lt;arg&gt;：与reshar的pipeline参数一样，定义cluster getkeysinslot命令一次取出的key数量，不传的话使用默认值为10。</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">rebalance命令流程如下：</span><br><span class="line">1、load_cluster_info_from_node方法先加载集群信息。</span><br><span class="line">2、计算每个master的权重，根据参数--weight &lt;arg&gt;，为每个设置的节点分配权重，没有设置的节点，则权重默认为1。</span><br><span class="line">3、根据每个master的权重，以及总的权重，计算自己期望被分配多少个slot。计算的方式为：总slot数量 * （自己的权重 / 总权重）。</span><br><span class="line">4、计算每个master期望分配的slot是否超过设置的阈值，即--threshold &lt;arg&gt;设置的阈值或者默认的阈值。计算的方式为：先计算期望移动节点的阈值，算法为：(100-(100.0*expected/n.slots.length)).abs，如果计算出的阈值没有超出设置阈值，则不需要为该节点移动slot。只要有一个master的移动节点超过阈值，就会触发rebalance操作。</span><br><span class="line">5、如果触发了rebalance操作。那么就开始执行rebalance操作，先将每个节点当前分配的slots数量减去期望分配的slot数量获得balance值。将每个节点的balance从小到大进行排序获得sn数组。</span><br><span class="line">6、用dst_idx和src_idx游标分别从sn数组的头部和尾部开始遍历。目的是为了把尾部节点的slot分配给头部节点。</span><br><span class="line"></span><br><span class="line">sn数组保存的balance列表排序后，负数在前面，正数在后面。负数表示需要有slot迁入，所以使用dst_idx游标，正数表示需要有slot迁出，所以使用src_idx游标。理论上sn数组各节点的balance值加起来应该为0，不过由于在计算期望分配的slot的时候只是使用直接取整的方式，所以可能出现balance值之和不为0的情况，balance值之和不为0即为节点不平衡的slot数量，由于slot总数有16384个，不平衡数量相对于总数，基数很小，所以对rebalance流程影响不大。</span><br><span class="line"></span><br><span class="line">7、获取sn[dst_idx]和sn[src_idx]的balance值较小的那个值，该值即为需要从sn[src_idx]节点迁移到sn[dst_idx]节点的slot数量。</span><br><span class="line">8、接着通过compute_reshard_table方法计算源节点的slot如何分配到源节点列表。这个方法在reshard流程中也有调用，具体步骤可以参考reshard流程的第六步。</span><br><span class="line">9、如果是simulate模式，则只是打印出迁移列表。</span><br><span class="line">10、如果没有设置simulate，则执行move_slot操作，迁移slot，传入的参数为:quiet=&gt;true,:dots=&gt;false,:update=&gt;true。</span><br><span class="line">11、迁移完成后更新sn[dst_idx]和sn[src_idx]的balance值。如果balance值为0后，游标向前进1。</span><br><span class="line">12、直到dst_idx到达src_idx游标，完成整个rebalance操作。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="add-node将新节点加入集群"><a href="#add-node将新节点加入集群" class="headerlink" title="add-node将新节点加入集群"></a>add-node将新节点加入集群</h3><p><em>add-node命令可以将新节点加入集群，节点可以为master，也可以为某个master节点的slave。</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">add-node    new_host:new_port existing_host:existing_port</span><br><span class="line">          --slave</span><br><span class="line">          --master-id &lt;arg&gt;</span><br><span class="line"></span><br><span class="line">add-node有两个可选参数：</span><br><span class="line">--slave：设置该参数，则新节点以slave的角色加入集群</span><br><span class="line">--master-id：这个参数需要设置了--slave才能生效，--master-id用来指定新节点的master节点。如果不设置该参数，则会随机为节点选择master节点。</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb add-node --slave --master-id dcb792b3e85726f012e83061bf237072dfc45f99 10.180.157.202:6379 10.180.157.199:6379</span><br><span class="line">&gt;&gt;&gt; Adding node 10.180.157.202:6379 to cluster 10.180.157.199:6379</span><br><span class="line">&gt;&gt;&gt; Performing Cluster Check (using node 10.180.157.199:6379)</span><br><span class="line">M: dcb792b3e85726f012e83061bf237072dfc45f99 10.180.157.199:6379</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">M: 464d740bf48953ebcf826f4113c86f9db3a9baf3 10.180.157.201:6379</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">M: befa7e17b4e5f239e519bc74bfef3264a40f96ae 10.180.157.200:6379</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">   0 additional replica(s)</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check <span class="keyword">for</span> open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br><span class="line">&gt;&gt;&gt; Send CLUSTER MEET to node 10.180.157.202:6379 to make it join the cluster.</span><br><span class="line">Waiting <span class="keyword">for</span> the cluster to join.</span><br><span class="line">&gt;&gt;&gt; Configure node as replica of 10.180.157.199:6379.</span><br><span class="line">[OK] New node added correctly.</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add-node流程如下：</span><br><span class="line">1、通过load_cluster_info_from_node方法转载集群信息，check_cluster方法检查集群是否健康。</span><br><span class="line">2、如果设置了--slave，则需要为该节点寻找master节点。设置了--master-id，则以该节点作为新节点的master，如果没有设置--master-id，则调用get_master_with_least_replicas方法，寻找slave数量最少的master节点。如果slave数量一致，则选取load_cluster_info_from_node顺序发现的第一个节点。load_cluster_info_from_node顺序的第一个节点是add-node设置的existing_host:existing_port节点，后面的顺序根据在该节点执行cluster nodes返回的结果返回的节点顺序。</span><br><span class="line">3、连接新的节点并与集群第一个节点握手。</span><br><span class="line">4、如果没设置–slave就直接返回ok，设置了–slave，则需要等待确认新节点加入集群，然后执行cluster replicate命令复制master节点。</span><br><span class="line">5、至此，完成了全部的增加节点的流程。</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="del-node从集群中删除节点"><a href="#del-node从集群中删除节点" class="headerlink" title="del-node从集群中删除节点"></a>del-node从集群中删除节点</h3><p><em>del-node可以把某个节点从集群中删除。del-node只能删除没有分配slot的节点。删除命令传递两个参数：</em><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">host:port：从该节点获取集群信息。</span><br><span class="line">node_id：需要删除的节点id。</span><br><span class="line">del-node执行结果示例如下：</span><br></pre></td></tr></table></figure></p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb del-node 10.180.157.199:6379 d5f6d1d17426bd564a6e309f32d0f5b96962fe53</span><br><span class="line">&gt;&gt;&gt; Removing node d5f6d1d17426bd564a6e309f32d0f5b96962fe53 from cluster 10.180.157.199:6379</span><br><span class="line">&gt;&gt;&gt; Sending CLUSTER FORGET messages to the cluster...</span><br><span class="line">&gt;&gt;&gt; SHUTDOWN the node.</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">del-node流程如下：</span><br><span class="line">1、通过load_cluster_info_from_node方法转载集群信息。</span><br><span class="line">2、根据传入的node id获取节点，如果节点没找到，则直接提示错误并退出。</span><br><span class="line">3、如果节点分配的slot不为空，则直接提示错误并退出。</span><br><span class="line">4、遍历集群内的其他节点，执行cluster forget命令，从每个节点中去除该节点。如果删除的节点是master，而且它有slave的话，这些slave会去复制其他master，调用的方法是get_master_with_least_replicas，与add-node没设置--master-id寻找master的方法一样。</span><br><span class="line">5、然后关闭该节点</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="set-timeout设置集群节点间心跳连接的超时时间"><a href="#set-timeout设置集群节点间心跳连接的超时时间" class="headerlink" title="set-timeout设置集群节点间心跳连接的超时时间"></a>set-timeout设置集群节点间心跳连接的超时时间</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set-timeout用来设置集群节点间心跳连接的超时时间，单位是毫秒，不得小于100毫秒，因为100毫秒对于心跳时间来说太短了。该命令修改是节点配置参数cluster-node-timeout，默认是15000毫秒。通过该命令，可以给每个节点设置超时时间，设置的方式使用config set命令动态设置，然后执行config rewrite命令将配置持久化保存到硬盘。以下是示例：</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ruby redis-trib.rb <span class="built_in">set</span>-timeout 10.180.157.199:6379 30000</span><br><span class="line">&gt;&gt;&gt; Reconfiguring node timeout <span class="keyword">in</span> every cluster node...</span><br><span class="line">*** New timeout <span class="built_in">set</span> <span class="keyword">for</span> 10.180.157.199:6379</span><br><span class="line">*** New timeout <span class="built_in">set</span> <span class="keyword">for</span> 10.180.157.205:6379</span><br><span class="line">*** New timeout <span class="built_in">set</span> <span class="keyword">for</span> 10.180.157.201:6379</span><br><span class="line">*** New timeout <span class="built_in">set</span> <span class="keyword">for</span> 10.180.157.200:6379</span><br><span class="line">*** New timeout <span class="built_in">set</span> <span class="keyword">for</span> 10.180.157.208:6379</span><br><span class="line">&gt;&gt;&gt; New node timeout <span class="built_in">set</span>. 5 OK, 0 ERR.</span><br></pre></td></tr></table></figure>
<hr>
<h3 id="call在集群全部节点上执行命令"><a href="#call在集群全部节点上执行命令" class="headerlink" title="call在集群全部节点上执行命令"></a>call在集群全部节点上执行命令</h3><p><em>call命令可以用来在集群的全部节点执行相同的命令。call命令也是需要通过集群的一个节点地址，连上整个集群，然后在集群的每个节点执行该命令。</em><br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ruby</span> redis-trib.rb call 10.180.157.199:6379 get key</span><br><span class="line">&gt;&gt;&gt; Calling GET key</span><br><span class="line">10.180.157.199:6379: MOVED 12539 10.180.157.201:6379</span><br><span class="line">10.180.157.205:6379: MOVED 12539 10.180.157.201:6379</span><br><span class="line">10.180.157.201:6379:</span><br><span class="line">10.180.157.200:6379: MOVED 12539 10.180.157.201:6379</span><br><span class="line">10.180.157.208:6379: MOVED 12539 10.180.157.201:6379</span><br></pre></td></tr></table></figure></p>
<hr>
<h3 id="import将外部redis数据导入集群"><a href="#import将外部redis数据导入集群" class="headerlink" title="import将外部redis数据导入集群"></a>import将外部redis数据导入集群</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import命令可以把外部的redis节点数据导入集群。导入的流程如下：</span><br><span class="line">1、通过load_cluster_info_from_node方法转载集群信息，check_cluster方法检查集群是否健康。</span><br><span class="line">2、连接外部redis节点，如果外部节点开启了cluster_enabled，则提示错误。</span><br><span class="line">3、通过scan命令遍历外部节点，一次获取1000条数据。</span><br><span class="line">4、遍历这些key，计算出key对应的slot。</span><br><span class="line">5、执行migrate命令,源节点是外部节点,目的节点是集群slot对应的节点，如果设置了--copy参数，则传递copy参数，如果设置了--replace，则传递replace参数。</span><br><span class="line">6、不停执行scan命令，直到遍历完全部的key。</span><br><span class="line">7、至此完成整个迁移流程</span><br><span class="line">这中间如果出现异常，程序就会停止。没使用--copy模式，则可以重新执行import命令，使用--copy的话，最好清空新的集群再导入一次。</span><br><span class="line"></span><br><span class="line">import命令更适合离线的把外部Redis数据导入，在线导入的话最好使用更专业的导入工具，以slave的方式连接redis节点去同步节点数据应该是更好的方式。</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb import --from 10.0.10.1:6379 10.10.10.1:7000</span><br><span class="line">上面的命令是把 10.0.10.1:6379（redis 2.8）上的数据导入到 10.10.10.1:7000这个节点所在的集群</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-cluster-redis-trib-rb/" data-id="cjavy9k5b009a0coqhrpbvnwy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis-use" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-use/" class="article-date">
  <time datetime="2017-03-05T17:26:14.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-use/">redis use</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-use/">redis use</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. redis 批量删除key</span><br><span class="line">redis-cli keys R33111:* | xargs redis-cli del</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-use/" data-id="cjavy9k5j009g0coq76w1u8lq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-postgresql-master-slave-info" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/postgresql-master-slave-info/" class="article-date">
  <time datetime="2017-03-05T17:24:20.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Postgresql/">Postgresql</a>►<a class="article-category-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/postgresql-master-slave-info/">postgresql master slave info</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">postgres在9.0之后引入了主从的流复制机制,所谓流复制,就是从库通过tcp流从主库中同步相应的数据</span><br><span class="line">postgres的主从主称之为primary,从称为stand_by.</span><br><span class="line">主从配置需要注意的一个是主从的postgres的版本,环境,等最好都需要一致,否则可能产生奇奇怪怪的问题</span><br><span class="line"></span><br><span class="line">PG 主从同步有两种方式:</span><br><span class="line">1.hot standby的方式是备库只读的方式</span><br><span class="line">2.warm standby的方式是备库不能提供只读服务</span><br><span class="line"></span><br><span class="line">PG 主从同步有两种方法:</span><br><span class="line">1.使用归档文件,需要归档出wal文件,拷贝到从库上应用</span><br><span class="line">2.使用streaming方式,产生日志,马上应用到从库上,streaming两种方式:同步和异步</span><br><span class="line"></span><br><span class="line">PostgreSQL在数据目录下的pg_xlog子目录中维护了一个WAL日志文件,该文件用于记录数据库文件的每次改变,这种日志文件机制提供了一种数据库热备份的方案,即:</span><br><span class="line">在把数据库使用文件系统的方式备份出来的同时也把相应的WAL日志进行备份,即使备份出来的数据块不一致,也可以重放WAL日志把备份的内容推到一致状态.</span><br><span class="line">这也就是基于时间点的备份（Point-in-Time Recovery）,简称PITR.而把WAL日志传送到另一台服务器有两种方式,分别是：</span><br><span class="line">1.WAL日志归档（base-file）</span><br><span class="line">2.流复制（streaming replication）</span><br><span class="line">第一种是写完一个WAL日志后,才把WAL日志文件拷贝到standby数据库中,简言之就是通过cp命令实现远程备份,这样通常备库会落后主库一个WAL日志文件</span><br><span class="line">第二种流复制是postgresql9.x之后才提供的新的传递WAL日志的方法,它的好处是只要master库一产生日志,就会马上传递到standby库,同第一种相比有更低的同步延迟,所以我们肯定也会选择流复制的方式</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/postgresql-master-slave-info/" data-id="cjavy9k2c007i0coqva32137n" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-redis-error" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/06/redis-error/" class="article-date">
  <time datetime="2017-03-05T17:20:30.000Z" itemprop="datePublished">2017-03-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Redis/">Redis</a>►<a class="article-category-link" href="/categories/database/Redis/redis-error/">redis error</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/06/redis-error/">redis error</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">1.install error</span><br><span class="line">zmalloc.h:50:31: error: jemalloc/jemalloc.h: No such file or directory</span><br><span class="line">zmalloc.h:55:2: error: #error &quot;Newer version of jemalloc required&quot;</span><br><span class="line">make[1]: *** [adlist.o] Error 1</span><br><span class="line">make[1]: Leaving directory `/data0/src/redis-2.6.2/src&apos;</span><br><span class="line">make: *** [all] Error 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Resove:</span><br><span class="line">make MALLOC=libc</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cause:</span><br><span class="line">Allocator</span><br><span class="line">---------</span><br><span class="line">Selecting a non-default memory allocator when building Redis is done by setting</span><br><span class="line">the `MALLOC` environment variable. Redis is compiled and linked against libc</span><br><span class="line">malloc by default, with the exception of jemalloc being the default on Linux</span><br><span class="line">systems. This default was picked because jemalloc has proven to have fewer</span><br><span class="line">fragmentation problems than libc malloc.</span><br><span class="line">To force compiling against libc malloc, use:</span><br><span class="line">    % make MALLOC=libc</span><br><span class="line">To compile against jemalloc on Mac OS X systems, use:</span><br><span class="line">    % make MALLOC=jemalloc</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/06/redis-error/" data-id="cjavy9k5e009c0coq6w48t2kg" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/23/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><a class="page-number" href="/page/23/">23</a><span class="page-number current">24</span><a class="page-number" href="/page/25/">25</a><a class="page-number" href="/page/26/">26</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/25/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
          <li>
            <a href="/2017/11/27/svn-auto-update/">svn auto update</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-event-reactor/">salt manage event reactor</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-job/">salt manage job</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>