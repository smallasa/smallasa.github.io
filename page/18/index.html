<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/18/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-elasticsearch-safe-restart" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-safe-restart/" class="article-date">
  <time datetime="2017-03-20T09:20:03.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-safe-restart/">elasticsearch safe restart</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="安全重启elasticsearch节点"><a href="#安全重启elasticsearch节点" class="headerlink" title="安全重启elasticsearch节点"></a>安全重启elasticsearch节点</h3><ol>
<li><p>刷新到磁盘</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-90-193 ~]<span class="comment"># curl -XGET http://172.31.90.193:9200/_flush</span></span><br><span class="line">&#123;<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:152,<span class="string">"successful"</span>:152,<span class="string">"failed"</span>:0&#125;&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>先暂停集群的shard自动均衡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-90-193 ~]<span class="comment"># curl -XPUT http://172.31.90.193:9200/_cluster/settings -d '</span></span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;     <span class="string">"transient"</span> : &#123;</span><br><span class="line">&gt;         <span class="string">"cluster.routing.allocation.enable"</span> : <span class="string">"none"</span></span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt; &#125;<span class="string">'</span></span><br><span class="line"><span class="string">&#123;"acknowledged":true,"persistent":&#123;&#125;,"transient":&#123;"cluster":&#123;"routing":&#123;"allocation":&#123;"enable":"none"&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>停止node节点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-90-193 ~]<span class="comment"># curl -XGET http://172.31.90.193:9200/_cat/nodes?v</span></span><br><span class="line">host          ip            heap.percent ram.percent load node.role master name       </span><br><span class="line">172.31.90.193 172.31.90.193           34          99 2.07 d         *      Molten Man</span><br><span class="line">172.31.90.45  172.31.90.45            43          99 0.75 d         m      node-2  </span><br><span class="line"></span><br><span class="line">[root@ip-172-31-90-193 ~]<span class="comment"># curl -XPOST http://192.168.1.3:9200/_cluster/nodes/_local/_shutdown</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动node节点</p>
</li>
<li><p>开启集群的shard自动均衡</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ip-172-31-90-193 ~]<span class="comment"># curl -XPUT http://172.31.90.193:9200/_cluster/settings -d'</span></span><br><span class="line">&gt; &#123;</span><br><span class="line">&gt;     <span class="string">"transient"</span> : &#123;</span><br><span class="line">&gt;         <span class="string">"cluster.routing.allocation.enable"</span> : <span class="string">"all"</span></span><br><span class="line">&gt;     &#125;</span><br><span class="line">&gt; &#125;<span class="string">'</span></span><br><span class="line"><span class="string">&#123;"acknowledged":true,"persistent":&#123;&#125;,"transient":&#123;"cluster":&#123;"routing":&#123;"allocation":&#123;"enable":"all"&#125;&#125;&#125;&#125;&#125;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-safe-restart/" data-id="cjavy9jvu002m0coq4qp1ll4w" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-migrate-shard" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-migrate-shard/" class="article-date">
  <time datetime="2017-03-20T09:18:25.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-migrate-shard/">elasticsearch migrate shard</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="迁移分片"><a href="#迁移分片" class="headerlink" title="迁移分片"></a>迁移分片</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch可以通过reroute api来手动进行索引分片的分配.不过要想完全手动,必须先把&quot;cluster.routing.allocation.disable_allocation&quot;参数设置为true,禁止es进行自动索引分片分配,否则你从一节点把分片移到另外一个节点,那么另外一个节点的一个分片又会移到那个节点.</span><br><span class="line"></span><br><span class="line">一共有三种操作,分别为：移动（move）,取消（cancel）和分配（allocate）</span><br><span class="line">下面分别介绍这三种情况：</span><br><span class="line">1.移动（move）</span><br><span class="line">  把分片从一节点移动到另一个节点.可以指定索引名和分片号.</span><br><span class="line">2.取消（cancel）</span><br><span class="line">  取消分配一个分片.可以指定索引名和分片号.node参数可以指定在那个节点取消正在分配的分片.allow_primary参数支持取消分配主分片.</span><br><span class="line">3.分配（allocate）</span><br><span class="line">  分配一个未分配的分片到指定节点.可以指定索引名和分片号.node参数指定分配到那个节点.allow_primary参数可以强制分配主分片,不过这样可能导致数据丢失.</span><br><span class="line">4.例如:</span><br><span class="line">    curl -XPOST &apos;localhost:9200/_cluster/reroute&apos; -d &apos;&#123;  </span><br><span class="line">        &quot;commands&quot; : [ &#123;  </span><br><span class="line">            &quot;move&quot; :   </span><br><span class="line">                &#123;  </span><br><span class="line">                  &quot;index&quot; : &quot;test&quot;, &quot;shard&quot; : 0,   </span><br><span class="line">                  &quot;from_node&quot; : &quot;node1&quot;, &quot;to_node&quot; : &quot;node2&quot;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;,  </span><br><span class="line">           &quot;cancel&quot; :   </span><br><span class="line">                &#123;  </span><br><span class="line">                  &quot;index&quot; : &quot;test&quot;, &quot;shard&quot; : 0, &quot;node&quot; : &quot;node1&quot;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;,  </span><br><span class="line">            &#123;  </span><br><span class="line">              &quot;allocate&quot; : &#123;  </span><br><span class="line">                  &quot;index&quot; : &quot;test&quot;, &quot;shard&quot; : 1, &quot;node&quot; : &quot;node3&quot;  </span><br><span class="line">              &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">        ]  </span><br><span class="line">    &#125;&apos;</span><br></pre></td></tr></table></figure>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//迁移分片</span><br><span class="line">curl -XPOST <span class="string">'localhost:9200/_cluster/reroute'</span> -d <span class="string">'&#123;  </span></span><br><span class="line"><span class="string">  "commands" : [ &#123;  </span></span><br><span class="line"><span class="string">    "move" :   </span></span><br><span class="line"><span class="string">      &#123;  </span></span><br><span class="line"><span class="string">        "index" : "test", "shard" : 0,   </span></span><br><span class="line"><span class="string">        "from_node" : "node1", "to_node" : "node2"  </span></span><br><span class="line"><span class="string">      &#125;  </span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  ]  </span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
<h3 id="分片说明"><a href="#分片说明" class="headerlink" title="分片说明"></a>分片说明</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[wisdom@10 ~]$ curl -XGET <span class="string">'10.0.3.41:9200/_cat/shards'</span>|grep v2-inbound-request-2017.03</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100 26082  100 26082    0     0  61893      0 --:--:-- --:--:-- --:--:-- 61952</span><br><span class="line">v2-inbound-request-2017.03     1 r STARTED 25071632  35.2gb 10.0.3.41 10.0.3.41</span><br><span class="line">v2-inbound-request-2017.03     1 p STARTED 25071643  35.2gb 10.0.3.40 10.0.3.40</span><br><span class="line">v2-inbound-request-2017.03     3 p STARTED 25107804  35.3gb 10.0.3.41 10.0.3.41</span><br><span class="line">v2-inbound-request-2017.03     3 r STARTED 25107796  35.3gb 10.0.3.42 10.0.3.42</span><br><span class="line">v2-inbound-request-2017.03     2 r STARTED 25098807  35.2gb 10.0.3.42 10.0.3.42</span><br><span class="line">v2-inbound-request-2017.03     2 p STARTED 25098799  35.2gb 10.0.3.40 10.0.3.40</span><br><span class="line">v2-inbound-request-2017.03     4 p STARTED 25108295  35.3gb 10.0.3.41 10.0.3.41</span><br><span class="line">v2-inbound-request-2017.03     4 r STARTED 25108301  35.3gb 10.0.3.42 10.0.3.42</span><br><span class="line">v2-inbound-request-2017.03     0 r STARTED 25105055  35.3gb 10.0.3.42 10.0.3.42</span><br><span class="line">v2-inbound-request-2017.03     0 p STARTED 25105050  35.3gb 10.0.3.40 10.0.3.40</span><br><span class="line"></span><br><span class="line">p 表示主分片 primary shard</span><br><span class="line">r 表示副本分片 replica shard</span><br><span class="line">分片数和副本个数在创建索引的时候都可以设置,副本的个数在创建索引之后可以随时更改</span><br></pre></td></tr></table></figure>
<ol>
<li>分片分配规则<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch的shard分布是根据集群设置的比重进行分配的,你可以设置:</span><br><span class="line">curl -XPUT &apos;http://192.168.1.1:9200/_cluster/settings?pretty=true&apos; -d &apos;&#123;</span><br><span class="line">&quot;transient&quot; : &#123;</span><br><span class="line">  &quot;cluster.routing.allocation.balance.shard&quot; : 0.33</span><br><span class="line">  &quot;cluster.routing.allocation.balance.index&quot; : 0.33</span><br><span class="line">  &quot;cluster.routing.allocation.balance.primary&quot; : 0.34</span><br><span class="line">  &quot;cluster.routing.allocation.balance.threshold&quot; : 1</span><br><span class="line">&#125;</span><br><span class="line">&#125;&apos;</span><br><span class="line"></span><br><span class="line">elasticsearch内部计算公式是:</span><br><span class="line">weightindex(node, index) = indexBalance * (node.numShards(index) – avgShardsPerNode(index))</span><br><span class="line">weightnode(node, index)  = shardBalance * (node.numShards() – avgShardsPerNode)</span><br><span class="line">weightprimary(node, index) = primaryBalance * (node.numPrimaries() – avgPrimariesPerNode)</span><br><span class="line">weight(node, index) = weightindex(node, index) + weightnode(node, index) + weightprimary(node, index)</span><br><span class="line">如果计算最后的weight(node, index)大于threshold,就会发生shard迁移.</span><br><span class="line">注：cluster.routing.allocation.balance.primary 在1.3.8版本之后被废弃了</span><br><span class="line"></span><br><span class="line">在一个已经创立的集群里,shard的分布总是均匀的.但是当你扩容节点的时候,你会发现,它总是先移动replica shard到新节点.这样就导致新节点全部分布的全是副本,主shard几乎全留在了老的节点上.</span><br><span class="line"></span><br><span class="line">cluster.routing.allocation.balance参数,比较难找到合适的比例</span><br><span class="line"></span><br><span class="line">建议一种方式是在扩容的时候,设置cluster.routing.allocation.enable=primaries.指只允许移动主shard.</span><br><span class="line">当你发现shard数已经迁移了一半的时候,改回cluster.routing.allocation.enable=all.这样后面的全迁移的是副本shard.</span><br><span class="line">扩容之后,shard和主shard的分布还是均匀的.</span><br><span class="line">curl -XPUT &apos;http://192.168.1.1:9200/_cluster/settings&apos; -d &apos;&#123;</span><br><span class="line">  &quot;transient&quot; : &#123;</span><br><span class="line">    &quot;cluster.routing.allocation.enable” : &quot;primaries&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&apos;</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-migrate-shard/" data-id="cjavy9jvo002g0coqfgheee8h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-how-to-tune-for-search-spped" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-how-to-tune-for-search-spped/" class="article-date">
  <time datetime="2017-03-20T09:11:52.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-how-to-tune-for-search-spped/">elasticsearch how to tune for search spped</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="How-to-Tune-for-search-speed"><a href="#How-to-Tune-for-search-speed" class="headerlink" title="How to Tune for search speed"></a>How to Tune for search speed</h3><ol>
<li><p>Give memory to the filesystem cache</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Elasticsearch heavily relies on the filesystem cache in order to make search fast.</span><br><span class="line">In general, you should make sure that at least half the available memory goes to the filesystem cache so that elasticsearch can keep hot regions of the index in physical memory.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use faster hardware</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If your search is I/O bound, you should investigate giving more memory to the filesystem cache (see above) or buying faster drives.</span><br><span class="line">If your search is CPU-bound, you should investigate buying faster CPUs.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Document modeling</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Documents should be modeled so that search-time operations are as cheap as possible.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Pre-index data</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">You should leverage patterns in your queries to optimize the way data is indexed.</span><br><span class="line">For instance, if all your documents have a price field and most queries run range aggregations on a fixed list of ranges, you could make this aggregation faster by pre-indexing the ranges into the index and using a terms aggregations.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Mappings</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The fact that some data is numeric does not mean it should always be mapped as a numeric field.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Avoid scripts</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">In general, scripts should be avoided</span><br></pre></td></tr></table></figure>
</li>
<li><p>Search rounded dates</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Queries on date fields that use now are typically not cacheable since the range that is being matched changes all the time. However switching to a rounded date is often acceptable in terms of user experience, and has the benefit of making better use of the query cache.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Force-merge read-only indices</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Indices that are read-only would benefit from being merged down to a single segment. This is typically the case with time-based indices: only the index for the current time frame is getting new documents while older indices are read-only.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Warm up global ordinals</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Global ordinals are a data-structure that is used in order to run terms aggregations on keyword fields.</span><br><span class="line">You can tell elasticsearch to load global ordinals eagerly at refresh-time by configuring mappings as described below:</span><br><span class="line">curl -XPUT &apos;localhost:9200/index?pretty&apos; -d&apos;</span><br><span class="line">&#123;</span><br><span class="line">  &quot;mappings&quot;: &#123;</span><br><span class="line">    &quot;type&quot;: &#123;</span><br><span class="line">      &quot;properties&quot;: &#123;</span><br><span class="line">        &quot;foo&quot;: &#123;</span><br><span class="line">          &quot;type&quot;: &quot;keyword&quot;,</span><br><span class="line">          &quot;eager_global_ordinals&quot;: true</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Warm up the filesystem cache</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If the machine running elasticsearch is restarted, the filesystem cache will be empty, so it will take some time before the operating system loads hot regions of the index into memory so that search operations are fast. You can explicitly tell the operating system which files should be loaded into memory eagerly depending on the file extension using the index.store.preload setting</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-how-to-tune-for-search-spped/" data-id="cjavy9jvm002d0coq4jzxv4tm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-how-to-tune-for-indexing-speed" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-how-to-tune-for-indexing-speed/" class="article-date">
  <time datetime="2017-03-20T09:07:55.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-how-to-tune-for-indexing-speed/">elasticsearch how to tune for indexing speed</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="How-to-tune-for-indexing-speed"><a href="#How-to-tune-for-indexing-speed" class="headerlink" title="How to tune for indexing speed"></a>How to tune for indexing speed</h3><ol>
<li><p>Use bulk requests</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Bulk requests will yield much better performance than single-document index requests.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use multiple workers/threads to send data to elasticsearch</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This can be tested by progressively increasing the number of workers until either I/O or CPU is saturated on the cluster.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Increase the refresh interval</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The default index.refresh_interval is 1s, which forces elasticsearch to create a new segment every second.</span><br><span class="line">Increasing this value (to say, 30s) will allow larger segments to flush and decreases future merge pressure.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Disable refresh and replicas for initial loads</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If you need to load a large amount of data at once, you should disable refresh by setting index.refresh_interval to -1 and set index.number_of_replicas to 0.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Disable swapping</p>
</li>
<li><p>Give memory to the filesystem cache</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">The filesystem cache will be used in order to buffer I/O operations.</span><br><span class="line">You should make sure to give at least half the memory of the machine running elasticsearch to the filesystem cache.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use auto-generated ids</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">When indexing a document that has an explicit id, elasticsearch needs to check whether a document with the same id already exists within the same shard, which is a costly operation and gets even more costly as the index grows.</span><br><span class="line">By using auto-generated ids, Elasticsearch can skip this check, which makes indexing faster.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use faster hardware</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">If indexing is I/O bound, you should investigate giving more memory to the filesystem cache (see above) or buying faster drives.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Indexing buffer size</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">If your node is doing only heavy indexing, be sure indices.memory.index_buffer_size is large enough to give at most 512 MB indexing buffer per shard doing heavy indexing (beyond that indexing performance does not typically improve).</span><br><span class="line">The default is 10% which is often plenty: for example, if you give the JVM 10GB of memory, it will give 1GB to the index buffer, which is enough to host two shards that are heavily indexing.</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-how-to-tune-for-indexing-speed/" data-id="cjavy9jvi002a0coq1snlnka3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-full-cluster-restart-upgrade" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-full-cluster-restart-upgrade/" class="article-date">
  <time datetime="2017-03-20T09:05:20.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="Full-cluster-restart-upgrade"><a href="#Full-cluster-restart-upgrade" class="headerlink" title="Full cluster restart upgrade"></a>Full cluster restart upgrade</h3><ol>
<li><p>Disable shard allocation</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">'localhost:9200/_cluster/settings?pretty'</span> -d<span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "persistent": &#123;</span></span><br><span class="line"><span class="string">    "cluster.routing.allocation.enable": "none"</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Perform a synced flush</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="string">'localhost:9200/_flush/synced?pretty'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Shutdown and upgrade all nodes</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Stop all Elasticsearch services on all nodes in the cluster</span><br></pre></td></tr></table></figure>
</li>
<li><p>Upgrade any plugins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Elasticsearch plugins must be upgraded when upgrading a node.</span><br><span class="line">Use the elasticsearch-plugin script to install the correct version of any plugins that you need.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Start the cluster</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">If you have dedicated master nodes — nodes with node.master set to true(the default) and node.data set to false —  then it is a good idea to start them first.</span><br><span class="line">curl -XGET &apos;localhost:9200/_cat/health?pretty&apos;</span><br><span class="line">curl -XGET &apos;localhost:9200/_cat/nodes?pretty&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Wait for yellow</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">As soon as each node has joined the cluster, it will start to recover any primary shards that are stored locally.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Reenable allocation</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">'localhost:9200/_cluster/settings?pretty'</span> -d<span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "persistent": &#123;</span></span><br><span class="line"><span class="string">    "cluster.routing.allocation.enable": "all"</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br><span class="line"></span><br><span class="line">curl -XGET <span class="string">'localhost:9200/_cat/health?pretty'</span></span><br><span class="line">curl -XGET <span class="string">'localhost:9200/_cat/recovery?pretty'</span></span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-full-cluster-restart-upgrade/" data-id="cjavy9jvg00290coqdd7hbtar" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-rolling-upgrades" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-rolling-upgrades/" class="article-date">
  <time datetime="2017-03-20T09:01:20.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="ES-Rolling-upgrades"><a href="#ES-Rolling-upgrades" class="headerlink" title="ES Rolling upgrades"></a>ES Rolling upgrades</h3><ol>
<li><p>Disable shard allocation</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">'localhost:9200/_cluster/settings?pretty'</span> -d<span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "transient": &#123;</span></span><br><span class="line"><span class="string">    "cluster.routing.allocation.enable": "none"</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Stop non-essential indexing and perform a synced flush (Optional)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST <span class="string">'localhost:9200/_flush/synced?pretty'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Stop and upgrade a single node</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">To upgrade using a zip or compressed tarball:</span><br><span class="line">  Extract the zip or tarball to a new directory, to be sure that you don’t overwrite the config or data directories.</span><br><span class="line">  Either copy the files <span class="keyword">in</span> the config directory from your old installation to your new installation, or use the -E path.conf= option on the <span class="built_in">command</span> line to point to an external config directory.</span><br><span class="line">  Either copy the files <span class="keyword">in</span> the data directory from your old installation to your new installation, or configure the location of the data directory <span class="keyword">in</span> the config/elasticsearch.yml file, with the path.data setting.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Upgrade any plugins</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Elasticsearch plugins must be upgraded when upgrading a node.</span><br><span class="line">Use the elasticsearch-plugin script to install the correct version of any plugins that you need.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Start the upgraded node</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Start the now upgraded node and confirm that it joins the cluster by checking the <span class="built_in">log</span> file or by checking the output of this request:</span><br><span class="line">curl -XGET <span class="string">'localhost:9200/_cat/nodes?pretty'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Reenable shard allocation</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT <span class="string">'localhost:9200/_cluster/settings?pretty'</span> -d<span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">  "transient": &#123;</span></span><br><span class="line"><span class="string">    "cluster.routing.allocation.enable": "all"</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Wait for the node to recover</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">You should <span class="built_in">wait</span> <span class="keyword">for</span> the cluster to finish shard allocation before upgrading the next node.</span><br><span class="line">curl -XGET <span class="string">'localhost:9200/_cat/health?pretty'</span></span><br><span class="line">Wait <span class="keyword">for</span> the status column to move from yellow to green.</span><br><span class="line"></span><br><span class="line">Shards that have not been sync-flushed may take some time to recover.</span><br><span class="line">The recovery status of individual shards can be monitored with the _cat/recovery request:</span><br><span class="line">curl -XGET <span class="string">'localhost:9200/_cat/recovery?pretty'</span></span><br><span class="line">If you stopped indexing, <span class="keyword">then</span> it is safe to resume indexing as soon as recovery has completed.</span><br></pre></td></tr></table></figure>
</li>
<li><p>Repeat</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">When the cluster is stable and the node has recovered, repeat the above steps for all remaining nodes.</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-rolling-upgrades/" data-id="cjavy9jvs002l0coqvz10u4eq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-elasticsearch-core-component" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/elasticsearch-core-component/" class="article-date">
  <time datetime="2017-03-20T08:53:26.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a>►<a class="article-category-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/elasticsearch-core-component/">elasticsearch core component</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="elasticsearch-core-component"><a href="#elasticsearch-core-component" class="headerlink" title="elasticsearch core component"></a>elasticsearch core component</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">1.NRT(Near realtime)</span><br><span class="line">  Elasticsearch is a near real time search platform.</span><br><span class="line"></span><br><span class="line">2.cluster</span><br><span class="line">  A cluster is a collection of one or more nodes (servers) that together holds your entire data and provides federated indexing and search capabilities across all nodes.</span><br><span class="line">  A cluster is identified by a unique name which by default is &quot;elasticsearch&quot;. This name is important because a node can only be part of a cluster if the node is set up to join the cluster by its name.</span><br><span class="line"></span><br><span class="line">3.node</span><br><span class="line">  A node is a single server that is part of your cluster, stores your data, and participates in the cluster’s indexing and search capabilities.</span><br><span class="line">  Just like a cluster, a node is identified by a name which by default is a random Universally Unique IDentifier (UUID) that is assigned to the node at startup.</span><br><span class="line">  This name is important for administration purposes where you want to identify which servers in your network correspond to which nodes in your Elasticsearch cluster.</span><br><span class="line"></span><br><span class="line">4.index</span><br><span class="line">  An index is a collection of documents that have somewhat similar characteristics.</span><br><span class="line">  An index is identified by a name (that must be all lowercase) and this name is used to refer to the index when performing indexing, search, update, and delete operations against the documents in it.</span><br><span class="line">  In a single cluster, you can define as many indexes as you want.</span><br><span class="line"></span><br><span class="line">5.type</span><br><span class="line">  Within an index, you can define one or more types.</span><br><span class="line">  A type is a logical category/partition of your index whose semantics is completely up to you.In general, a type is defined for documents that have a set of common fields.</span><br><span class="line">  For example, let’s assume you run a blogging platform and store all your data in a single index. In this index, you may define a type for user data, another type for blog data, and yet another type for comments data.</span><br><span class="line"></span><br><span class="line">6.document</span><br><span class="line">  A document is a basic unit of information that can be indexed.</span><br><span class="line">   For example, you can have a document for a single customer, another document for a single product, and yet another for a single order.</span><br><span class="line">   This document is expressed in JSON (JavaScript Object Notation) which is an ubiquitous internet data interchange format.</span><br><span class="line"></span><br><span class="line">   Within an index/type, you can store as many documents as you want.</span><br><span class="line"></span><br><span class="line">   Note that although a document physically resides in an index, a document actually must be indexed/assigned to a type inside an index.</span><br><span class="line"></span><br><span class="line">7.shards &amp; replicas</span><br><span class="line">  An index can potentially store a large amount of data that can exceed the hardware limits of a single node.</span><br><span class="line">  For example, a single index of a billion documents taking up 1TB of disk space may not fit on the disk of a single node or may be too slow to serve search requests from a single node alone.</span><br><span class="line"></span><br><span class="line">  To solve this problem, Elasticsearch provides the ability to subdivide your index into multiple pieces called shards.</span><br><span class="line">  When you create an index, you can simply define the number of shards that you want. Each shard is in itself a fully-functional and independent &quot;index&quot; that can be hosted on any node in the cluster.</span><br><span class="line"></span><br><span class="line">  Sharding is important for two primary reasons:</span><br><span class="line">    1.It allows you to horizontally split/scale your content volume</span><br><span class="line">    2.It allows you to distribute and parallelize operations across shards (potentially on multiple nodes) thus increasing performance/throughput</span><br><span class="line"></span><br><span class="line">  In a network/cloud environment where failures can be expected anytime, it is very useful and highly recommended to have a failover mechanism in case a shard/node somehow goes offline or disappears for whatever reason.</span><br><span class="line">  To this end, Elasticsearch allows you to make one or more copies of your index’s shards into what are called replica shards, or replicas for short.</span><br><span class="line"></span><br><span class="line">  Replication is important for two primary reasons:</span><br><span class="line">    1.It provides high availability in case a shard/node fails. For this reason, it is important to note that a replica shard is never allocated on the same node as the original/primary shard that it was copied from.</span><br><span class="line">    2.It allows you to scale out your search volume/throughput since searches can be executed on all replicas in parallel.</span><br><span class="line"></span><br><span class="line">  To summarize, each index can be split into multiple shards.</span><br><span class="line">  An index can also be replicated zero (meaning no replicas) or more times.</span><br><span class="line">  Once replicated, each index will have primary shards (the original shards that were replicated from) and replica shards (the copies of the primary shards).</span><br><span class="line">  The number of shards and replicas can be defined per index at the time the index is created.</span><br><span class="line">  After the index is created, you may change the number of replicas dynamically anytime but you cannot change the number shards after-the-fact.</span><br><span class="line">  当你创建完index后,可以动态添加shard的replica,但不能对shard进行动态修改</span><br><span class="line"></span><br><span class="line">  By default, each index in Elasticsearch is allocated 5 primary shards and 1 replica which means that if you have at least two nodes in your cluster, your index will have 5 primary shards and another 5 replica shards (1 complete replica) for a total of 10 shards per index.</span><br><span class="line"></span><br><span class="line">  Note:</span><br><span class="line">    Each Elasticsearch shard is a Lucene index.</span><br><span class="line">    There is a maximum number of documents you can have in a single Lucene index.</span><br><span class="line">    As of LUCENE-5843, the limit is 2,147,483,519 (= Integer.MAX_VALUE - 128) documents. You can monitor shard sizes using the &quot;_cat/shards&quot; api.</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/elasticsearch-core-component/" data-id="cjavy9jv900200coqvcvo21ml" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-kafka-with-zookeeper" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/kafka-with-zookeeper/" class="article-date">
  <time datetime="2017-03-20T07:54:32.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/kafka/">kafka</a>►<a class="article-category-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/kafka-with-zookeeper/">kafka with zookeeper</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="kafka-与-zookeeper-的关系"><a href="#kafka-与-zookeeper-的关系" class="headerlink" title="kafka 与 zookeeper 的关系"></a>kafka 与 zookeeper 的关系</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kafka对消息保存时根据Topic进行归类,发送消息者成为Producer,消息接受者成为Consumer,此外kafka集群有多个kafka实例组成,每个实例(server)成为broker.无论是kafka集群,还是producer和consumer都依赖于zookeeper来保证系统可用性集群保存一些meta信息.</span><br><span class="line"></span><br><span class="line">一个Kafka集群通常包括多个代理.为了均衡负载,将话题分成多个分区,每个代理存储一或多个分区.多个生产者和消费者能够同时生产和获取消息.</span><br><span class="line"></span><br><span class="line">一个Topic可以认为是一类消息,每个topic将被分成多个partition(区),每个partition在存储层面是append log文件.任何发布到此partition的消息都会被直接追加到log文件的尾部,每条消息在文件中的位置称为offset(偏移量),offset为一个long型数字,它是唯一标记一条消息.kafka并没有提供其他额外的索引机制来存储offset,因为在kafka中几乎不允许对消息进行&quot;随机读写&quot;</span><br><span class="line"></span><br><span class="line">kafka和JMS(Java Message Service)实现(activeMQ)不同的是: 即使消息被消费,消息仍然不会被立即删除.日志文件将会根据broker中的配置要求,保留一定的时间之后删除;比如log文件保留2天,那么两天后,文件会被清除,无论其中的消息是否被消费.kafka通过这种简单的手段,来释放磁盘空间,以及减少消息消费之后对文件内容改动的磁盘IO开支.</span><br><span class="line"></span><br><span class="line">对于consumer而言,它需要保存消费消息的offset,对于offset的保存和使用,有consumer来控制;当consumer正常消费消息时,offset将会&quot;线性&quot;的向前驱动,即消息将依次顺序被消费.事实上consumer可以使用任意顺序消费消息,它只需要将offset重置为任意值.(offset将会保存在zookeeper中)</span><br><span class="line"></span><br><span class="line">kafka集群几乎不需要维护任何consumer和producer状态信息,这些信息有zookeeper保存;因此producer和consumer的客户端实现非常轻量级,它们可以随意离开,而不会对集群造成额外的影响.</span><br><span class="line"></span><br><span class="line">partitions的设计目的有多个.最根本原因是kafka基于文件存储.通过分区,可以将日志内容分散到多个server上,来避免文件尺寸达到单机磁盘的上限,每个partiton都会被当前server(kafka实例)保存;可以将一个topic切分多任意多个partitions,来消息保存/消费的效率.此外越多的partitions意味着可以容纳更多的consumer,有效提升并发消费的能力.</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">一个Topic的多个partitions,被分布在kafka集群中的多个server上;每个server(kafka实例)负责partitions中消息的读写操作;此外kafka还可以配置partitions需要备份的个数(replicas),每个partition将会被备份到多台机器上,以提高可用性.</span><br><span class="line"></span><br><span class="line">基于replicated方案,那么就意味着需要对多个备份进行调度;每个partition都有一个server为&quot;leader&quot;;leader负责所有的读写操作,如果leader失效,那么将会有其他follower来接管(成为新的leader);follower只是单调的和leader跟进,同步消息即可..由此可见作为leader的server承载了全部的请求压力,因此从集群的整体考虑,有多少个partitions就意味着有多少个&quot;leader&quot;,kafka会将&quot;leader&quot;均衡的分散在每个实例上,来确保整体的性能稳定.</span><br><span class="line"></span><br><span class="line">Producer将消息发布到指定的Topic中,同时Producer也能决定将此消息归属于哪个partition;比如基于&quot;round-robin&quot;方式或者通过其他的一些算法等.本质上kafka只支持Topic.每个consumer属于一个consumer group;反过来说,每个group中可以有多个consumer.发送到Topic的消息,只会被订阅此Topic的每个group中的一个consumer消费.</span><br><span class="line"></span><br><span class="line">如果所有的consumer都具有相同的group,这种情况和queue模式很像;消息将会在consumers之间负载均衡.</span><br><span class="line">如果所有的consumer都具有不同的group,那这就是&quot;发布-订阅&quot;;消息将会广播给所有的消费者.</span><br><span class="line"></span><br><span class="line">在kafka中,一个partition中的消息只会被group中的一个consumer消费;每个group中consumer消息消费互相独立;我们可以认为一个group是一个&quot;订阅&quot;者,一个Topic中的每个partions,只会被一个&quot;订阅者&quot;中的一个consumer消费,不过一个consumer可以消费多个partitions中的消息.kafka只能保证一个partition中的消息被某个consumer消费时,消息是顺序的.事实上,从Topic角度来说,消息仍不是有序的.</span><br><span class="line"></span><br><span class="line">kafka的设计原理决定,对于一个topic,同一个group中不能有多于partitions个数的consumer同时消费,否则将意味着某些consumer将无法得到消息.</span><br><span class="line"></span><br><span class="line">Guarantees</span><br><span class="line">1) 发送到partitions中的消息将会按照它接收的顺序追加到日志中</span><br><span class="line">2) 对于消费者而言,它们消费消息的顺序和日志中消息顺序一致.</span><br><span class="line">3) 如果Topic的&quot;replicationfactor&quot;为N,那么允许N-1个kafka实例失效.</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/kafka-with-zookeeper/" data-id="cjavy9jys00510coqj0busoao" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-流量带宽" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/流量带宽/" class="article-date">
  <time datetime="2017-03-20T04:37:48.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/other/">other</a>►<a class="article-category-link" href="/categories/other/网络带宽/">网络带宽</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/流量带宽/">流量带宽</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">1Mbps=1024Kbps=1024/8KBps=128KB/s</span><br><span class="line">我们拉宽带1M,下载速度才100多KBps(KB/s)等宽带速率大小字样</span><br><span class="line"></span><br><span class="line">兆比特(Mbps)</span><br><span class="line">时间内传输数据的平均比特数,其单位是比特每秒(bps),或千比特每秒(Kbps),或兆比特每秒(Mbps),其换算关系为：1Kbps=1024bps,1Mbps=1024*1024bps(有时为了计算简单记作1Kbps=1000bps,1Mbps=1000000bps)</span><br><span class="line"></span><br><span class="line">数据传输 速率反映了终端设备之间的信息处理能力,它是一段时间的平均值</span><br><span class="line">所以1Mbps(1兆比特每秒)=0.125M Byte/s(0.125兆字节每秒)=0.125M Byte/s*1024=128KB/s(128千字节每秒)即1Mbps(兆位每秒)=1/8 MB/s(八分之一兆字节每秒)</span><br><span class="line">说明：</span><br><span class="line">1B = 8b</span><br><span class="line">两边同时扩大1024*1024倍，等式恒成立,即：</span><br><span class="line">1 MB = 8 Mb</span><br><span class="line">继而得出上面的公式，每秒传送1Mb，即：每秒传送了1/8MB = 0.125MB，即：</span><br><span class="line">1Mbps = 0.125 M Byte/s = 1/8M Byte/s * 1024 = 128 KB/s</span><br><span class="line"></span><br><span class="line">总结：</span><br><span class="line">在计算机网络或者是网络运营商中,一般宽带速率的单位用bps(或b/s)表示；bps表示比特每秒即表示每秒钟传输多少位信息,是bit per second的缩写.在实际所说的1M带宽的意思是1Mbps(是兆比特每秒(Mbps),不是兆字节每秒(MBps))</span><br><span class="line"></span><br><span class="line">20Mbps = 20 * 1024 = 20480 Kbps</span><br><span class="line">1Mbps = 1024Kbps</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/流量带宽/" data-id="cjavy9k9600ci0coqenhyqby5" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-RabbitMQ-cluster" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/03/20/RabbitMQ-cluster/" class="article-date">
  <time datetime="2017-03-20T04:33:52.000Z" itemprop="datePublished">2017-03-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/hadoop/">hadoop</a>►<a class="article-category-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a>►<a class="article-category-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/03/20/RabbitMQ-cluster/">RabbitMQ cluster</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="RabbitMQ-集群"><a href="#RabbitMQ-集群" class="headerlink" title="RabbitMQ 集群"></a>RabbitMQ 集群</h3><ol>
<li><p>RabbitMQ始终会记录以下四种内部元数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* 队列元数据(队列名称和它们的属性)</span><br><span class="line">* 交换器元数据(交换器名称,类型和属性)</span><br><span class="line">* 绑定元数据(一张简单的表格展示了如何将消息路由到队列)</span><br><span class="line">* vhost元数据(为vhost内部队列,交换器和绑定提供命名空间和安全属性)</span><br><span class="line">*注意:</span><br><span class="line">单一节点,RabbitMQ会将所有信息存储在内存,同时将那些标记为可持久化的队列和交换器存储到硬盘上</span><br><span class="line">引入集群,RabbitMQ需要追踪新的元数据类型:集群节点位置,以及节点与已记录的其他类型元数据的关系;集群也提供了选择,将元数据存储到磁盘或者内存中*</span><br></pre></td></tr></table></figure>
</li>
<li><p>集群中的队列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">将两个节点组成集群,如果创建队列,集群只会在单个节点而不是所有节点上创建完整的队列信息(元数据,状态,内容),只有队列的所有者知道有关队列的所有信息</span><br><span class="line">所有其他非所有者节点只知道队列的元数据和指向该队列存在的那个节点的指针.因此,当集群节点崩溃时,该节点的队列和关联绑定都消失了.</span><br><span class="line">*注意: 只有队列在最开始没有被设置可持久化时,集群节点崩溃才可以让消费者重连并重新创建队列;如果队列开始已经设置为可持久化,客户端重新声明会得到404错误,这样确保了当失败节点恢复后加入集群,该节点上的队列不会丢失.想要指定队列重回集群的唯一方法是恢复故障节点.*</span><br><span class="line"></span><br><span class="line">为什么默认情况下RabbitMQ不将队列内容和状态复制到所有节点:</span><br><span class="line">* 存储空间  如果每个集群节点都拥有所有队列的完全拷贝,那么新计入了节点不会给你带来更多存储空间</span><br><span class="line">* 性能  消息的发布需要将消息复制到每一个集群节点,对持久化消息来说,每一条消息都会触发磁盘IO.每次新节点添加,网络和磁盘负载都会增加</span><br><span class="line"></span><br><span class="line">通过设置集群中唯一节点来负责任何特定队列,只有该负责节点才会因队列消息而消耗磁盘IO.所有其他节点需要将接收到该队列的请求转发给该队列的所有者节点.因此,增加Rabbit集群节点意味着你将拥有更多的节点传播队列,这些新节点为你带来了性能提升</span><br></pre></td></tr></table></figure>
</li>
<li><p>分布交换器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">交换器不同队列那样拥有自己的进程,交换器说到底只是一个名称和一个队列绑定列表</span><br><span class="line">当你将消息发布到交换器时,实际上是由你所连接到的信道将消息上的路由键同交换器的绑定列表进行比较,然后路由信息.正是信道按照绑定的匹配结果,将消息路由到队列</span><br><span class="line">理解信道是真正的路由器这一点很重要,这解释了为什么交换器不会像集群中的队列那样受到相同的限制</span><br><span class="line">由于交换器只不过是一张查询表,而非实际上的消息路由器,因此将交换器在整个集群中进行复制会更加简单.</span><br></pre></td></tr></table></figure>
</li>
<li><p>是内存节点，还是磁盘节点</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">每个RabbitMQ节点,不管是单一节点还是集群中的一部分,要么是内存节点,要么是磁盘节点</span><br><span class="line">* 内存节点将所有的队列,交换器,绑定,用户,权限和vhost的元数据定义都仅存储在内存中</span><br><span class="line">* 磁盘节点则将元数据存储在磁盘</span><br><span class="line">*注意:单节点只允许磁盘类型节点,否则你每次重启RabbitMQ,所有关于系统的配置信息都会丢失*</span><br><span class="line">在集群中,你可以选择配置部分节点为内存节点,因为它使得向队列和交换器声明之类的操作更加快速</span><br><span class="line">*注意: 当在集群中声明队列,交换器或绑定时,这些操作直到所有集群节点都成功提交元数据变更后才返回。对内存节点来说,将变更写入内存;对磁盘节点来说,将变更写入磁盘,直到完成之后*</span><br><span class="line"></span><br><span class="line">RabbitMQ只要求在集群中至少有一个磁盘节点,所有其他节点都可以是内存节点.当节点加入和离开集群时,它们必须将该变更通知到至少一个磁盘节点</span><br><span class="line">如果集群只有一个磁盘节点,正好它又崩溃了,那么集群还可以路由消息,但不能操作:创建队列,创建交换器,创建绑定,添加用户,更改权限,添加或删除集群节点</span><br><span class="line">解决方法: 建议在集群中设置两台磁盘节点</span><br><span class="line">*注意: 只有一个需要所有的磁盘节点必须在线的操作是添加或者删除集群节点*</span><br><span class="line"></span><br><span class="line">当重启内存节点后,它们会连接到预先配置的磁盘节点,下载当前集群元数据拷贝.如果你只讲两个磁盘节点中的一个高速了内存节点,不凑巧这个磁盘节点崩溃了,内存节点重启后就无法找到集群了.所以添加内存节点时,确保告知其所有的磁盘节点.只要内存节点可以找到至少一个磁盘节点,那么它就能在重启后重新加入集群</span><br></pre></td></tr></table></figure>
</li>
<li><p>建立集群</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">集群一: 单台集群启动三个Rabbit服务</span><br><span class="line">1. 启动三个Rabbit服务</span><br><span class="line">   RABBITMQ_NODE_PORT=5671 RABBITMQ_NODENAME=rabbit_1 rabbitmq-server -detached</span><br><span class="line">   RABBITMQ_NODE_PORT=5672 RABBITMQ_NODENAME=rabbit_2 rabbitmq-server -detached</span><br><span class="line">   RABBITMQ_NODE_PORT=5673 RABBITMQ_NODENAME=rabbit_3 rabbitmq-server -detached</span><br><span class="line">2. 停止第二个节点上的RabbitMQ程序</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost stop_app</span><br><span class="line">3. 重新设置第二个节点的元数据和状态为清空状态</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost reset</span><br><span class="line">4. 将第二个节点加入到第一个集群节点</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost cluster rabbit_1@localhost rabbit_2@localhost</span><br><span class="line">   * -n rabbit_2@localhost 表示你想在指定的节点上执行命令</span><br><span class="line">   * cluster rabbit_1@localhost rabbit_2@localhost  表示rabbit_1和将要加入的rabbit_2都是磁盘节点</span><br><span class="line">5. 重新启动第二个节点</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost start_app</span><br><span class="line">6. 将第三个节点加入到集群</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost stop_app</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost reset</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost cluster rabbit_1@localhost rabbit_2@localhost</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost start_app</span><br><span class="line">   *注意: 将第三个节点加入到集群时,cluster后面并没有包含rabbit_3,表示为rabbit_3指定了两个磁盘节点rabbit_2和rabbit_1,rabbit_3将会成为内存节点*</span><br><span class="line">7. 查看集群状态</span><br><span class="line">   rabbitmqctl cluster_status</span><br><span class="line">   查看nodes部分:</span><br><span class="line">   * disc 表示磁盘节点信息</span><br><span class="line">   * ram  表示内存节点信息</span><br><span class="line">   * running_nodes 告诉你集群中的哪些节点正在运行</span><br><span class="line">8. 连接到RabbitMQ</span><br><span class="line">   你可以连接到Running_nodes中任何一个节点,开始创建队列,发布消息,或者执行其他AMQP命令</span><br><span class="line"></span><br><span class="line">集群二: 将节点分布到更多机器上(三台机器为例)</span><br><span class="line">1. 在三台机器上启动RabbitMQ</span><br><span class="line">   RABBITMQ_NODE_PORT=5671 RABBITMQ_NODENAME=rabbit_1 rabbitmq-server -detached</span><br><span class="line">   RABBITMQ_NODE_PORT=5672 RABBITMQ_NODENAME=rabbit_2 rabbitmq-server -detached</span><br><span class="line">   RABBITMQ_NODE_PORT=5673 RABBITMQ_NODENAME=rabbit_3 rabbitmq-server -detached</span><br><span class="line">2. 将其中一台的RabbitMQ的Erlang cookie复制到其他几个节点</span><br><span class="line">   /var/lib/rabbitmq/.erlang.cookie</span><br><span class="line">   复制cookie内的字符串,并粘贴到其他两个节点的/var/lib/rabbitmq/.erlang.cookie中</span><br><span class="line">   重启其他另外两个节点</span><br><span class="line">   rabbitmqctl stop</span><br><span class="line">   rabbitmqctl start      </span><br><span class="line">3. 停止第二个节点上的RabbitMQ程序</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost stop_app</span><br><span class="line">4. 重新设置第二个节点的元数据和状态为清空状态</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost reset</span><br><span class="line">5. 将第二个节点加入到第一个集群节点</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost cluster rabbit_1@localhost rabbit_2@localhost</span><br><span class="line">   * -n rabbit_2@localhost 表示你想在指定的节点上执行命令</span><br><span class="line">   * cluster rabbit_1@localhost rabbit_2@localhost  表示rabbit_1和将要加入的rabbit_2都是磁盘节点</span><br><span class="line">6. 重新启动第二个节点</span><br><span class="line">   rabbitmqctl -n rabbit_2@localhost start_app</span><br><span class="line">7. 将第三个节点加入到集群</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost stop_app</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost reset</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost cluster rabbit_1@localhost rabbit_2@localhost</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost start_app</span><br><span class="line">   *注意: 将第三个节点加入到集群时,cluster后面并没有包含rabbit_3,表示为rabbit_3指定了两个磁盘节点rabbit_2和rabbit_1,rabbit_3将会成为内存节点*</span><br><span class="line">8. 查看集群状态</span><br><span class="line">   rabbitmqctl cluster_status</span><br><span class="line">   查看nodes部分:</span><br><span class="line">   * disc 表示磁盘节点信息</span><br><span class="line">   * ram  表示内存节点信息</span><br><span class="line">   * running_nodes 告诉你集群中的哪些节点正在运行</span><br><span class="line">9. 连接到RabbitMQ</span><br><span class="line">   你可以连接到Running_nodes中任何一个节点,开始创建队列,发布消息,或者执行其他AMQP命令</span><br><span class="line"></span><br><span class="line">集群三:将节点从集群中移除</span><br><span class="line">1. 找到你需要停止的集群节点</span><br><span class="line">2. 移除</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost stop_app</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost reset    </span><br><span class="line">3. 验证</span><br><span class="line">   方法一: 启动移除的节点  </span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost start_app</span><br><span class="line">   rabbitmqctl -n rabbit_3@localhost cluster_status</span><br><span class="line">   方法二: 查看已有集群的状态</span><br><span class="line">   rabbitmqctl -n rabbit_1@localhost cluster_status</span><br></pre></td></tr></table></figure>
</li>
<li><p>升级版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在独立的系统中升级新版本RabbitMQ比较容易: 解压新版本,然后停服,替换新版本,启动服务.</span><br><span class="line"></span><br><span class="line">集群升级版本是半自动化的,不能简单的将新版本在集群节点上解压并重启服务:</span><br><span class="line">1. 通过RabbitMQ Management 插件备份当前配置</span><br><span class="line">2. 关闭所有生产者并等待消费者消费完队列中的所有消息</span><br><span class="line">3. 关闭节点,并解压新版本RabbitMQ到安装目录</span><br><span class="line">4. 选择其中一个磁盘节点作为升级节点,当启动时,该节点会将持久化的集群数据升级到新版本</span><br><span class="line">5. 然后启动其他集群的磁盘节点,它们会获取升级后的集群数据</span><br><span class="line">6. 最后启动集群的内存节点</span><br></pre></td></tr></table></figure>
</li>
<li><p>镜像队列和保留消息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">RabbitMQ集群默认情况下队列只存活于集群中的一个节点上.在RabbitMQ 2.6.0版本之后,Rabbit增加了内建的双活冗余选项: 镜像队列</span><br><span class="line">镜像队列: 像普通队列一样,镜像队列的主拷贝仅存在于一个节点上,但与普通队列不同的是,镜像节点在集群中的其他节点上拥有从队列拷贝.一旦队列的主节点不可用,最老的从队列将被选举为新的主队列</span><br><span class="line"></span><br><span class="line">例如：</span><br><span class="line">queue_args = &#123;&quot;x-ha-policy&quot;:&quot;all&quot;&#125;</span><br><span class="line">channel.queue_declare(queue=&quot;hello-queue&quot;,arguments=queue_args)</span><br><span class="line"></span><br><span class="line">由于队列的镜像性质是由应用程序在允许时指定的,RabbitMQ团队决定你可以同样的方式在允许时指定队列需要镜像到哪些节点.</span><br><span class="line">指定将镜像放在哪个节点:</span><br><span class="line">queue_args = &#123;&quot;x-ha-policy&quot;:&quot;nodes&quot;,&quot;x-ha-policy-params&quot;:[&quot;rabbit@localhost&quot;]&#125;</span><br><span class="line">channel.queue_declare(queue=&quot;hello-queue&quot;,arguments=queue_args)</span><br><span class="line"></span><br><span class="line">*注意: 新增的从拷贝只会包含那些其添加进来之后从镜像队列发来的消息.RabbitMQ不会将镜像队列现已经存在的内容与新添加的从拷贝进行同步. 新增的从拷贝最终会和现存的队列拷贝拥有相同的状态.*</span><br></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="RabbitMQ从故障中恢复"><a href="#RabbitMQ从故障中恢复" class="headerlink" title="RabbitMQ从故障中恢复"></a>RabbitMQ从故障中恢复</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.架构的规划</span><br><span class="line">  haproxy</span><br><span class="line">  RabbitMQ集群</span><br><span class="line">2.业务代码的调整</span><br><span class="line">  错误检测和重新链接</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/03/20/RabbitMQ-cluster/" data-id="cjavy9jtk000j0coqe6nw5l1h" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/17/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="page-number" href="/page/17/">17</a><span class="page-number current">18</span><a class="page-number" href="/page/19/">19</a><a class="page-number" href="/page/20/">20</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/19/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
          <li>
            <a href="/2017/11/27/svn-auto-update/">svn auto update</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-event-reactor/">salt manage event reactor</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-job/">salt manage job</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>