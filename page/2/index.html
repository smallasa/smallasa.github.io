<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>smallasa</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="smallasa">
<meta property="og:url" content="http://www.smallasa.com/page/2/index.html">
<meta property="og:site_name" content="smallasa">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smallasa">
  
    <link rel="alternate" href="/atom.xml" title="smallasa" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">smallasa</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">I known what i do !</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://www.smallasa.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-salt-manage-target" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/14/salt-manage-target/" class="article-date">
  <time datetime="2017-11-14T08:15:34.000Z" itemprop="datePublished">2017-11-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/automation/">automation</a>►<a class="article-category-link" href="/categories/automation/salt/">salt</a>►<a class="article-category-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/14/salt-manage-target/">salt manage target</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="salt-管理对象"><a href="#salt-管理对象" class="headerlink" title="salt 管理对象"></a>salt 管理对象</h3><ol>
<li>管理对象方法<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">1.正则匹配</span><br><span class="line">  salt -E <span class="string">'min*'</span> test.ping</span><br><span class="line"></span><br><span class="line">2.列表匹配</span><br><span class="line">  salt -L minion1,minion2 test.ping</span><br><span class="line"></span><br><span class="line">3.Grians匹配(Minion的Grains的键值对)</span><br><span class="line">  salt -G <span class="string">'os:centos'</span> test.ping</span><br><span class="line"></span><br><span class="line">4.组匹配(groups是在master配置文件中定义的组名称)</span><br><span class="line">  salt -N groups test.ping</span><br><span class="line"></span><br><span class="line">5.复合匹配</span><br><span class="line">  salt -C <span class="string">'G@os:centos or L@Minion1'</span></span><br><span class="line"></span><br><span class="line">6.Pillar值匹配(key:value是Pillar系统中定义的一组键值,类似Grians键值对)</span><br><span class="line">  salt -I <span class="string">'key:value'</span> test.ping</span><br><span class="line"></span><br><span class="line">7.CIDR匹配</span><br><span class="line">  salt -S <span class="string">'192.168.1.0/24'</span> test.ping</span><br><span class="line"></span><br><span class="line">8.Target参数</span><br><span class="line">  L =&gt; L@minion1,minion2</span><br><span class="line">  G =&gt; G@os:centos</span><br><span class="line">  E =&gt; E@minion[1-3]</span><br><span class="line">  P =&gt; P@os:(centos|redhat|ubuntu)</span><br><span class="line">  I =&gt; I@key:value</span><br><span class="line">  S =&gt; S@10.10.1.0/24 or S@10.10.2.10</span><br><span class="line">  R =&gt; R@%foo.bar</span><br><span class="line">  C =&gt; G@os:centos or L@minion1,minon3</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/14/salt-manage-target/" data-id="cjavy9k6r00ad0coqvbi72a78" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mongo-replication-auth-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/13/mongo-replication-auth-install/" class="article-date">
  <time datetime="2017-11-13T09:21:03.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Mongo/">Mongo</a>►<a class="article-category-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/mongo-replication-auth-install/">mongo replication auth install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="mongo-replication-auth-install"><a href="#mongo-replication-auth-install" class="headerlink" title="mongo replication auth install"></a>mongo replication auth install</h3><ol>
<li><p>创建用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># useradd -s /sbin/nologin mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解压和安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># tar xzf mongodb-linux-x86_64-rhel70-3.4.10.tgz</span></span><br><span class="line">[root@mongodb app]<span class="comment"># mv mongodb-linux-x86_64-rhel70-3.4.10 /mnt/app/mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt;/etc/profile.d/mongo.sh &lt;&lt;EOF</span></span><br><span class="line"><span class="built_in">export</span> MONGO_HOME=/mnt/app/mongo</span><br><span class="line"><span class="built_in">export</span> PATH=\<span class="variable">$&#123;MONGO_HOME&#125;</span>/bin:\<span class="variable">$PATH</span></span><br><span class="line">EOF</span><br><span class="line">[root@mongodb app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo配置文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/app/mongo/conf</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo存放keyfile目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/app/mongo/key</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/key</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo数据文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/data/mongo/&#123;27017,27018,27019&#125;</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/data/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo日志目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/log/mongo/&#123;27017,27018,27019&#125;</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/log/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>生成mongo.key</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">生成mongo.key加密文件(注意:mongo.key里面密码的长度不能超过1024),并将mongo.key拷贝到副本集中其它几台机器上</span><br><span class="line"></span><br><span class="line">[root@mongodb ~]<span class="comment"># openssl rand -base64 741 &gt; /mnt/app/mongo/key/mongo.key                         </span></span><br><span class="line">[root@mongodb ~]<span class="comment"># chmod 600 /mnt/app/mongo/key/mongo.key</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/key</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo配置文件(primary)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27017.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27017</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27017/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27017  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span></span><br><span class="line">objcheck=<span class="literal">true</span></span><br><span class="line">rest=<span class="literal">false</span></span><br><span class="line"><span class="comment">#auth=true  </span></span><br><span class="line"></span><br><span class="line">journal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line"></span><br><span class="line">keyFile=/mnt/app/mongo/key/mongo.key</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo systemd文件(primary)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27017.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27017.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27017.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27017</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable mongo-27017</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集初始化(primary)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo --port 27017</span></span><br><span class="line">&gt; config=&#123;_id: <span class="string">"dbset"</span>,version: 1,members: [&#123; _id: 0, host : <span class="string">"192.168.13.218:27017"</span> &#125;]&#125;</span><br><span class="line">&gt; rs.initiate(config)</span><br><span class="line">dbset:PRIMARY&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置用户权限(primary,(auth=false))</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dbset:PRIMARY&gt; use admin</span><br><span class="line">dbset:PRIMARY&gt; db.createUser(&#123;user: <span class="string">"root"</span>,<span class="built_in">pwd</span>:<span class="string">"root"</span>,roles:[&#123;role:<span class="string">"root"</span>,db:<span class="string">"admin"</span> &#125;]&#125;)</span><br><span class="line">dbset:PRIMARY&gt; db.auth(<span class="string">'root'</span>,<span class="string">'root'</span>)</span><br><span class="line">dbset:PRIMARY&gt; db.createUser(&#123;user: <span class="string">"admin"</span>,<span class="built_in">pwd</span>:<span class="string">"admin"</span>,roles:[&#123;role:<span class="string">"userAdminAnyDatabase"</span>,db:<span class="string">"admin"</span> &#125;]&#125;)</span><br><span class="line">dbset:PRIMARY&gt; <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">bye</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>重启mongo(primary,(auth=true))</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># vim /mnt/app/mongo/conf/mongo.27017.conf</span></span><br><span class="line"><span class="comment">#auth=true</span></span><br><span class="line">改为:</span><br><span class="line">auth=<span class="literal">true</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># systemctl status mongo-27017</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证(primary)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dbset:PRIMARY&gt; use admin</span><br><span class="line">dbset:PRIMARY&gt; db.auth(<span class="string">'root'</span>,<span class="string">'root'</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.status()</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">//secondary配置文件</span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27018.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27018</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27018/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27018  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span></span><br><span class="line">objcheck=<span class="literal">true</span></span><br><span class="line">rest=<span class="literal">false</span></span><br><span class="line">auth=<span class="literal">true</span>  </span><br><span class="line"></span><br><span class="line">journal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line"></span><br><span class="line">keyFile=/mnt/app/mongo/key/mongo.key</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">//arbiter配置文件</span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27019.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27019</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27019/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27019  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span></span><br><span class="line">objcheck=<span class="literal">true</span></span><br><span class="line">rest=<span class="literal">false</span></span><br><span class="line">auth=<span class="literal">true</span>  </span><br><span class="line"></span><br><span class="line">nojournal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line"></span><br><span class="line">keyFile=/mnt/app/mongo/key/mongo.key</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo systemd文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27018.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27018.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27018.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27019.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27019.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27019.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl daemon-reload</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27018</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27019</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable monog-27018</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable monog-27019</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集添加节点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo --port 27017</span></span><br><span class="line">dbset:PRIMARY&gt; use admin</span><br><span class="line">dbset:PRIMARY&gt; db.auth(<span class="string">'root'</span>,<span class="string">'root'</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.status()</span><br><span class="line"></span><br><span class="line">dbset:PRIMARY&gt; rs.add(<span class="string">"192.168.13.218:27018"</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.addArb(<span class="string">"192.168.13.218:27019"</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.status()</span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">dbset:PRIMARY&gt; rs.status()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="string">"set"</span> : <span class="string">"dbset"</span>,</span><br><span class="line">        <span class="string">"date"</span> : ISODate(<span class="string">"2017-11-13T09:12:44.740Z"</span>),</span><br><span class="line">        <span class="string">"myState"</span> : 1,</span><br><span class="line">        <span class="string">"term"</span> : NumberLong(1),</span><br><span class="line">        <span class="string">"heartbeatIntervalMillis"</span> : NumberLong(2000),</span><br><span class="line">        <span class="string">"optimes"</span> : &#123;</span><br><span class="line">                <span class="string">"lastCommittedOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">"appliedOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">"durableOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"members"</span> : [</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 0,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27017"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 1,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"PRIMARY"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 641,</span><br><span class="line">                        <span class="string">"optime"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"electionTime"</span> : Timestamp(1510564115, 2),</span><br><span class="line">                        <span class="string">"electionDate"</span> : ISODate(<span class="string">"2017-11-13T09:08:35Z"</span>),</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3,</span><br><span class="line">                        <span class="string">"self"</span> : <span class="literal">true</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 1,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27018"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 2,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"SECONDARY"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 122,</span><br><span class="line">                        <span class="string">"optime"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDurable"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"optimeDurableDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeat"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.815Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeatRecv"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.814Z"</span>),</span><br><span class="line">                        <span class="string">"pingMs"</span> : NumberLong(0),</span><br><span class="line">                        <span class="string">"syncingTo"</span> : <span class="string">"192.168.13.218:27017"</span>,</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 2,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27019"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 7,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"ARBITER"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 58,</span><br><span class="line">                        <span class="string">"lastHeartbeat"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.814Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeatRecv"</span> : ISODate(<span class="string">"2017-11-13T09:12:40.893Z"</span>),</span><br><span class="line">                        <span class="string">"pingMs"</span> : NumberLong(0),</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3</span><br><span class="line">                &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"ok"</span> : 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">//primary secondary切换</span><br><span class="line">dbset:PRIMARY&gt; rs.stepDown()</span><br><span class="line"></span><br><span class="line">//副本集中移除</span><br><span class="line">dbset:PRIMARY&gt; rs.remove(<span class="string">"192.168.13.218:27019"</span>)</span><br><span class="line"></span><br><span class="line">//副本集配置</span><br><span class="line">dbset:PRIMARY&gt; rs.conf()</span><br><span class="line"></span><br><span class="line">//查看副本同步状态</span><br><span class="line">dbset:PRIMARY&gt; db.printSlaveReplicationInfo();</span><br></pre></td></tr></table></figure>
</li>
<li><p>mongo内核优化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/enabled</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/defrag</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># systemctl stop mongo &amp;&amp; systemctl start mongo</span></span><br><span class="line"></span><br><span class="line">[root@mongodb ~]<span class="comment"># cat &gt;&gt;/etc/rc.local &lt;&lt;EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### mongodb close hugepage</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/enabled;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/defrag;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/13/mongo-replication-auth-install/" data-id="cjavy9k0800660coq8hex758u" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mongo-error" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/13/mongo-error/" class="article-date">
  <time datetime="2017-11-13T07:31:56.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Mongo/">Mongo</a>►<a class="article-category-link" href="/categories/database/Mongo/mongo-error/">mongo error</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/mongo-error/">mongo error</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="mongo-error"><a href="#mongo-error" class="headerlink" title="mongo error"></a>mongo error</h3><ol>
<li>mongo 推荐使用XFS文件系统<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">在Linux环境下,MongoDB推荐使用 XFS 文件系统,如果MongoDB数据存放的文件系统不是XFS,会出现如下提示:</span><br><span class="line">2017-04-17T13:37:40.045+0800 I STORAGE [initandlisten]</span><br><span class="line">2017-04-17T13:37:40.045+0800 I STORAGE [initandlisten] ** WARNING: Using the XF S filesystem is strongly recommended with the WiredTiger storage engine</span><br><span class="line">2017-04-17T13:37:40.045+0800 I STORAGE [initandlisten] ** See http://d ochub.mongodb.org/core/prodnotes-filesystem</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/13/mongo-error/" data-id="cjavy9k0300620coqbhs6qwz2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mongo-auth" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/13/mongo-auth/" class="article-date">
  <time datetime="2017-11-13T07:25:35.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Mongo/">Mongo</a>►<a class="article-category-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/mongo-auth/">mongo auth</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="mongo-auth"><a href="#mongo-auth" class="headerlink" title="mongo auth"></a>mongo auth</h3><ol>
<li><p>mongo 权限说明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">MongoDB数据库在默认是没有用户名及密码,不用安全验证的,只要连接上服务就可以进行CRUD操作.</span><br><span class="line"></span><br><span class="line">概念理解:</span><br><span class="line">1.用户概念</span><br><span class="line">  Mongodb的用户是由&quot;用户名+所属库名&quot;组成</span><br><span class="line">  注意:帐号是跟着库走的,所以在指定库里授权,必须也在指定库里验证(auth)</span><br><span class="line">  例如:</span><br><span class="line">  登录mongo库test1,创建用户user,创建的用户为:user@test1</span><br><span class="line">  登录mongo库test2,创建用户user,创建的用户为:user@test2</span><br><span class="line"></span><br><span class="line">2.角色概念</span><br><span class="line">  Mongodb的授权采用了角色授权的方法,每个角色包括一组权限</span><br><span class="line">  Mongodb已经定义好了的角色叫内建角色,我们也可以自定义角色</span><br><span class="line"></span><br><span class="line">  内建角色:</span><br><span class="line">  * 数据库用户角色: read readWrite</span><br><span class="line">  * 数据库管理角色: dbAdmin dbOwner userAdmin</span><br><span class="line">  * 集群管理角色: clusterAdmin clusterManager clusterMonitor hostManager</span><br><span class="line">  * 备份恢复角色: backup restore</span><br><span class="line">  * 所有数据库角色: readAnyDatabase readWriteAnyDatabase userAdminAnyDatabase dbAdminAnyDatabase</span><br><span class="line">  * 超级用户角色: root  </span><br><span class="line">  * 内部角色: __system</span><br><span class="line"></span><br><span class="line">  角色权限说明:</span><br><span class="line">  * Read 允许用户读取指定数据库</span><br><span class="line">  * readWrite 允许用户读写指定数据库</span><br><span class="line">  * dbAdmin 允许用户在指定数据库中执行管理函数,如索引创建,删除,查看统计或访问system.profile</span><br><span class="line">  * userAdmin 允许用户向system.users集合写入,可以找指定数据库里创建,删除和管理用户</span><br><span class="line">  * clusterAdmin 只在admin数据库中可用,赋予用户所有分片和复制集相关函数的管理权限</span><br><span class="line">  * readAnyDatabase 只在admin数据库中可用,赋予用户所有数据库的读权限</span><br><span class="line">  * readWriteAnyDatabase 只在admin数据库中可用,赋予用户所有数据库的读写权限</span><br><span class="line">  * userAdminAnyDatabase 只在admin数据库中可用,赋予用户所有数据库的userAdmin权限</span><br><span class="line">  * dbAdminAnyDatabase 只在admin数据库中可用,赋予用户所有数据库的dbAdmin权限</span><br><span class="line">  * root 只在admin数据库中可用.超级账号,超级权限</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建超级权限用户(auth=false)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo</span></span><br><span class="line">&gt; use admin</span><br><span class="line">&gt; db.createUser(</span><br><span class="line">   &#123;</span><br><span class="line">     user: <span class="string">"root"</span>,</span><br><span class="line">     <span class="built_in">pwd</span>: <span class="string">"root"</span>,</span><br><span class="line">     roles: [ &#123; role: <span class="string">"root"</span>, db: <span class="string">"admin"</span> &#125; ]</span><br><span class="line">   &#125;</span><br><span class="line"> )</span><br><span class="line">&gt; db.auth(<span class="string">'root'</span>,<span class="string">'root'</span>)</span><br><span class="line">&gt; db.createUser(</span><br><span class="line">   &#123;</span><br><span class="line">     user: <span class="string">"admin"</span>,</span><br><span class="line">     <span class="built_in">pwd</span>: <span class="string">"admin"</span>,</span><br><span class="line">     roles: [ &#123; role: <span class="string">"userAdminAnyDatabase"</span>, db: <span class="string">"admin"</span> &#125; ]</span><br><span class="line">   &#125;</span><br><span class="line"> )</span><br></pre></td></tr></table></figure>
</li>
<li><p>重启mongo(auth=true)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo</span></span><br><span class="line">&gt; use admin</span><br><span class="line">&gt; db.auth(<span class="string">"root"</span>, <span class="string">"rootroot"</span> )</span><br><span class="line">1</span><br><span class="line">&gt; show dbs</span><br><span class="line">admin  0.000GB</span><br><span class="line"><span class="built_in">local</span>  0.000GB</span><br><span class="line">&gt; <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">bye</span></span><br><span class="line"></span><br><span class="line">或者:</span><br><span class="line">[root@mongodb ~]<span class="comment"># mongo --port 27017 -u "root" -p "rootroot" --authenticationDatabase "admin"</span></span><br><span class="line">&gt; show dbs</span><br><span class="line">admin  0.000GB</span><br><span class="line"><span class="built_in">local</span>  0.000GB</span><br><span class="line">&gt; <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">bye</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>用户授权过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">//创建用户并授权</span><br><span class="line">创建用户条件: 首先选择在哪个数据库下进行创建;其次创建用户有三项需要提供:用户名,密码,角色列表</span><br><span class="line"></span><br><span class="line">1.先切换到超级权限用户</span><br><span class="line">&gt; use admin</span><br><span class="line">&gt; db.auth(<span class="string">'root'</span>,<span class="string">'rootroot'</span>)</span><br><span class="line"></span><br><span class="line">2.创建用户</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.createUser(&#123;user:<span class="string">"test1"</span>,<span class="built_in">pwd</span>:<span class="string">"test2"</span>,roles:[&#123;role:<span class="string">"readWrite"</span>,db:<span class="string">"penn"</span>&#125;,&#123;role:<span class="string">"userAdmin"</span>,db:<span class="string">"penn"</span>&#125;]&#125;)</span><br><span class="line"></span><br><span class="line">3.查看用户</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; show users;</span><br><span class="line"></span><br><span class="line">4.修改密码</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.changeUserPassword(<span class="string">'test1'</span>,<span class="string">'test1'</span>);</span><br><span class="line"></span><br><span class="line">5.权限验证</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.auth(<span class="string">'test1'</span>,<span class="string">'test1'</span>)</span><br><span class="line">&gt; show tables;</span><br><span class="line"></span><br><span class="line">6.添加角色权限</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.grantRolesToUser(<span class="string">"test1"</span>,[&#123;role:<span class="string">"read"</span>,db:<span class="string">"admin"</span>&#125;])</span><br><span class="line"></span><br><span class="line">7.回收角色权限</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.revokeRolesFromUser(<span class="string">"test1"</span>,[&#123;role:<span class="string">"read"</span>,db:<span class="string">"admin"</span>&#125;])</span><br><span class="line"></span><br><span class="line">8.删除用户</span><br><span class="line">&gt; use penn</span><br><span class="line">&gt; db.dropUser(<span class="string">"test1"</span>)</span><br><span class="line"></span><br><span class="line">9.查看所有账号</span><br><span class="line">&gt; use admin</span><br><span class="line">&gt; db.auth(<span class="string">'root'</span>,<span class="string">'rootroot'</span>)</span><br><span class="line">&gt; db.system.users.find().pretty()</span><br><span class="line">&gt; db.system.users.find().count()</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/13/mongo-auth/" data-id="cjavy9k0400630coqg93bpv2k" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mongo-standard-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/13/mongo-standard-install/" class="article-date">
  <time datetime="2017-11-13T07:01:00.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Mongo/">Mongo</a>►<a class="article-category-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/mongo-standard-install/">mongo standard install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="mongo-standard-install"><a href="#mongo-standard-install" class="headerlink" title="mongo standard install"></a>mongo standard install</h3><ol>
<li><p>创建用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># useradd -s /sbin/nologin mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解压和安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># tar xzf mongodb-linux-x86_64-rhel70-3.4.10.tgz</span></span><br><span class="line">[root@mongodb app]<span class="comment"># mv mongodb-linux-x86_64-rhel70-3.4.10 /mnt/app/mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt;/etc/profile.d/mongo.sh &lt;&lt;EOF</span></span><br><span class="line"><span class="built_in">export</span> MONGO_HOME=/mnt/app/mongo</span><br><span class="line"><span class="built_in">export</span> PATH=\<span class="variable">$&#123;MONGO_HOME&#125;</span>/bin:\<span class="variable">$PATH</span></span><br><span class="line">EOF</span><br><span class="line">[root@mongodb app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo配置文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/app/mongo/conf</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo数据文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/data/mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/data/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo日志目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/log/mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/log/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27017  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span>  </span><br><span class="line"><span class="comment">#auth=true  </span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo systemd文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl daemon-reload</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动mongo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo</span></span><br><span class="line">MongoDB shell version v3.4.10</span><br><span class="line">connecting to: mongodb://127.0.0.1:27017</span><br><span class="line">MongoDB server version: 3.4.10</span><br><span class="line">Server has startup warnings:</span><br><span class="line">2017-11-13T15:13:35.914+0800 I CONTROL  [initandlisten]</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] ** WARNING: Access control is not enabled <span class="keyword">for</span> the database.</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] **          Read and write access to data and configuration is unrestricted.</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten]</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten]</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/enabled is <span class="string">'always'</span>.</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] **        We suggest setting it to <span class="string">'never'</span></span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten]</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] ** WARNING: /sys/kernel/mm/transparent_hugepage/defrag is <span class="string">'always'</span>.</span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten] **        We suggest setting it to <span class="string">'never'</span></span><br><span class="line">2017-11-13T15:13:35.915+0800 I CONTROL  [initandlisten]</span><br><span class="line">&gt; show dbs</span><br><span class="line">admin  0.000GB</span><br><span class="line"><span class="built_in">local</span>  0.000GB</span><br><span class="line">&gt; <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">bye</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>mongo内核优化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/enabled</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/defrag</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># systemctl stop mongo &amp;&amp; systemctl start mongo</span></span><br><span class="line"></span><br><span class="line">[root@mongodb ~]<span class="comment"># cat &gt;&gt;/etc/rc.local &lt;&lt;EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### mongodb close hugepage</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/enabled;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/defrag;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/13/mongo-standard-install/" data-id="cjavy9k0c00690coqf33oybuv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-mongo-replication-standard-install" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/11/13/mongo-replication-standard-install/" class="article-date">
  <time datetime="2017-11-13T06:32:34.000Z" itemprop="datePublished">2017-11-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/database/">database</a>►<a class="article-category-link" href="/categories/database/Mongo/">Mongo</a>►<a class="article-category-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/11/13/mongo-replication-standard-install/">mongo replication standard install</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="mongo-replication-standard-install"><a href="#mongo-replication-standard-install" class="headerlink" title="mongo replication standard install"></a>mongo replication standard install</h3><ol>
<li><p>创建用户</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># useradd -s /sbin/nologin mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>解压和安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># tar xzf mongodb-linux-x86_64-rhel70-3.4.10.tgz</span></span><br><span class="line">[root@mongodb app]<span class="comment"># mv mongodb-linux-x86_64-rhel70-3.4.10 /mnt/app/mongo</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt;/etc/profile.d/mongo.sh &lt;&lt;EOF</span></span><br><span class="line"><span class="built_in">export</span> MONGO_HOME=/mnt/app/mongo</span><br><span class="line"><span class="built_in">export</span> PATH=\<span class="variable">$&#123;MONGO_HOME&#125;</span>/bin:\<span class="variable">$PATH</span></span><br><span class="line">EOF</span><br><span class="line">[root@mongodb app]<span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo配置文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/app/mongo/conf</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo数据文件目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/data/mongo/&#123;27017,27018,27019&#125;</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/data/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建mongo日志目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># mkdir -p /mnt/log/mongo/&#123;27017,27018,27019&#125;</span></span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/log/mongo</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27017.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27017</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27017/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27017  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span>  </span><br><span class="line"><span class="comment">#auth=true  </span></span><br><span class="line"></span><br><span class="line">journal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27018.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27018</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27018/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27018  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span>  </span><br><span class="line"><span class="comment">#auth=true  </span></span><br><span class="line"></span><br><span class="line">journal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /mnt/app/mongo/conf/mongo.27019.conf &lt;&lt;EOF</span></span><br><span class="line">dbpath=/mnt/data/mongo/27019</span><br><span class="line">logpath=/mnt/<span class="built_in">log</span>/mongo/27019/mongo.log  </span><br><span class="line">logappend=<span class="literal">true</span>  </span><br><span class="line">port=27019  </span><br><span class="line">fork=<span class="literal">true</span>  </span><br><span class="line">nohttpinterface=<span class="literal">true</span>  </span><br><span class="line"><span class="comment">#auth=true  </span></span><br><span class="line"></span><br><span class="line">nojournal=<span class="literal">true</span></span><br><span class="line">oplogSize=2048</span><br><span class="line">smallfiles=<span class="literal">true</span></span><br><span class="line">replSet=dbset</span><br><span class="line">EOF</span><br><span class="line">[root@mongodb app]<span class="comment"># chown -R mongo.mongo /mnt/app/mongo/conf</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>设置mongo systemd文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27017.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27017.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27017.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27018.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27018.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27018.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># cat &gt; /usr/lib/systemd/system/mongo-27019.service &lt;&lt;EOF</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=mongodb</span><br><span class="line">After=network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/mnt/app/mongo/bin/mongod --config /mnt/app/mongo/conf/mongo.27019.conf</span><br><span class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP \<span class="variable">$MAINPID</span></span><br><span class="line">ExecStop=/mnt/app/mongo/bin/mongod --shutdown --config /mnt/app/mongo/conf/mongo.27019.conf</span><br><span class="line">PrivateTmp=<span class="literal">true</span></span><br><span class="line">User=mongo</span><br><span class="line">Group=mongo</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl daemon-reload</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动mongo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27017</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27018</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl start mongo-27019</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable monog-27017</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable monog-27018</span></span><br><span class="line">[root@mongodb app]<span class="comment"># systemctl enable monog-27019</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集初始化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># mongo --port 27017</span></span><br><span class="line">&gt; rs.initiate(&#123;_id: <span class="string">"dbset"</span>,version: 1,members: [&#123; _id: 0, host : <span class="string">"192.168.13.218:27017"</span> &#125;]&#125;)</span><br><span class="line">dbset:SECONDARY&gt;</span><br><span class="line">dbset:PRIMARY&gt; rs.add(<span class="string">"192.168.13.218:27018"</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.addArb(<span class="string">"192.168.13.218:27019"</span>)</span><br><span class="line">dbset:PRIMARY&gt; rs.status()</span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集状态</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">dbset:PRIMARY&gt; rs.status()</span><br><span class="line">&#123;</span><br><span class="line">        <span class="string">"set"</span> : <span class="string">"dbset"</span>,</span><br><span class="line">        <span class="string">"date"</span> : ISODate(<span class="string">"2017-11-13T09:12:44.740Z"</span>),</span><br><span class="line">        <span class="string">"myState"</span> : 1,</span><br><span class="line">        <span class="string">"term"</span> : NumberLong(1),</span><br><span class="line">        <span class="string">"heartbeatIntervalMillis"</span> : NumberLong(2000),</span><br><span class="line">        <span class="string">"optimes"</span> : &#123;</span><br><span class="line">                <span class="string">"lastCommittedOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">"appliedOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">"durableOpTime"</span> : &#123;</span><br><span class="line">                        <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                        <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"members"</span> : [</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 0,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27017"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 1,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"PRIMARY"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 641,</span><br><span class="line">                        <span class="string">"optime"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"electionTime"</span> : Timestamp(1510564115, 2),</span><br><span class="line">                        <span class="string">"electionDate"</span> : ISODate(<span class="string">"2017-11-13T09:08:35Z"</span>),</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3,</span><br><span class="line">                        <span class="string">"self"</span> : <span class="literal">true</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 1,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27018"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 2,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"SECONDARY"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 122,</span><br><span class="line">                        <span class="string">"optime"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDurable"</span> : &#123;</span><br><span class="line">                                <span class="string">"ts"</span> : Timestamp(1510564357, 1),</span><br><span class="line">                                <span class="string">"t"</span> : NumberLong(1)</span><br><span class="line">                        &#125;,</span><br><span class="line">                        <span class="string">"optimeDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"optimeDurableDate"</span> : ISODate(<span class="string">"2017-11-13T09:12:37Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeat"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.815Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeatRecv"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.814Z"</span>),</span><br><span class="line">                        <span class="string">"pingMs"</span> : NumberLong(0),</span><br><span class="line">                        <span class="string">"syncingTo"</span> : <span class="string">"192.168.13.218:27017"</span>,</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3</span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                        <span class="string">"_id"</span> : 2,</span><br><span class="line">                        <span class="string">"name"</span> : <span class="string">"192.168.13.218:27019"</span>,</span><br><span class="line">                        <span class="string">"health"</span> : 1,</span><br><span class="line">                        <span class="string">"state"</span> : 7,</span><br><span class="line">                        <span class="string">"stateStr"</span> : <span class="string">"ARBITER"</span>,</span><br><span class="line">                        <span class="string">"uptime"</span> : 58,</span><br><span class="line">                        <span class="string">"lastHeartbeat"</span> : ISODate(<span class="string">"2017-11-13T09:12:43.814Z"</span>),</span><br><span class="line">                        <span class="string">"lastHeartbeatRecv"</span> : ISODate(<span class="string">"2017-11-13T09:12:40.893Z"</span>),</span><br><span class="line">                        <span class="string">"pingMs"</span> : NumberLong(0),</span><br><span class="line">                        <span class="string">"configVersion"</span> : 3</span><br><span class="line">                &#125;</span><br><span class="line">        ],</span><br><span class="line">        <span class="string">"ok"</span> : 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>副本集常用命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//primary secondary切换</span><br><span class="line">dbset:PRIMARY&gt; rs.stepDown()</span><br><span class="line"></span><br><span class="line">//副本集中移除</span><br><span class="line">dbset:PRIMARY&gt; rs.remove(<span class="string">"192.168.13.218:27019"</span>)</span><br><span class="line"></span><br><span class="line">//副本集配置</span><br><span class="line">dbset:PRIMARY&gt; rs.conf()</span><br></pre></td></tr></table></figure>
</li>
<li><p>mongo内核优化</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/enabled</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># echo never |tee /sys/kernel/mm/transparent_hugepage/defrag</span></span><br><span class="line">[root@mongodb ~]<span class="comment"># systemctl stop mongo &amp;&amp; systemctl start mongo</span></span><br><span class="line"></span><br><span class="line">[root@mongodb ~]<span class="comment"># cat &gt;&gt;/etc/rc.local &lt;&lt;EOF</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### mongodb close hugepage</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/enabled;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/enabled</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">test</span> -f /sys/kernel/mm/transparent_hugepage/defrag;<span class="keyword">then</span></span><br><span class="line">   <span class="built_in">echo</span> never |tee /sys/kernel/mm/transparent_hugepage/defrag</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/11/13/mongo-replication-standard-install/" data-id="cjavy9k0700650coqu2estnyy" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-zabbix-monitor-mem" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/26/zabbix-monitor-mem/" class="article-date">
  <time datetime="2017-10-26T03:54:16.000Z" itemprop="datePublished">2017-10-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Monitor/">Monitor</a>►<a class="article-category-link" href="/categories/Monitor/zabbix/">zabbix</a>►<a class="article-category-link" href="/categories/Monitor/zabbix/monitor/">monitor</a>►<a class="article-category-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/26/zabbix-monitor-mem/">zabbix monitor mem</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="zabbix-monitor-mem"><a href="#zabbix-monitor-mem" class="headerlink" title="zabbix monitor mem"></a>zabbix monitor mem</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@smallasa]# free</span><br><span class="line">             total       used       free     shared    buffers     cached</span><br><span class="line">Mem:      65922752    1178064   64744688        840     266968     330884</span><br><span class="line">-/+ buffers/cache:     580212   65342540</span><br><span class="line">Swap:      8191996          0    8191996</span><br><span class="line"></span><br><span class="line">第1行:</span><br><span class="line">total   内存总数(65922752)</span><br><span class="line">used    已经使用的内存数(1178064)</span><br><span class="line">free    空闲的内存数(64744688)</span><br><span class="line">shared  多个进程共享的内存总额(840)</span><br><span class="line">buffers 系统分配但未被使用的buffers数量(266968)</span><br><span class="line">cached  系统分配但未被使用的cache数量(330884)</span><br><span class="line"></span><br><span class="line">关系: total = used + free</span><br><span class="line"></span><br><span class="line">第2行:</span><br><span class="line">-/+ buffers/cache:</span><br><span class="line">-buffers/cache 的内存数(580212) = (used - buffers - cached)</span><br><span class="line">+buffers/cache 的内存数(65342540) = (free + buffers + cached)</span><br><span class="line"></span><br><span class="line">&quot;-buffers/cache&quot;反映的是被程序实实在在吃掉的内存</span><br><span class="line">&quot;+buffers/cache&quot;反映的是可以挪用的内存总数</span><br><span class="line"></span><br><span class="line">第3行:</span><br><span class="line">total   Swap内存总数(8191996)</span><br><span class="line">used    Swap已经使用的内存数(0)</span><br><span class="line">free    Swap空闲内存数(8191996)</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/26/zabbix-monitor-mem/" data-id="cjavy9k8h00by0coqm6e1xxos" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-confluence-reset-passwd" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/25/Atlassian-confluence-reset-passwd/" class="article-date">
  <time datetime="2017-10-25T08:58:00.000Z" itemprop="datePublished">2017-10-25</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/25/Atlassian-confluence-reset-passwd/">Atlassian confluence reset passwd</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="重置-confluence-管理员密码"><a href="#重置-confluence-管理员密码" class="headerlink" title="重置 confluence 管理员密码"></a>重置 confluence 管理员密码</h3><ol>
<li><p>在数据库中查看管理员ID</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_confluence]&gt; select * from cwd_user <span class="built_in">where</span> id\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">                 id: 458753</span><br><span class="line">          user_name: liu_p</span><br><span class="line">          ... ....</span><br><span class="line">         credential: &#123;PKCS5S2&#125;VaATUfyNnO5tOglFJN9C8Hqi1UVKA3GTr5zBddT0BnVMTpgNtlP7ciJfdWgERjiz</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">MariaDB [test_confluence]&gt; select u.id, u.user_name, u.active from cwd_user u join cwd_membership m on u.id=m.child_user_id join cwd_group g on m.parent_id=g.id join cwd_directory d on d.id=g.directory_id   <span class="built_in">where</span> g.group_name = <span class="string">'confluence-administrators'</span> and d.directory_name=<span class="string">'Confluence Internal Directory'</span>;</span><br><span class="line">+--------+-----------+--------+</span><br><span class="line">| id     | user_name | active |</span><br><span class="line">+--------+-----------+--------+</span><br><span class="line">| 458753 | liu_p      | T      |</span><br><span class="line">+--------+-----------+--------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>
</li>
<li><p>重置密码,默认为”Ab123456”</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [test_confluence]&gt; update cwd_user <span class="built_in">set</span> credential =  <span class="string">'&#123;PKCS5S2&#125;ltrb9LlmZ0QDCJvktxd45WgYLOgPt2XTV8X7av2p0mhPvIwofs9bHYVz2OXQ6/kF'</span> <span class="built_in">where</span> id=458753;</span><br></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/25/Atlassian-confluence-reset-passwd/" data-id="cjavy9jsn00010coqag3uqn3y" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-jira-https" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-jira-https/" class="article-date">
  <time datetime="2017-10-10T09:14:40.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-jira-https/">Atlassian jira https</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="jira-SSL设置"><a href="#jira-SSL设置" class="headerlink" title="jira SSL设置"></a>jira SSL设置</h3><ol>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># systemctl stop jira</span></span><br><span class="line">或者</span><br><span class="line">[root@jira app]<span class="comment"># /etc/init.d/jira stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改tomcat server.conf配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># vim /mnt/app/jira/conf/server.xml</span></span><br><span class="line">&lt;Connector port=<span class="string">"8080"</span></span><br><span class="line">           maxThreads=<span class="string">"150"</span></span><br><span class="line">           minSpareThreads=<span class="string">"25"</span></span><br><span class="line">           connectionTimeout=<span class="string">"20000"</span></span><br><span class="line"></span><br><span class="line">           enableLookups=<span class="string">"false"</span></span><br><span class="line">           maxHttpHeaderSize=<span class="string">"8192"</span></span><br><span class="line">           protocol=<span class="string">"HTTP/1.1"</span></span><br><span class="line">           useBodyEncodingForURI=<span class="string">"true"</span></span><br><span class="line">           redirectPort=<span class="string">"8443"</span></span><br><span class="line">           acceptCount=<span class="string">"100"</span></span><br><span class="line">           disableUploadTimeout=<span class="string">"true"</span></span><br><span class="line">           bindOnInit=<span class="string">"false"</span></span><br><span class="line"></span><br><span class="line">           proxyName=<span class="string">"jira"</span></span><br><span class="line">           proxyPort=<span class="string">"443"</span></span><br><span class="line">           scheme=<span class="string">"https"</span></span><br><span class="line">           secure=<span class="string">"true"</span>/&gt;</span><br><span class="line">和</span><br><span class="line">&lt;Context path=<span class="string">"/jira"</span> docBase=<span class="string">"<span class="variable">$&#123;catalina.home&#125;</span>/atlassian-jira"</span> reloadable=<span class="string">"false"</span> useHttpOnly=<span class="string">"true"</span>&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jira app]<span class="comment"># systemctl start jira</span></span><br><span class="line">或者</span><br><span class="line">[root@jira app]<span class="comment"># /etc/init.d/jira start</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx ssl key存放位置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># ls -1 /mnt/app/nginx/conf/ssl/*</span></span><br><span class="line">/mnt/app/nginx/conf/ssl/jira.crt</span><br><span class="line">/mnt/app/nginx/conf/ssl/jira.key</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx 主配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># cat /mnt/app/nginx/conf/nginx.conf</span></span><br><span class="line">user nginx nginx;</span><br><span class="line">worker_processes  8;</span><br><span class="line">worker_cpu_affinity 00000001 00000010 00000100 00001000 00010000 00100000 01000000 10000000;</span><br><span class="line">worker_rlimit_nofile 102400;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">  use epoll;</span><br><span class="line">  worker_connections  102400;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">  include              mime.types;</span><br><span class="line">  default_type         application/octet-stream;</span><br><span class="line">  sendfile             on;</span><br><span class="line">  keepalive_timeout    65;</span><br><span class="line">  server_tokens        off;</span><br><span class="line">  client_max_body_size 30m;</span><br><span class="line">  client_header_buffer_size 16k;</span><br><span class="line">  large_client_header_buffers 4 32k;</span><br><span class="line"></span><br><span class="line">  gzip                 on;</span><br><span class="line">  gzip_vary            on;</span><br><span class="line">  gzip_min_length      1k;</span><br><span class="line">  gzip_buffers         4  16k;</span><br><span class="line">  gzip_http_version    1.0;</span><br><span class="line">  gzip_comp_level      5;</span><br><span class="line">  gzip_types text/plain application/x-javascript text/css application/xml  image/jpeg image/png image/gif;</span><br><span class="line"></span><br><span class="line">  log_format  main  <span class="string">'$remote_addr $remote_user [$time_local] "$request" '</span></span><br><span class="line">                      <span class="string">'$status $body_bytes_sent '</span></span><br><span class="line">                      <span class="string">'"$http_user_agent" $http_x_forwarded_for $request_time $upstream_response_time'</span>;</span><br><span class="line">  error_log /mnt/<span class="built_in">log</span>/nginx/nginx_error.log ;</span><br><span class="line"></span><br><span class="line">  include /mnt/app/nginx/conf/vhost/*.conf;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">stream &#123;</span><br><span class="line">  include /mnt/app/nginx/conf/stream/*.conf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx jira 虚拟主机配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># cat /mnt/app/nginx/conf/vhost/jira.conf</span></span><br><span class="line">server &#123;</span><br><span class="line">  listen       80;</span><br><span class="line">  server_name  jira.ops.com;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">return</span> 301 https://<span class="variable">$host</span><span class="variable">$request_uri</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">  listen 443 ssl;</span><br><span class="line">  server_name  jira;</span><br><span class="line">  access_log   /mnt/<span class="built_in">log</span>/nginx/jira.ops.com.access.log  main;</span><br><span class="line">  error_log    /mnt/<span class="built_in">log</span>/nginx/jira.ops.com.error.log;</span><br><span class="line"></span><br><span class="line">  ssl on;</span><br><span class="line">  ssl_certificate /mnt/app/nginx/conf/ssl/jira.crt;</span><br><span class="line">  ssl_certificate_key /mnt/app/nginx/conf/ssl/jira.key;</span><br><span class="line">  ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span><br><span class="line">  ssl_ciphers ECDHE-RSA-AES256-SHA384:AES256-SHA256:RC4:HIGH:!MD5:!aNULL:!eNULL:!NULL:!DH:!EDH:!AESGCM;</span><br><span class="line">  ssl_prefer_server_ciphers on;</span><br><span class="line">  ssl_session_cache shared:SSL:10m;</span><br><span class="line">  ssl_session_timeout  10m;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    rewrite ^/ https://jira.ops.com/jira/;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  location /jira &#123;</span><br><span class="line">    proxy_set_header        Host <span class="variable">$host</span>:<span class="variable">$server_port</span>;</span><br><span class="line">    proxy_set_header        X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">    proxy_redirect          http:// https://;</span><br><span class="line">    proxy_pass              http://10.10.10.11:8080/jira;</span><br><span class="line">    client_max_body_size    10M;</span><br><span class="line">    proxy_set_header        X-Forwarded-Host <span class="variable">$host</span>;</span><br><span class="line">    proxy_set_header        X-Forwarded-Server <span class="variable">$host</span>;</span><br><span class="line">    <span class="comment"># Required for new HTTP-based CLI</span></span><br><span class="line">    proxy_http_version 1.1;</span><br><span class="line">    proxy_request_buffering off;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>nginx reload</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx ~]<span class="comment"># /mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf -t</span></span><br><span class="line">[root@nginx ~]<span class="comment"># /mnt/app/nginx/sbin/nginx -c /mnt/app/nginx/conf/nginx.conf -s reload</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>验证: 输入域名”jira.ops.com”查看是否自动跳转为https</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-jira-https/" data-id="cjavy9jt100070coq58c9dflo" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-Atlassian-confluence-update" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/10/10/Atlassian-confluence-update/" class="article-date">
  <time datetime="2017-10-10T09:14:24.000Z" itemprop="datePublished">2017-10-10</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/system-service/">system service</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/">Atlassian</a>►<a class="article-category-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/10/10/Atlassian-confluence-update/">Atlassian confluence update</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="confluence-升级版本"><a href="#confluence-升级版本" class="headerlink" title="confluence 升级版本"></a>confluence 升级版本</h3><ol>
<li><p>备份confluence安装目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># tar czf confluence.bin.tar.gz /mnt/app/confluence</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>备份confluence.home目录</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># tar czf confluence.home.tar.gz /mnt/data/confluence.home</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>备份confluence数据库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># mysqldump -u&#123;username&#125; -p&#123;password&#125; -h&#123;ipaddress&#125; confluence &gt; confluence.sql</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>升级confluence</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># ./atlassian-confluence-6.4.1-x64.bin</span></span><br><span class="line">Unpacking JRE ...</span><br><span class="line">Starting Installer ...</span><br><span class="line">Oct 10, 2017 1:44:58 PM java.util.prefs.FileSystemPreferences<span class="variable">$2</span> run</span><br><span class="line">INFO: Created system preferences directory <span class="keyword">in</span> java.home.</span><br><span class="line"></span><br><span class="line">This will install Confluence 6.4.1 on your computer.</span><br><span class="line">OK [o, Enter], Cancel [c]</span><br><span class="line">o</span><br><span class="line">Choose the appropriate installation or upgrade option.</span><br><span class="line">Please choose one of the following:</span><br><span class="line">Express Install (uses default settings) [1],</span><br><span class="line">Custom Install (recommended <span class="keyword">for</span> advanced users) [2],</span><br><span class="line">Upgrade an existing Confluence installation [3, Enter]</span><br><span class="line">3</span><br><span class="line">Existing installation directory:</span><br><span class="line">[/mnt/app/confluence]</span><br><span class="line">/mnt/app/confluence</span><br><span class="line">Back Up Confluence Home</span><br><span class="line">The upgrade process will automatically back up your Confluence Installation</span><br><span class="line">Directory. You can also choose to back up your existing Confluence Home</span><br><span class="line">Directory. Both directories are backed up as zip archive files <span class="keyword">in</span> their</span><br><span class="line">respective parent directory locations.</span><br><span class="line"></span><br><span class="line">We strongly recommend choosing this option <span class="keyword">in</span> the unlikely event that you</span><br><span class="line">experience problems with the upgrade and may require these backups to</span><br><span class="line">restore your existing Confluence installation.</span><br><span class="line"></span><br><span class="line">If you have many attachments <span class="keyword">in</span> your Confluence Home Directory, the zip</span><br><span class="line">archive of this directory may consume a significant amount of disk space.</span><br><span class="line">Back up Confluence home ?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Checking <span class="keyword">for</span> <span class="built_in">local</span> modifications.</span><br><span class="line"></span><br><span class="line">List of modifications made within Confluence directories.</span><br><span class="line"></span><br><span class="line">The following provides a list of file modifications within the confluence</span><br><span class="line">directory.</span><br><span class="line"></span><br><span class="line">Modified files:</span><br><span class="line">        bin/catalina.sh</span><br><span class="line">        bin/setenv.sh</span><br><span class="line">        conf/server.xml</span><br><span class="line">Removed files:</span><br><span class="line">        (none)</span><br><span class="line">Added files:</span><br><span class="line">        confluence/WEB-INF/lib/mysql-connector-java-5.1.38-bin.jar</span><br><span class="line">        confluence/images/welcome.png</span><br><span class="line">        conf/server.xml_bak</span><br><span class="line"></span><br><span class="line">[Enter]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Checking <span class="keyword">if</span> your instance of Confluence is running</span><br><span class="line">Upgrade Check List</span><br><span class="line">Back up your external database</span><br><span class="line">We strongly recommend you back up your Confluence database <span class="keyword">if</span> you have not</span><br><span class="line">already <span class="keyword">done</span> so.</span><br><span class="line"></span><br><span class="line">Please refer to the following URL <span class="keyword">for</span> back up guidelines:</span><br><span class="line">http://docs.atlassian.com/confluence/docs-64/Production+Backup+Strategy</span><br><span class="line"></span><br><span class="line">Check plugin compatibility</span><br><span class="line">Check that your non-bundled plugins are compatible with Confluence 6.4.1.</span><br><span class="line"></span><br><span class="line">Access the plugin manager through the following URL:</span><br><span class="line">http://localhost:8090/plugins/servlet/upm<span class="comment">#compatibility</span></span><br><span class="line"></span><br><span class="line">For more information see our documentation at the following URL:</span><br><span class="line">http://docs.atlassian.com/confluence/docs-64/Installing+and+Configuring+Plugins+using+the+Universal+Plugin+Manager</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Please ensure you have <span class="built_in">read</span> the above checklist before upgrading.</span><br><span class="line">Your existing Confluence installation is about to be upgraded!</span><br><span class="line"></span><br><span class="line">The upgrade process will shut down your existing Confluence installation to complete the upgrade.</span><br><span class="line"></span><br><span class="line">Do you want to proceed?</span><br><span class="line">Upgrade [u, Enter], Exit [e]</span><br><span class="line">u</span><br><span class="line"></span><br><span class="line">Your instance of Confluence is currently being upgraded.</span><br><span class="line">Shutting down Confluence...</span><br><span class="line">Checking <span class="keyword">if</span> Confluence has been shutdown...</span><br><span class="line">Backing up the Confluence installation directory</span><br><span class="line"></span><br><span class="line">Backing up the Confluence home directory</span><br><span class="line"></span><br><span class="line">Deleting the previous Confluence installation directory...</span><br><span class="line"></span><br><span class="line">Extracting files ...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Please <span class="built_in">wait</span> a few moments <span class="keyword">while</span> we configure Confluence.</span><br><span class="line">Installation of Confluence 6.4.1 is complete</span><br><span class="line">Start Confluence now?</span><br><span class="line">Yes [y, Enter], No [n]</span><br><span class="line">y</span><br><span class="line"></span><br><span class="line">Please <span class="built_in">wait</span> a few moments <span class="keyword">while</span> Confluence starts up.</span><br><span class="line">Launching Confluence ...</span><br><span class="line">Installation of Confluence 6.4.1 is complete</span><br><span class="line">Your installation of Confluence 6.4.1 is now ready and can be accessed via</span><br><span class="line">your browser.</span><br><span class="line">Custom modifications</span><br><span class="line">Your previous Confluence installation contains customisations (eg</span><br><span class="line">server.xml) that must be manually transferred. Refer to our documentation</span><br><span class="line">more information:</span><br><span class="line">http://docs.atlassian.com/confluence/docs-64/Upgrading+Confluence<span class="comment">#UpgradingConfluence-custommodifications</span></span><br><span class="line">Confluence 6.4.1 can be accessed at http://localhost:8090</span><br><span class="line"></span><br><span class="line">Confluence 6.4.1 may take several minutes to load on first start up.</span><br><span class="line">Finishing installation ...</span><br></pre></td></tr></table></figure>
</li>
<li><p>停止服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># systemctl stop confluence</span></span><br><span class="line">或者</span><br><span class="line">[root@confluence app]<span class="comment"># /etc/init.d/confluence stop</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>将JDBC的客户端拷贝到confluence安装目录lib下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># cp mysql-connector-java-5.1.44-bin.jar /mnt/app/confluence/lib/</span></span><br><span class="line">[root@confluence app]<span class="comment"># ls -1 /mnt/app/confluence/lib/mysql-connector-java-5.1.44-bin.jar  </span></span><br><span class="line">/mnt/app/confluence/lib/mysql-connector-java-5.1.44-bin.jar</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@confluence app]<span class="comment"># systemctl start confluence</span></span><br><span class="line">或者</span><br><span class="line">[root@confluence app]<span class="comment"># /etc/init.d/confluence start</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过URL访问,进行验证</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://www.smallasa.com/2017/10/10/Atlassian-confluence-update/" data-id="cjavy9jsv00040coqgyjqaox0" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/">AliCloud</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/">SDK</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/AliCloud/SDK/Python-SDK/">Python SDK</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/">Android install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-install/Android-studio-install/">Android studio install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/">Development</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/">Doc</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP-严格传输安全HSTS/">HTTP 严格传输安全HSTS</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/HTTP协议/">HTTP协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP-协议详解/">TCP 协议详解</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/TCP与socket区别/">TCP与socket区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件描述符与打开文件之间的关系/">linux 文件描述符与打开文件之间的关系</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/linux-文件系统inode/">linux 文件系统inode</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Development/Doc/一次完整的HTTP请求/">一次完整的HTTP请求</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/">Disk</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-io-performance/">disk io performance</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Disk/disk-iostat/">disk iostat</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/">Distributed storage</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/">GlusterFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-architecture/">GlusterFS architecture</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-info/">GlusterFS info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-install/">GlusterFS install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Distributed-storage/GlusterFS/GlusterFS-workflow/">GlusterFS workflow</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/">HA</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/">DRBD</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/DRBD/DRBD-install/">DRBD install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/">keepalived</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HA/keepalived/keepalived-install/">keepalived install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/">IDE</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/">Intellij</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/Intellij/Intellij-setting/">Intellij setting</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/">vim</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-shortcut-key/">vim shortcut key</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/IDE/vim/vim-vimrc/">vim vimrc</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/">Kernel</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/">kernel memory</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kernel/kernel-memory/kernel-共享内存/">kernel 共享内存</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/">Monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/">ganglia</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/ganglia/ganglia-install/">ganglia install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/">hmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/hmonitor/hmonitor-install/">hmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/">htmonitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/htmonitor/htmonitor-install/">htmonitor install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/">smokeping</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/smokeping/smokeping-install/">smokeping install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/">zabbix</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/">monitor</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-cpu/">zabbix monitor cpu</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/monitor/zabbix-monitor-mem/">zabbix monitor mem</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-auto-discover/">zabbix auto discover</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-grafana-install/">zabbix grafana install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install/">zabbix install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-install-distributed/">zabbix install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-item-and-tigger/">zabbix item and tigger</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-java-gateway/">zabbix java gateway</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-modify-login-user-passwd/">zabbix modify login user passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-optimization/">zabbix optimization</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-proxy-install/">zabbix proxy install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-server-support-chinese/">zabbix server support chinese</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/zabbix/zabbix-windows-agent/">zabbix windows agent</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/树莓派/树莓派-GSM-语音短信报警/">树莓派 GSM 语音短信报警</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/">监控</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Monitor/监控/监控知识体系/">监控知识体系</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/">Python Framework</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django/">Python Django</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-Django-setting/">Python Django setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Framework/Python-tornado-install/">Python tornado install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/">Python Learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-上下文管理器/">python 上下文管理器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-内存管理/">python 内存管理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-函数编程/">python 函数编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-变量/">python 变量</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象使用/">python 对象使用</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象的属性/">python 对象的属性</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-对象编程/">python 对象编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-数据类型/">python 数据类型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-流程控制/">python 流程控制</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-爬虫/">python 爬虫</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊方法/">python 特殊方法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-特殊说明/">python 特殊说明</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-装饰器/">python 装饰器</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-过程编程/">python 过程编程</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-进阶/">python 进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-Learn/python-闭包/">python 闭包</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/">Python install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-error-info/">python error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-source-image/">python pip source image</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pip-use/">python pip use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-pyenv-install/">python pyenv install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-setup-py/">python setup.py</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-source-install/">python source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-install/python-virtualenv/">python virtualenv</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/">Python library</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/MySQLdb/">MySQLdb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/memory-profiler/">memory_profiler</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-library/time-datetime-calendar/">time datetime calendar</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/">Python modules</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-path/">python modules path</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-modules/python-modules-pylint-and-ipython/">python modules pylint and ipython</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/">Python other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Python/Python-other/python-import-and-reload/">python import and reload</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/">Ruby</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/">Ruby install</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Ruby/Ruby-install/Ruby-install/">Ruby install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/">TCP.IP</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-状态/">TCP 状态</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/TCP-IP模型/">TCP/IP模型</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/TCP-IP/Wireshark-use/">Wireshark use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/">WeChat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/">WeChat enterprise</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/WeChat/WeChat-enterprise/WeChat-enterprise-API/">WeChat enterprise API</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/">automation</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/">git</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-command/">git command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-error/">git error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitlab/">git gitlab</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gitolite/">git gitolite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs/">git gogs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-gogs-source-install/">git gogs source install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-init/">git init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/git/git-workflow/">git workflow</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/">jenkins</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-info/">jenkins info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/jenkins/jenkins-install/">jenkins install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/">kvm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/kvm/kvm-install/">kvm install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/">maven</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/maven/maven-install/">maven install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/">nexus</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-install/">nexus install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/nexus/nexus-proxy-maven/">nexus proxy maven</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/">rpm</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpm-package-build/">rpm package build</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/rpm/rpmbuild-spec/">rpmbuild spec</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/">salt</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-advanced-topic/">salt advanced topic</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-highstate/">salt highstate</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-info/">salt info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install/">salt install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-HA/">salt install HA</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-distributed/">salt install distributed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-install-standard/">salt install standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-jinja2-grain-pillar-module/">salt jinja2 grain pillar module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-event-reactor/">salt manage event reactor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-grains/">salt manage grains</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-job/">salt manage job</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-module/">salt manage module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-pillar/">salt manage pillar</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-return/">salt manage return</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-states/">salt manage states</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-manage-target/">salt manage target</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-syndic-install/">salt master syndic install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-master-conf/">salt master.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-minion-conf/">salt minion.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-raet/">salt raet</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-state-module/">salt state module</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-syndic-conf/">salt syndic.conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/salt/salt-write-module-code/">salt write module code</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/">svn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/svn/svn-auto-update/">svn auto update</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/">yum</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/automation/yum/yum-server-install/">yum server install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/">database</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/">Mongo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-auth/">mongo auth</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-error/">mongo error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-auth-install/">mongo replication auth install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-replication-standard-install/">mongo replication standard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mongo/mongo-standard-install/">mongo standard install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/">Mysql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-command/">mysql command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-error-info/">mysql error info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-explain/">mysql explain</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-grant/">mysql grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-index-options/">mysql index options</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-innodb-buffer-pool-flush/">mysql innodb buffer pool flush</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave/">mysql master slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-master-slave-switch/">mysql master slave switch</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-partition/">mysql partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-select-join/">mysql select join</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-slow-log/">mysql slow log</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-standard/">mysql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-table-size/">mysql table size</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Mysql/mysql-use-memory-as-disk/">mysql use memory as disk</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/">Postgresql</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-book-use/">postgresql book use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave-info/">postgresql master slave info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-master-slave/">postgresql master/slave</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-plugin-install/">postgresql plugin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-standard/">postgresql standard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-tablespace-database-schema-table-user-role-relation/">postgresql tablespace database schema table user role relation</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-yum-install/">postgresql yum install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-常用命令/">postgresql 常用命令</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库对象/">postgresql 数据库对象</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Postgresql/postgresql-数据库管理/">postgresql 数据库管理</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/">Redis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-error/">redis error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-install/">redis install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-redis-trib-rb/">redis redis-trib.rb</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-status/">redis status</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/Redis/redis-use/">redis use</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/">influxDB</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/database/influxDB/influxDB-install/">influxDB install</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/golang/">golang</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/golang/go-env/">go env</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/">RabbitMQ</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-cluster/">RabbitMQ cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-high-availability/">RabbitMQ high availability</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-info/">RabbitMQ info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-install/">RabbitMQ install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-python-pika/">RabbitMQ python pika</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-user-and-grant/">RabbitMQ user and grant</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/RabbitMQ/RabbitMQ-working-principle/">RabbitMQ working principle</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/">beats</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/beats/beats-install/">beats install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/">datax</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-info/">datax info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-install/">datax install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/datax/datax-job/">datax job</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/">elasticsearch</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-backup-and-restore/">elasticsearch backup and restore</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-command/">elasticsearch command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-core-component/">elasticsearch core component</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-cluster/">elasticsearch exploring your cluster</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-exploring-your-data/">elasticsearch exploring your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-four-search-type/">elasticsearch four search type</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-full-cluster-restart-upgrade/">elasticsearch full cluster restart upgrade</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-install/">elasticsearch install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-modifying-your-data/">elasticsearch modifying your data</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-rolling-upgrades/">elasticsearch rolling upgrades</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-safe-restart/">elasticsearch safe restart</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/elasticsearch-shard/">elasticsearch shard</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-indexing-speed/">how to tune for indexing speed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/elasticsearch/how-to-tune-for-search-speed/">how to tune for search speed</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/">flume</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-info/">flume info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/flume/flume-install/">flume install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/">grafana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/grafana/grafana-install/">grafana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/">hadoop</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/hadoop/hadoop-简介/">hadoop 简介</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/">kafka</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-partition/">kafka add topic partition</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-add-topic-replicats/">kafka add topic replicats</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-broker-config/">kafka broker config</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-high-throughput/">kafka high throughput</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-info/">kafka info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-install/">kafka install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-manage-web/">kafka manage web</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-migrate-and-scale/">kafka migrate and scale</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-offset-monitor/">kafka offset monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-optimize/">kafka optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-use/">kafka use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-web-console/">kafka web console</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kafka/kafka-with-zookeeper/">kafka with zookeeper</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/">kibana</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/kibana/kibana-install/">kibana install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/">logstash</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-config-file/">logstash config file</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-filter-grok/">logstash filter grok</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-info/">logstash info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/logstash/logstash-install/">logstash install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/">mycat</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-jvm-optimize/">mycat jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/mycat/mycat-web-install/">mycat web install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/">nsq</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-command/">nsq command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-info/">nsq info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/nsq/nsq-install/">nsq install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/">zookeeper</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-install/">zookeeper install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-monitor/">zookeeper monitor</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-optimize/">zookeeper optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-use/">zookeeper use</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hadoop/zookeeper/zookeeper-zab-protocol/">zookeeper zab protocol</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-env/">java env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-optimize/">java jvm optimize</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-opts/">java jvm opts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-jvm-原理/">java jvm 原理</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/">java learn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-learn/java-学习笔记/">java 学习笔记</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-log4j/">java log4j</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/">java performance analysis</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/java/java-performance-analysis/jps/">jps</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/">k8s</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-dashboard-install/">k8s dashboard install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-install/">k8s install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/k8s/k8s-registry-install/">k8s registry install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/node/">node</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/node/node-install/">node install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/">other</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/other/ACID/">ACID</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/分布式二阶段和三阶段提交协议/">分布式二阶段和三阶段提交协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/开源许可协议/">开源许可协议</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/other/网络带宽/">网络带宽</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/">system service</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/">Atlassian</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-https/">confluence https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-install/">confluence install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-reset-passwd/">confluence reset passwd</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/confluence-update/">confluence update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-https/">jira https</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-install/">jira install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/jira-update/">jira update</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Atlassian/mariadb-install/">mariadb install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/">CentOS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/Base-env/">Base env</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-common-use-scripts/">linux common use scripts</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-history-info-setting/">linux history info setting</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-login-info/">linux login info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-nginx-install/">linux nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-skill/">linux skill</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-system-init/">linux system init</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-内存插槽-内存信息/">linux 内存插槽 内存信息</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-扩容swap分区/">linux 扩容swap分区</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-物理CPU-CPU核数-逻辑CPU/">linux 物理CPU CPU核数 逻辑CPU</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-磁盘系统block区别/">linux 磁盘系统block区别</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/linux-设置-包含头文件路径-和-动态库链接路径/">linux 设置 包含头文件路径 和 动态库链接路径</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/CentOS/make提高源码编译速度/">make提高源码编译速度</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/">NFS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-exports-command/">nfs exports command</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/NFS/nfs-install/">nfs install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/">Samba</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-conf/">samba conf</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/Samba/samba-install/">samba install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/">command</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/grep/">grep</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/pigz/">pigz</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/sed/">sed</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/split/">split</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/command/tr/">tr</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/">haproxy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/haproxy/haproxy-install/">haproxy install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/">nginx</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-install/">nginx install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-location/">nginx location</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-rewrite/">nginx rewrite</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/nginx/nginx-status/">nginx status</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/">ntpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/ntpd/ntpd-install/">ntpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/">openssl</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openssl/openssl-certificate/">openssl certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/">openvpn</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/openvpn/openvpn-install/">openvpn install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/">rsync</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/rsync/rsync-install/">rsync install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/">supersord</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/supersord/supersord-install/">supersord install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/">vsftpd</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/ftp-proxy/">ftp proxy</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-error/">vsftpd error</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-info/">vsftpd info</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/vsftpd/vsftpd-install/">vsftpd install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/">windows</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/cygwin-install/">cygwin install</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/ipsec-set/">ipsec set</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/system-service/windows/windows-modify-hosts/">windows modify hosts</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/">SSL</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/SSL/SSL-certificate/">SSL certificate</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/">angular</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/angular/angular-install/">angular install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/">hexo</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/hexo/hexo-install/">hexo install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/">sass</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/sass/sass-install/">sass install</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/">xml</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/web/xml/xml-format/">xml format</a></li></ul></li></ul></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">七月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">五月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/01/01/hello-everyone/">Hello Everyone</a>
          </li>
        
          <li>
            <a href="/2017/11/28/kafka-web-console/">kafka web console</a>
          </li>
        
          <li>
            <a href="/2017/11/27/svn-auto-update/">svn auto update</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-event-reactor/">salt manage event reactor</a>
          </li>
        
          <li>
            <a href="/2017/11/15/salt-manage-job/">salt manage job</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 penn<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>